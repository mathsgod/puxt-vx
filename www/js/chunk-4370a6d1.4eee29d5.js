(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4370a6d1"],{"35ea":function(module,exports,__webpack_require__){var require,require;(function(e){module.exports=e()})((function(){return function(){function e(t,n,r){function a(i,s){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!s&&l)return require(i,!0);if(o)return o(i,!0);throw l=Error("Cannot find module '"+i+"'"),l.code="MODULE_NOT_FOUND",l}l=n[i]={exports:{}},t[i][0].call(l.exports,(function(e){return a(t[i][1][e]||e)}),l,l.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}return e}()({1:[function(T,S,U){(function(e,t){"object"===typeof U&&"undefined"!==typeof S?S.exports=t():e.formula=t()})(this,(function(){return function(){var r=function(){var e={};return e.nil=Error("#NULL!"),e.div0=Error("#DIV/0!"),e.value=Error("#VALUE!"),e.ref=Error("#REF!"),e.name=Error("#NAME?"),e.num=Error("#NUM!"),e.na=Error("#N/A"),e.error=Error("#ERROR!"),e.data=Error("#GETTING_DATA"),e}(),w=function(){var e={flattenShallow:function(e){return e&&e.reduce?e.reduce((function(e,t){var n=Array.isArray(e),r=Array.isArray(t);return n&&r?e.concat(t):n?(e.push(t),e):r?[e].concat(t):[e,t]})):e},isFlat:function(e){if(!e)return!1;for(var t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0},flatten:function(){for(var t=e.argsToArray.apply(null,arguments);!e.isFlat(t);)t=e.flattenShallow(t);return t},argsToArray:function(t){var n=[];return e.arrayEach(t,(function(e){n.push(e)})),n},numbers:function(){return this.flatten.apply(null,arguments).filter((function(e){return"number"===typeof e}))},cleanFloat:function(e){return Math.round(1e14*e)/1e14},parseBool:function(e){if("boolean"===typeof e||e instanceof Error)return e;if("number"===typeof e)return 0!==e;if("string"===typeof e){var t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||r.value},parseNumber:function(e){return void 0===e||""===e||isNaN(e)?r.value:parseFloat(e)},parseNumberArray:function(t){var n,a;if(!t||0===(n=t.length))return r.value;for(;n--;){if(a=e.parseNumber(t[n]),a===r.value)return a;t[n]=a}return t},parseMatrix:function(t){if(!t||0===t.length)return r.value;for(var n,a=0;a<t.length;a++)if(n=e.parseNumberArray(t[a]),t[a]=n,n instanceof Error)return n;return t}},t=new Date(Date.UTC(1900,0,1));return e.parseDate=function(e){return isNaN(e)?"string"!==typeof e||(e=new Date(e),isNaN(e))?r.value:e:e instanceof Date?new Date(e):(e=parseInt(e,10),0>e?r.num:60>=e?new Date(t.getTime()+864e5*(e-1)):new Date(t.getTime()+864e5*(e-2)))},e.parseDateArray=function(e){for(var t,n=e.length;n--;){if(t=this.parseDate(e[n]),t===r.value)return t;e[n]=t}return e},e.anyIsError=function(){for(var e=arguments.length;e--;)if(arguments[e]instanceof Error)return!0;return!1},e.arrayValuesToNumbers=function(e){for(var t,n=e.length;n--;)t=e[n],"number"!==typeof t&&(!0===t?e[n]=1:!1===t?e[n]=0:"string"===typeof t&&(t=this.parseNumber(t),e[n]=t instanceof Error?0:t));return e},e.rest=function(e,t){return e&&"function"===typeof e.slice?e.slice(t||1):e},e.initial=function(e,t){return e&&"function"===typeof e.slice?e.slice(0,e.length-(t||1)):e},e.arrayEach=function(e,t){for(var n=-1,r=e.length;++n<r&&!1!==t(e[n],n,e););return e},e.transpose=function(e){return e?e[0].map((function(t,n){return e.map((function(e){return e[n]}))})):r.value},e}(),k={};k.datetime=function(){function e(e){return(e-n)/864e5+(-22038912e5<e?2:1)}var t={},n=new Date(1900,0,1),a=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];return t.DATE=function(e,t,n){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0>e||0>t||0>n?r.num:new Date(e,t-1,n)},t.DATEVALUE=function(e){return"string"!==typeof e?r.value:(e=Date.parse(e),isNaN(e)?r.value:-22038912e5>=e?(e-n)/864e5+1:(e-n)/864e5+2)},t.DAY=function(e){return e=w.parseDate(e),e instanceof Error?e:e.getDate()},t.DAYS=function(t,n){return t=w.parseDate(t),n=w.parseDate(n),t instanceof Error?t:n instanceof Error?n:e(t)-e(n)},t.DAYS360=function(e,t,n){},t.EDATE=function(t,n){return t=w.parseDate(t),t instanceof Error?t:isNaN(n)?r.value:(n=parseInt(n,10),t.setMonth(t.getMonth()+n),e(t))},t.EOMONTH=function(t,n){return t=w.parseDate(t),t instanceof Error?t:isNaN(n)?r.value:(n=parseInt(n,10),e(new Date(t.getFullYear(),t.getMonth()+n+1,0)))},t.HOUR=function(e){return e=w.parseDate(e),e instanceof Error?e:e.getHours()},t.INTERVAL=function(e){if("number"!==typeof e&&"string"!==typeof e)return r.value;e=parseInt(e,10);var t=Math.floor(e/94608e4);e%=94608e4;var n=Math.floor(e/2592e3);e%=2592e3;var a=Math.floor(e/86400);e%=86400;var o=Math.floor(e/3600);e%=3600;var i=Math.floor(e/60);return e%=60,"P"+(0<t?t+"Y":"")+(0<n?n+"M":"")+(0<a?a+"D":"")+"T"+(0<o?o+"H":"")+(0<i?i+"M":"")+(0<e?e+"S":"")},t.ISOWEEKNUM=function(e){if(e=w.parseDate(e),e instanceof Error)return e;e.setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)},t.MINUTE=function(e){return e=w.parseDate(e),e instanceof Error?e:e.getMinutes()},t.MONTH=function(e){return e=w.parseDate(e),e instanceof Error?e:e.getMonth()+1},t.NETWORKDAYS=function(e,t,n){},t.NETWORKDAYS.INTL=function(e,t,n,r){},t.NOW=function(){return new Date},t.SECOND=function(e){return e=w.parseDate(e),e instanceof Error?e:e.getSeconds()},t.TIME=function(e,t,n){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0>e||0>t||0>n?r.num:(3600*e+60*t+n)/86400},t.TIMEVALUE=function(e){return e=w.parseDate(e),e instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},t.TODAY=function(){return new Date},t.WEEKDAY=function(e,t){if(e=w.parseDate(e),e instanceof Error)return e;void 0===t&&(t=1);var n=e.getDay();return a[t][n]},t.WEEKNUM=function(e,t){},t.WORKDAY=function(e,t,n){},t.WORKDAY.INTL=function(e,t,n,r){},t.YEAR=function(e){return e=w.parseDate(e),e instanceof Error?e:e.getFullYear()},t.YEARFRAC=function(e,t,n){},t}(),k.database=function(){function t(f,b){for(var c={},e=1;e<f[0].length;++e)c[e]=!0;var g=b[0].length;for(e=1;e<b.length;++e)b[e].length>g&&(g=b[e].length);for(e=1;e<f.length;++e)for(var l=1;l<f[e].length;++l){for(var p=!1,u=!1,m=0;m<b.length;++m){var z=b[m];if(!(z.length<g)&&f[e][0]===z[0]){u=!0;for(var D=1;D<z.length;++D)p=p||eval(f[e][l]+z[D])}}u&&(c[l]=c[l]&&p)}for(g=[],e=0;e<f[0].length;++e)c[e]&&g.push(e-1);return g}var h={FINDFIELD:function(e,t){for(var n=null,a=0;a<e.length;a++)if(e[a][0]===t){n=a;break}return null==n?r.value:n},DAVERAGE:function(e,n,a){if(isNaN(n)&&"string"!==typeof n)return r.value;a=t(e,a),"string"===typeof n?(n=h.FINDFIELD(e,n),e=w.rest(e[n])):e=w.rest(e[n]);for(var o=n=0;o<a.length;o++)n+=e[a[o]];return 0===a.length?r.div0:n/a.length},DCOUNT:function(e,t,n){},DCOUNTA:function(e,t,n){},DGET:function(e,n,a){return isNaN(n)&&"string"!==typeof n?r.value:(a=t(e,a),"string"===typeof n?(n=h.FINDFIELD(e,n),e=w.rest(e[n])):e=w.rest(e[n]),0===a.length?r.value:1<a.length?r.num:e[a[0]])},DMAX:function(e,n,a){if(isNaN(n)&&"string"!==typeof n)return r.value;a=t(e,a),"string"===typeof n?(n=h.FINDFIELD(e,n),e=w.rest(e[n])):e=w.rest(e[n]),n=e[a[0]];for(var o=1;o<a.length;o++)n<e[a[o]]&&(n=e[a[o]]);return n},DMIN:function(e,n,a){if(isNaN(n)&&"string"!==typeof n)return r.value;a=t(e,a),"string"===typeof n?(n=h.FINDFIELD(e,n),e=w.rest(e[n])):e=w.rest(e[n]),n=e[a[0]];for(var o=1;o<a.length;o++)n>e[a[o]]&&(n=e[a[o]]);return n},DPRODUCT:function(e,n,a){if(isNaN(n)&&"string"!==typeof n)return r.value;if(a=t(e,a),"string"===typeof n){n=h.FINDFIELD(e,n);var o=w.rest(e[n])}else o=w.rest(e[n]);for(e=[],n=0;n<a.length;n++)e[n]=o[a[n]];if(a=e)for(e=[],n=0;n<a.length;++n)a[n]&&e.push(a[n]);else e=a;for(a=1,n=0;n<e.length;n++)a*=e[n];return a},DSTDEV:function(e,t,n){},DSTDEVP:function(e,t,n){},DSUM:function(e,t,n){},DVAR:function(e,t,n){},DVARP:function(e,t,n){},MATCH:function(e,t,n){if(!e&&!t)return r.na;if(2===arguments.length&&(n=1),!(t instanceof Array)||-1!==n&&0!==n&&1!==n)return r.na;for(var a,o,i=0;i<t.length;i++)if(1===n){if(t[i]===e)return i+1;t[i]<e&&(o?t[i]>o&&(a=i+1,o=t[i]):(a=i+1,o=t[i]))}else if(0===n){if("string"===typeof e){if(e=e.replace(/\?/g,"."),t[i].toLowerCase().match(e.toLowerCase()))return i+1}else if(t[i]===e)return i+1}else if(-1===n){if(t[i]===e)return i+1;t[i]>e&&(o?t[i]<o&&(a=i+1,o=t[i]):(a=i+1,o=t[i]))}return a||r.na}};return h}(),k.engineering=function(){var e={BESSELI:function(e,t){},BESSELJ:function(e,t){},BESSELK:function(e,t){},BESSELY:function(e,t){},BIN2DEC:function(e){if(!/^[01]{1,10}$/.test(e))return r.num;var t=parseInt(e,2);return e=e.toString(),10===e.length&&"1"===e.substring(0,1)?parseInt(e.substring(1),2)-512:t},BIN2HEX:function(e,t){if(!/^[01]{1,10}$/.test(e))return r.num;var n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?(0xfffffffe00+parseInt(n.substring(1),2)).toString(16):(n=parseInt(e,2).toString(16),void 0===t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t),t>=n.length?REPT("0",t-n.length)+n:r.num))},BIN2OCT:function(e,t){if(!/^[01]{1,10}$/.test(e))return r.num;var n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?(1073741312+parseInt(n.substring(1),2)).toString(8):(n=parseInt(e,2).toString(8),void 0===t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t),t>=n.length?REPT("0",t-n.length)+n:r.num))},BITAND:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>e||0>t||Math.floor(e)!==e||Math.floor(t)!==t||0xffffffffffff<e||0xffffffffffff<t?r.num:e&t},BITLSHIFT:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>e||Math.floor(e)!==e||0xffffffffffff<e||53<Math.abs(t)?r.num:0<=t?e<<t:e>>-t},BITOR:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>e||0>t||Math.floor(e)!==e||Math.floor(t)!==t||0xffffffffffff<e||0xffffffffffff<t?r.num:e|t},BITRSHIFT:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>e||Math.floor(e)!==e||0xffffffffffff<e||53<Math.abs(t)?r.num:0<=t?e>>t:e<<-t},BITXOR:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>e||0>t||Math.floor(e)!==e||Math.floor(t)!==t||0xffffffffffff<e||0xffffffffffff<t?r.num:e^t},COMPLEX:function(e,t,n){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?e:(n=void 0===n?"i":n,"i"!==n&&"j"!==n?r.value:0===e&&0===t?0:0===e?1===t?n:t.toString()+n:0===t?e.toString():e.toString()+(0<t?"+":"")+(1===t?n:t.toString()+n))},CONVERT:function(e,t,n){if(e=w.parseNumber(e),e instanceof Error)return e;for(var a,o=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],i={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},s={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},l=null,u=null,c=t,d=n,p=1,f=1,h=0;h<o.length;h++)a=null===o[h][2]?[]:o[h][2],(o[h][1]===c||0<=a.indexOf(c))&&(l=o[h]),(o[h][1]===d||0<=a.indexOf(d))&&(u=o[h]);if(null===l)for(a=i[t.substring(0,2)],h=s[t.substring(0,1)],"da"===t.substring(0,2)&&(h=["dekao",10,"da"]),a?(p=a[2],c=t.substring(2)):h&&(p=h[1],c=t.substring(h[2].length)),t=0;t<o.length;t++)a=null===o[t][2]?[]:o[t][2],(o[t][1]===c||0<=a.indexOf(c))&&(l=o[t]);if(null===u)for(i=i[n.substring(0,2)],s=s[n.substring(0,1)],"da"===n.substring(0,2)&&(s=["dekao",10,"da"]),i?(f=i[2],d=n.substring(2)):s&&(f=s[1],d=n.substring(s[2].length)),n=0;n<o.length;n++)a=null===o[n][2]?[]:o[n][2],(o[n][1]===d||0<=a.indexOf(d))&&(u=o[n]);return null===l||null===u||l[3]!==u[3]?r.na:e*l[6]*p/(u[6]*f)},DEC2BIN:function(e,t){if(e=w.parseNumber(e),e instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||-512>e||511<e)return r.num;if(0>e)return"1"+REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);var n=parseInt(e,10).toString(2);return"undefined"===typeof t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t),t>=n.length?REPT("0",t-n.length)+n:r.num)},DEC2HEX:function(e,t){if(e=w.parseNumber(e),e instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||-549755813888>e||549755813887<e)return r.num;if(0>e)return(1099511627776+e).toString(16);var n=parseInt(e,10).toString(16);return"undefined"===typeof t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t),t>=n.length?REPT("0",t-n.length)+n:r.num)},DEC2OCT:function(e,t){if(e=w.parseNumber(e),e instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||-536870912>e||536870911<e)return r.num;if(0>e)return(1073741824+e).toString(8);var n=parseInt(e,10).toString(8);return"undefined"===typeof t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t),t>=n.length?REPT("0",t-n.length)+n:r.num)},DELTA:function(e,t){return t=void 0===t?0:t,e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:e===t?1:0},ERF:function(e,t){}};return e.ERF.PRECISE=function(){},e.ERFC=function(e){},e.ERFC.PRECISE=function(){},e.GESTEP=function(e,t){return t=t||0,e=w.parseNumber(e),w.anyIsError(t,e)?e:e>=t?1:0},e.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return r.num;var n=10===e.length&&"f"===e.substring(0,1).toLowerCase(),a=n?parseInt(e,16)-1099511627776:parseInt(e,16);return-512>a||511<a?r.num:n?"1"+REPT("0",9-(512+a).toString(2).length)+(512+a).toString(2):(n=a.toString(2),void 0===t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t),t>=n.length?REPT("0",t-n.length)+n:r.num))},e.HEX2DEC=function(e){return/^[0-9A-Fa-f]{1,10}$/.test(e)?(e=parseInt(e,16),549755813888<=e?e-1099511627776:e):r.num},e.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return r.num;var n=parseInt(e,16);return 536870911<n&&0xffe0000000>n?r.num:0xffe0000000<=n?(n-0xffc0000000).toString(8):(n=n.toString(8),void 0===t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t),t>=n.length?REPT("0",t-n.length)+n:r.num))},e.IMABS=function(t){var n=e.IMREAL(t);return t=e.IMAGINARY(t),w.anyIsError(n,t)?r.value:Math.sqrt(Math.pow(n,2)+Math.pow(t,2))},e.IMAGINARY=function(e){if(void 0===e||!0===e||!1===e)return r.value;if(0===e||"0"===e)return 0;if(0<=["i","j"].indexOf(e))return 1;e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var t=e.indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var a=e.substring(e.length-1,e.length);return a="i"===a||"j"===a,0<=t||0<=n?a?0<=t?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?r.num:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?r.num:-Number(e.substring(n+1,e.length-1)):r.num:a?isNaN(e.substring(0,e.length-1))?r.num:e.substring(0,e.length-1):isNaN(e)?r.num:0},e.IMARGUMENT=function(t){var n=e.IMREAL(t);return t=e.IMAGINARY(t),w.anyIsError(n,t)?r.value:0===n&&0===t?r.div0:0===n&&0<t?Math.PI/2:0===n&&0>t?-Math.PI/2:0===t&&0<n?0:0===t&&0>n?-Math.PI:0<n?Math.atan(t/n):0>n&&0<=t?Math.atan(t/n)+Math.PI:Math.atan(t/n)-Math.PI},e.IMCONJUGATE=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);if(w.anyIsError(n,a))return r.value;var o=t.substring(t.length-1);return 0!==a?e.COMPLEX(n,-a,"i"===o||"j"===o?o:"i"):t},e.IMCOS=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(t=t.substring(t.length-1),e.COMPLEX(Math.cos(n)*(Math.exp(a)+Math.exp(-a))/2,-Math.sin(n)*(Math.exp(a)-Math.exp(-a))/2,"i"===t||"j"===t?t:"i"))},e.IMCOSH=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(t=t.substring(t.length-1),e.COMPLEX(Math.cos(a)*(Math.exp(n)+Math.exp(-n))/2,Math.sin(a)*(Math.exp(n)-Math.exp(-n))/2,"i"===t||"j"===t?t:"i"))},e.IMCOT=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:e.IMDIV(e.IMCOS(t),e.IMSIN(t))},e.IMDIV=function(t,n){var a=e.IMREAL(t),o=e.IMAGINARY(t),i=e.IMREAL(n),s=e.IMAGINARY(n);if(w.anyIsError(a,o,i,s))return r.value;var l=t.substring(t.length-1),u=n.substring(n.length-1),c="i";return("j"===l||"j"===u)&&(c="j"),0===i&&0===s?r.num:(l=i*i+s*s,e.COMPLEX((a*i+o*s)/l,(o*i-a*s)/l,c))},e.IMEXP=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(t=t.substring(t.length-1),n=Math.exp(n),e.COMPLEX(n*Math.cos(a),n*Math.sin(a),"i"===t||"j"===t?t:"i"))},e.IMLN=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(t=t.substring(t.length-1),e.COMPLEX(Math.log(Math.sqrt(n*n+a*a)),Math.atan(a/n),"i"===t||"j"===t?t:"i"))},e.IMLOG10=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(t=t.substring(t.length-1),e.COMPLEX(Math.log(Math.sqrt(n*n+a*a))/Math.log(10),Math.atan(a/n)/Math.log(10),"i"===t||"j"===t?t:"i"))},e.IMLOG2=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(t=t.substring(t.length-1),e.COMPLEX(Math.log(Math.sqrt(n*n+a*a))/Math.log(2),Math.atan(a/n)/Math.log(2),"i"===t||"j"===t?t:"i"))},e.IMPOWER=function(t,n){n=w.parseNumber(n);var a=e.IMREAL(t),o=e.IMAGINARY(t);if(w.anyIsError(n,a,o))return r.value;a=t.substring(t.length-1),a="i"===a||"j"===a?a:"i",o=Math.pow(e.IMABS(t),n);var i=e.IMARGUMENT(t);return e.COMPLEX(o*Math.cos(n*i),o*Math.sin(n*i),a)},e.IMPRODUCT=function(){for(var t=arguments[0],n=1;n<arguments.length;n++){var a=e.IMREAL(t);t=e.IMAGINARY(t);var o=e.IMREAL(arguments[n]),i=e.IMAGINARY(arguments[n]);if(w.anyIsError(a,t,o,i))return r.value;t=e.COMPLEX(a*o-t*i,a*i+t*o)}return t},e.IMREAL=function(e){if(void 0===e||!0===e||!1===e)return r.value;if(0===e||"0"===e||0<="i +i 1i +1i -i -1i j +j 1j +1j -j -1j".split(" ").indexOf(e))return 0;var t=e.indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var a=e.substring(e.length-1,e.length);return a="i"===a||"j"===a,0<=t||0<=n?a?0<=t?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?r.num:Number(e.substring(0,t)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?r.num:Number(e.substring(0,n)):r.num:a?isNaN(e.substring(0,e.length-1))?r.num:0:isNaN(e)?r.num:e},e.IMSEC=function(t){if(!0===t||!1===t)return r.value;var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:e.IMDIV("1",e.IMCOS(t))},e.IMSECH=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:e.IMDIV("1",e.IMCOSH(t))},e.IMSIN=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(t=t.substring(t.length-1),e.COMPLEX(Math.sin(n)*(Math.exp(a)+Math.exp(-a))/2,Math.cos(n)*(Math.exp(a)-Math.exp(-a))/2,"i"===t||"j"===t?t:"i"))},e.IMSINH=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(t=t.substring(t.length-1),e.COMPLEX(Math.cos(a)*(Math.exp(n)-Math.exp(-n))/2,Math.sin(a)*(Math.exp(n)+Math.exp(-n))/2,"i"===t||"j"===t?t:"i"))},e.IMSQRT=function(t){var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:(n=t.substring(t.length-1),n="i"===n||"j"===n?n:"i",a=Math.sqrt(e.IMABS(t)),t=e.IMARGUMENT(t),e.COMPLEX(a*Math.cos(t/2),a*Math.sin(t/2),n))},e.IMCSC=function(t){if(!0===t||!1===t)return r.value;var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.num:e.IMDIV("1",e.IMSIN(t))},e.IMCSCH=function(t){if(!0===t||!1===t)return r.value;var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.num:e.IMDIV("1",e.IMSINH(t))},e.IMSUB=function(e,t){var n=this.IMREAL(e),a=this.IMAGINARY(e),o=this.IMREAL(t),i=this.IMAGINARY(t);if(w.anyIsError(n,a,o,i))return r.value;var s=e.substring(e.length-1),l=t.substring(t.length-1),u="i";return("j"===s||"j"===l)&&(u="j"),this.COMPLEX(n-o,a-i,u)},e.IMSUM=function(){for(var e=w.flatten(arguments),t=e[0],n=1;n<e.length;n++){var a=this.IMREAL(t);t=this.IMAGINARY(t);var o=this.IMREAL(e[n]),i=this.IMAGINARY(e[n]);if(w.anyIsError(a,t,o,i))return r.value;t=this.COMPLEX(a+o,t+i)}return t},e.IMTAN=function(t){if(!0===t||!1===t)return r.value;var n=e.IMREAL(t),a=e.IMAGINARY(t);return w.anyIsError(n,a)?r.value:this.IMDIV(this.IMSIN(t),this.IMCOS(t))},e.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return r.num;var n=10===e.length&&"7"===e.substring(0,1),a=n?parseInt(e,8)-1073741824:parseInt(e,8);return-512>a||511<a?r.num:n?"1"+REPT("0",9-(512+a).toString(2).length)+(512+a).toString(2):(n=a.toString(2),"undefined"===typeof t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t),t>=n.length?REPT("0",t-n.length)+n:r.num))},e.OCT2DEC=function(e){return/^[0-7]{1,10}$/.test(e)?(e=parseInt(e,8),536870912<=e?e-1073741824:e):r.num},e.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return r.num;var n=parseInt(e,8);return 536870912<=n?"ff"+(n+3221225472).toString(16):(n=n.toString(16),void 0===t?n:isNaN(t)?r.value:0>t?r.num:(t=Math.floor(t),t>=n.length?REPT("0",t-n.length)+n:r.num))},e}(),k.financial=function(){function e(e){return e&&e.getTime&&!isNaN(e.getTime())}function t(e){return e instanceof Date?e:new Date(e)}var n={ACCRINT:function(n,r,a,o,i,s,l){return n=t(n),r=t(r),a=t(a),e(n)&&e(r)&&e(a)?0>=o||0>=i||-1===[1,2,4].indexOf(s)||-1===[0,1,2,3,4].indexOf(l)||a<=n?"#NUM!":(i||0)*o*YEARFRAC(n,a,l||0):"#VALUE!"},ACCRINTM:null,AMORDEGRC:null,AMORLINC:null,COUPDAYBS:null,COUPDAYS:null,COUPDAYSNC:null,COUPNCD:null,COUPNUM:null,COUPPCD:null,CUMIPMT:function(e,t,a,o,i,s){if(e=w.parseNumber(e),t=w.parseNumber(t),a=w.parseNumber(a),w.anyIsError(e,t,a))return r.value;if(0>=e||0>=t||0>=a||1>o||1>i||o>i||0!==s&&1!==s)return r.num;t=n.PMT(e,t,a,0,s);var l=0;for(1===o&&0===s&&(l=-a,o++);o<=i;o++)l=1===s?l+(n.FV(e,o-2,t,a,1)-t):l+n.FV(e,o-1,t,a,0);return l*e},CUMPRINC:function(e,t,a,o,i,s){if(e=w.parseNumber(e),t=w.parseNumber(t),a=w.parseNumber(a),w.anyIsError(e,t,a))return r.value;if(0>=e||0>=t||0>=a||1>o||1>i||o>i||0!==s&&1!==s)return r.num;t=n.PMT(e,t,a,0,s);var l=0;for(1===o&&(l=0===s?t+a*e:t,o++);o<=i;o++)l=0<s?l+(t-(n.FV(e,o-2,t,a,1)-t)*e):l+(t-n.FV(e,o-1,t,a,0)*e);return l},DB:function(e,t,n,a,o){if(o=void 0===o?12:o,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),o=w.parseNumber(o),w.anyIsError(e,t,n,a,o))return r.value;if(0>e||0>t||0>n||0>a||-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(o)||a>n)return r.num;if(t>=e)return 0;t=(1-Math.pow(t/e,1/n)).toFixed(3);for(var i=o=e*t*o/12,s=0,l=a===n?n-1:a,u=2;u<=l;u++)s=(e-i)*t,i+=s;return 1===a?o:a===n?(e-i)*t:s},DDB:function(e,t,n,a,o){if(o=void 0===o?2:o,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),o=w.parseNumber(o),w.anyIsError(e,t,n,a,o))return r.value;if(0>e||0>t||0>n||0>a||0>=o||a>n)return r.num;if(t>=e)return 0;for(var i=0,s=0,l=1;l<=a;l++)s=Math.min(o/n*(e-i),e-t-i),i+=s;return s},DISC:null,DOLLARDE:function(e,t){if(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t))return r.value;if(0>t)return r.num;if(0<=t&&1>t)return r.div0;t=parseInt(t,10);var n=parseInt(e,10);n+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var a=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return Math.round(n*a)/a},DOLLARFR:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>t?r.num:0<=t&&1>t?r.div0:(t=parseInt(t,10),parseInt(e,10)+e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t)},DURATION:null,EFFECT:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>=e||1>t?r.num:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},FV:function(e,t,n,a,o){return a=a||0,o=o||0,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),o=w.parseNumber(o),w.anyIsError(e,t,n,a,o)?r.value:(0===e?e=a+n*t:(t=Math.pow(1+e,t),e=1===o?a*t+n*(1+e)*(t-1)/e:a*t+n*(t-1)/e),-e)},FVSCHEDULE:function(e,t){if(e=w.parseNumber(e),t=w.parseNumberArray(w.flatten(t)),w.anyIsError(e,t))return r.value;for(var n=t.length,a=e,o=0;o<n;o++)a*=1+t[o];return a},INTRATE:null,IPMT:function(e,t,a,o,i,s){return i=i||0,s=s||0,e=w.parseNumber(e),t=w.parseNumber(t),a=w.parseNumber(a),o=w.parseNumber(o),i=w.parseNumber(i),s=w.parseNumber(s),w.anyIsError(e,t,a,o,i,s)?r.value:(a=n.PMT(e,a,o,i,s),(1===t?1===s?0:-o:1===s?n.FV(e,t-2,a,o,1)-a:n.FV(e,t-1,a,o,0))*e)},IRR:function(e,t){if(t=t||0,e=w.parseNumberArray(w.flatten(e)),t=w.parseNumber(t),w.anyIsError(e,t))return r.value;for(var n=function(e,t,n){n+=1;for(var r=e[0],a=1;a<e.length;a++)r+=e[a]/Math.pow(n,(t[a]-t[0])/365);return r},a=function(e,t,n){n+=1;for(var r=0,a=1;a<e.length;a++){var o=(t[a]-t[0])/365;r-=o*e[a]/Math.pow(n,o+1)}return r},o=[],i=!1,s=!1,l=0;l<e.length;l++)o[l]=0===l?0:o[l-1]+365,0<e[l]&&(i=!0),0>e[l]&&(s=!0);if(!i||!s)return r.num;i=void 0===t?.1:t,s=!0;do{var u=n(e,o,i);s=i-u/a(e,o,i),l=Math.abs(s-i),i=s,s=1e-10<l&&1e-10<Math.abs(u)}while(s);return i},ISPMT:function(e,t,n,a){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),w.anyIsError(e,t,n,a)?r.value:a*e*(t/n-1)},MDURATION:null,MIRR:function(e,t,a){if(e=w.parseNumberArray(w.flatten(e)),t=w.parseNumber(t),a=w.parseNumber(a),w.anyIsError(e,t,a))return r.value;for(var o=e.length,i=[],s=[],l=0;l<o;l++)0>e[l]?i.push(e[l]):s.push(e[l]);return e=-n.NPV(a,s)*Math.pow(1+a,o-1),t=n.NPV(t,i)*(1+t),Math.pow(e/t,1/(o-1))-1},NOMINAL:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>=e||1>t?r.num:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},NPER:function(e,t,n,a,o){return o=void 0===o?0:o,a=void 0===a?0:a,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),o=w.parseNumber(o),w.anyIsError(e,t,n,a,o)?r.value:Math.log((t*(1+e*o)-a*e)/(n*e+t*(1+e*o)))/Math.log(1+e)},NPV:function(){var e=w.parseNumberArray(w.flatten(arguments));if(e instanceof Error)return e;for(var t=e[0],n=0,r=1;r<e.length;r++)n+=e[r]/Math.pow(1+t,r);return n},ODDFPRICE:null,ODDFYIELD:null,ODDLPRICE:null,ODDLYIELD:null,PDURATION:function(e,t,n){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0>=e?r.num:(Math.log(n)-Math.log(t))/Math.log(1+e)},PMT:function(e,t,n,a,o){return a=a||0,o=o||0,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),o=w.parseNumber(o),w.anyIsError(e,t,n,a,o)?r.value:(0===e?e=(n+a)/t:(t=Math.pow(1+e,t),e=1===o?(a*e/(t-1)+n*e/(1-1/t))/(1+e):a*e/(t-1)+n*e/(1-1/t)),-e)},PPMT:function(e,t,a,o,i,s){return i=i||0,s=s||0,e=w.parseNumber(e),a=w.parseNumber(a),o=w.parseNumber(o),i=w.parseNumber(i),s=w.parseNumber(s),w.anyIsError(e,a,o,i,s)?r.value:n.PMT(e,a,o,i,s)-n.IPMT(e,t,a,o,i,s)},PRICE:null,PRICEDISC:null,PRICEMAT:null,PV:function(e,t,n,a,o){return a=a||0,o=o||0,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),o=w.parseNumber(o),w.anyIsError(e,t,n,a,o)?r.value:0===e?-n*t-a:((1-Math.pow(1+e,t))/e*n*(1+e*o)-a)/Math.pow(1+e,t)},RATE:function(e,t,n,a,o,i){if(i=void 0===i?.01:i,a=void 0===a?0:a,o=void 0===o?0:o,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),o=w.parseNumber(o),i=w.parseNumber(i),w.anyIsError(e,t,n,a,o,i))return r.value;for(var s=0,l=!1;100>s&&!l;){var u=Math.pow(i+1,e),c=Math.pow(i+1,e-1);u=i-(a+u*n+t*(u-1)*(i*o+1)/i)/(e*c*n-t*(u-1)*(i*o+1)/Math.pow(i,2)+(e*t*c*(i*o+1)/i+t*(u-1)*o/i)),1e-6>Math.abs(u-i)&&(l=!0),s++,i=u}return l?i:Number.NaN+i},RECEIVED:null,RRI:function(e,t,n){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0===e||0===t?r.num:Math.pow(n/t,1/e)-1},SLN:function(e,t,n){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0===n?r.num:(e-t)/n},SYD:function(e,t,n,a){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumber(a),w.anyIsError(e,t,n,a)?r.value:0===n||1>a||a>n?r.num:(a=parseInt(a,10),(e-t)*(n-a+1)*2/(n*(n+1)))},TBILLEQ:function(e,t,n){return e=w.parseDate(e),t=w.parseDate(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0>=n||e>t||31536e6<t-e?r.num:365*n/(360-n*DAYS360(e,t,!1))},TBILLPRICE:function(e,t,n){return e=w.parseDate(e),t=w.parseDate(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0>=n||e>t||31536e6<t-e?r.num:100*(1-n*DAYS360(e,t,!1)/360)},TBILLYIELD:function(e,t,n){return e=w.parseDate(e),t=w.parseDate(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0>=n||e>t||31536e6<t-e?r.num:360*(100-n)/(n*DAYS360(e,t,!1))},VDB:null,XIRR:function(e,t,n){if(e=w.parseNumberArray(w.flatten(e)),t=w.parseDateArray(w.flatten(t)),n=w.parseNumber(n),w.anyIsError(e,t,n))return r.value;for(var a=function(e,t,n){n+=1;for(var r=e[0],a=1;a<e.length;a++)r+=e[a]/Math.pow(n,DAYS(t[a],t[0])/365);return r},o=function(e,t,n){n+=1;for(var r=0,a=1;a<e.length;a++){var o=DAYS(t[a],t[0])/365;r-=o*e[a]/Math.pow(n,o+1)}return r},i=!1,s=!1,l=0;l<e.length;l++)0<e[l]&&(i=!0),0>e[l]&&(s=!0);if(!i||!s)return r.num;n=n||.1,i=!0;do{l=a(e,t,n),i=n-l/o(e,t,n),s=Math.abs(i-n),n=i,i=1e-10<s&&1e-10<Math.abs(l)}while(i);return n},XNPV:function(e,t,n){if(e=w.parseNumber(e),t=w.parseNumberArray(w.flatten(t)),n=w.parseDateArray(w.flatten(n)),w.anyIsError(e,t,n))return r.value;for(var a=0,o=0;o<t.length;o++)a+=t[o]/Math.pow(1+e,DAYS(n[o],n[0])/365);return a},YIELD:null,YIELDDISC:null,YIELDMAT:null};return n}(),k.information=function(){var e={CELL:null,ERROR:{}};return e.ERROR.TYPE=function(e){switch(e){case r.nil:return 1;case r.div0:return 2;case r.value:return 3;case r.ref:return 4;case r.name:return 5;case r.num:return 6;case r.na:return 7;case r.data:return 8}return r.na},e.INFO=null,e.ISBLANK=function(e){return null===e},e.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)},e.ISERR=function(e){return 0<=[r.value,r.ref,r.div0,r.num,r.name,r.nil].indexOf(e)||"number"===typeof e&&(isNaN(e)||!isFinite(e))},e.ISERROR=function(t){return e.ISERR(t)||t===r.na},e.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},e.ISFORMULA=null,e.ISLOGICAL=function(e){return!0===e||!1===e},e.ISNA=function(e){return e===r.na},e.ISNONTEXT=function(e){return"string"!==typeof e},e.ISNUMBER=function(e){return"number"===typeof e&&!isNaN(e)&&isFinite(e)},e.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},e.ISREF=null,e.ISTEXT=function(e){return"string"===typeof e},e.N=function(e){return this.ISNUMBER(e)?e:e instanceof Date?e.getTime():!0===e?1:!1===e?0:this.ISERROR(e)?e:0},e.NA=function(){return r.na},e.SHEET=null,e.SHEETS=null,e.TYPE=function(e){return this.ISNUMBER(e)?1:this.ISTEXT(e)?2:this.ISLOGICAL(e)?4:this.ISERROR(e)?16:Array.isArray(e)?64:void 0},e}(),k.logical=function(){return{AND:function(){for(var e=w.flatten(arguments),t=!0,n=0;n<e.length;n++)e[n]||(t=!1);return t},CHOOSE:function(){if(2>arguments.length)return r.na;var e=arguments[0];return 1>e||254<e||arguments.length<e+1?r.value:arguments[e]},FALSE:function(){return!1},IF:function(e,t,n){return e?t:n},IFERROR:function(e,t){return ISERROR(e)?t:e},IFNA:function(e,t){return e===r.na?t:e},NOT:function(e){return!e},OR:function(){for(var e=w.flatten(arguments),t=!1,n=0;n<e.length;n++)e[n]&&(t=!0);return t},TRUE:function(){return!0},XOR:function(){for(var e=w.flatten(arguments),t=0,n=0;n<e.length;n++)e[n]&&t++;return!!(1&Math.floor(Math.abs(t)))},SWITCH:function(){if(0<arguments.length){var e=arguments[0],t=arguments.length-1,n=Math.floor(t/2),r=!1;if(t=0===t%2?null:arguments[arguments.length-1],n)for(var a=0;a<n;a++)if(e===arguments[2*a+1]){var o=arguments[2*a+2];r=!0;break}!r&&t&&(o=t)}return o}}}(),k.math=function(){var t={ABS:function(e){return e=w.parseNumber(e),e instanceof Error?e:Math.abs(w.parseNumber(e))},ACOS:function(e){return e=w.parseNumber(e),e instanceof Error?e:Math.acos(e)},ACOSH:function(e){return e=w.parseNumber(e),e instanceof Error?e:Math.log(e+Math.sqrt(e*e-1))},ACOT:function(e){return e=w.parseNumber(e),e instanceof Error?e:Math.atan(1/e)},ACOTH:function(e){return e=w.parseNumber(e),e instanceof Error?e:.5*Math.log((e+1)/(e-1))},AGGREGATE:null,ARABIC:function(e){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return r.value;var t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(e){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]})),t},ASIN:function(e){return e=w.parseNumber(e),e instanceof Error?e:Math.asin(e)},ASINH:function(e){return e=w.parseNumber(e),e instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},ATAN:function(e){return e=w.parseNumber(e),e instanceof Error?e:Math.atan(e)},ATAN2:function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:Math.atan2(e,t)},ATANH:function(e){return e=w.parseNumber(e),e instanceof Error?e:Math.log((1+e)/(1-e))/2},BASE:function(e,t,n){return n=n||0,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:(n=void 0===n?0:n,e=e.toString(t),Array(Math.max(n+1-e.length,0)).join("0")+e)},CEILING:function(e,t,n){return t=void 0===t?1:t,n=void 0===n?0:n,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0===t?0:(t=Math.abs(t),0<=e?Math.ceil(e/t)*t:0===n?-1*Math.floor(Math.abs(e)/t)*t:-1*Math.ceil(Math.abs(e)/t)*t)}};t.CEILING.MATH=t.CEILING,t.CEILING.PRECISE=t.CEILING,t.COMBIN=function(e,n){return e=w.parseNumber(e),n=w.parseNumber(n),w.anyIsError(e,n)?r.value:t.FACT(e)/(t.FACT(n)*t.FACT(e-n))},t.COMBINA=function(e,n){return e=w.parseNumber(e),n=w.parseNumber(n),w.anyIsError(e,n)?r.value:0===e&&0===n?1:t.COMBIN(e+n-1,e-1)},t.COS=function(e){return e=w.parseNumber(e),e instanceof Error?e:Math.cos(e)},t.COSH=function(e){return e=w.parseNumber(e),e instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},t.COT=function(e){return e=w.parseNumber(e),e instanceof Error?e:1/Math.tan(e)},t.COTH=function(e){return e=w.parseNumber(e),e instanceof Error?e:(e=Math.exp(2*e),(e+1)/(e-1))},t.CSC=function(e){return e=w.parseNumber(e),e instanceof Error?e:1/Math.sin(e)},t.CSCH=function(e){return e=w.parseNumber(e),e instanceof Error?e:2/(Math.exp(e)-Math.exp(-e))},t.DECIMAL=function(e,t){return 1>arguments.length?r.value:parseInt(e,t)},t.DEGREES=function(e){return e=w.parseNumber(e),e instanceof Error?e:180*e/Math.PI},t.EVEN=function(e){return e=w.parseNumber(e),e instanceof Error?e:t.CEILING(e,-2,-1)},t.EXP=Math.exp;var h=[];return t.FACT=function(e){return e=w.parseNumber(e),e instanceof Error?e:(e=Math.floor(e),0===e||1===e?1:(0<h[e]||(h[e]=t.FACT(e-1)*e),h[e]))},t.FACTDOUBLE=function(e){return e=w.parseNumber(e),e instanceof Error?e:(e=Math.floor(e),0>=e?1:e*t.FACTDOUBLE(e-2))},t.FLOOR=function(e,t,n){return t=void 0===t?1:t,n=void 0===n?0:n,e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:0===t?0:(t=Math.abs(t),0<=e?Math.floor(e/t)*t:0===n?-1*Math.ceil(Math.abs(e)/t)*t:-1*Math.floor(Math.abs(e)/t)*t)},t.FLOOR.MATH=t.FLOOR,t.GCD=null,t.INT=function(e){return e=w.parseNumber(e),e instanceof Error?e:Math.floor(e)},t.LCM=function(){var e=w.parseNumberArray(w.flatten(arguments));if(e instanceof Error)return e;for(var t,n,r,a=1;void 0!==(r=e.pop());)for(;1<r;){if(r%2){for(t=3,n=Math.floor(Math.sqrt(r));t<=n&&r%t;t+=2);n=t<=n?t:r}else n=2;for(r/=n,a*=n,t=e.length;t;0===e[--t]%n&&1===(e[t]/=n)&&e.splice(t,1));}return a},t.LN=function(e){return e=w.parseNumber(e),e instanceof Error?e:Math.log(e)},t.LOG=function(e,t){return e=w.parseNumber(e),t=void 0===t?10:w.parseNumber(t),w.anyIsError(e,t)?r.value:Math.log(e)/Math.log(t)},t.LOG10=function(e){return e=w.parseNumber(e),e instanceof Error?e:Math.log(e)/Math.log(10)},t.MDETERM=null,t.MINVERSE=null,t.MMULT=null,t.MOD=function(e,t){if(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t))return r.value;if(0===t)return r.div0;var n=Math.abs(e%t);return 0<t?n:-n},t.MROUND=function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0>e*t?r.num:Math.round(e/t)*t},t.MULTINOMIAL=function(){var e=w.parseNumberArray(w.flatten(arguments));if(e instanceof Error)return e;for(var n=0,r=1,a=0;a<e.length;a++)n+=e[a],r*=t.FACT(e[a]);return t.FACT(n)/r},t.MUNIT=null,t.ODD=function(e){if(e=w.parseNumber(e),e instanceof Error)return e;var t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,0<e?t:-t},t.PI=function(){return Math.PI},t.POWER=function(e,t){if(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t))return r.value;var n=Math.pow(e,t);return isNaN(n)?r.num:n},t.PRODUCT=function(){var e=w.parseNumberArray(w.flatten(arguments));if(e instanceof Error)return e;for(var t=1,n=0;n<e.length;n++)t*=e[n];return t},t.QUOTIENT=function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:parseInt(e/t,10)},t.RADIANS=function(e){return e=w.parseNumber(e),e instanceof Error?e:e*Math.PI/180},t.RAND=function(){return Math.random()},t.RANDBETWEEN=function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:e+Math.ceil((t-e+1)*Math.random())-1},t.ROMAN=null,t.ROUND=function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:Math.round(e*Math.pow(10,t))/Math.pow(10,t)},t.ROUNDDOWN=function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:(0<e?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.ROUNDUP=function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:(0<e?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.SEC=function(e){return e=w.parseNumber(e),e instanceof Error?e:1/Math.cos(e)},t.SECH=function(e){return e=w.parseNumber(e),e instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},t.SERIESSUM=function(e,t,n,a){if(e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),a=w.parseNumberArray(a),w.anyIsError(e,t,n,a))return r.value;for(var o=a[0]*Math.pow(e,t),i=1;i<a.length;i++)o+=a[i]*Math.pow(e,t+i*n);return o},t.SIGN=function(e){return e=w.parseNumber(e),e instanceof Error?e:0>e?-1:0===e?0:1},t.SIN=function(e){return e=w.parseNumber(e),e instanceof Error?e:Math.sin(e)},t.SINH=function(e){return e=w.parseNumber(e),e instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},t.SQRT=function(e){return e=w.parseNumber(e),e instanceof Error?e:0>e?r.num:Math.sqrt(e)},t.SQRTPI=function(e){return e=w.parseNumber(e),e instanceof Error?e:Math.sqrt(e*Math.PI)},t.SUBTOTAL=null,t.ADD=function(e,t){return 2!==arguments.length?r.na:(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:e+t)},t.MINUS=function(e,t){return 2!==arguments.length?r.na:(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:e-t)},t.DIVIDE=function(e,t){return 2!==arguments.length?r.na:(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:0===t?r.div0:e/t)},t.MULTIPLY=function(e,t){return 2!==arguments.length?r.na:(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:e*t)},t.GTE=function(e,t){return 2!==arguments.length?r.na:(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.error:e>=t)},t.LT=function(e,t){return 2!==arguments.length?r.na:(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.error:e<t)},t.LTE=function(e,t){return 2!==arguments.length?r.na:(e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.error:e<=t)},t.EQ=function(e,t){return 2!==arguments.length?r.na:e===t},t.NE=function(e,t){return 2!==arguments.length?r.na:e!==t},t.POW=function(e,n){return 2!==arguments.length?r.na:(e=w.parseNumber(e),n=w.parseNumber(n),w.anyIsError(e,n)?r.error:t.POWER(e,n))},t.SUM=function(){for(var e=0,n=Object.keys(arguments),r=0;r<n.length;++r){var a=arguments[n[r]];"number"===typeof a?e+=a:"string"===typeof a?(a=parseFloat(a),!isNaN(a)&&(e+=a)):Array.isArray(a)&&(e+=t.SUM.apply(null,a))}return e},t.SUMIF=function(){var f=w.argsToArray(arguments),b=f.pop();if(f=w.parseNumberArray(w.flatten(f)),f instanceof Error)return f;for(var c=0,e=0;e<f.length;e++)c+=eval(f[e]+b)?f[e]:0;return c},t.SUMIFS=function(){var f=w.argsToArray(arguments),b=w.parseNumberArray(w.flatten(f.shift()));if(b instanceof Error)return b;for(var c=b.length,e=f.length,g=0,l=0;l<c;l++){for(var p=b[l],u="",m=0;m<e;m+=2)u=isNaN(f[m][l])?u+'"'+f[m][l]+'"'+f[m+1]:u+(f[m][l]+f[m+1]),m!==e-1&&(u+=" && ");u=u.slice(0,-4),eval(u)&&(g+=p)}return g},t.SUMPRODUCT=null,t.SUMSQ=function(){var e=w.parseNumberArray(w.flatten(arguments));if(e instanceof Error)return e;for(var t=0,n=e.length,r=0;r<n;r++)t+=ISNUMBER(e[r])?e[r]*e[r]:0;return t},t.SUMX2MY2=function(e,t){if(e=w.parseNumberArray(w.flatten(e)),t=w.parseNumberArray(w.flatten(t)),w.anyIsError(e,t))return r.value;for(var n=0,a=0;a<e.length;a++)n+=e[a]*e[a]-t[a]*t[a];return n},t.SUMX2PY2=function(e,t){if(e=w.parseNumberArray(w.flatten(e)),t=w.parseNumberArray(w.flatten(t)),w.anyIsError(e,t))return r.value;var n=0;e=w.parseNumberArray(w.flatten(e)),t=w.parseNumberArray(w.flatten(t));for(var a=0;a<e.length;a++)n+=e[a]*e[a]+t[a]*t[a];return n},t.SUMXMY2=function(e,t){if(e=w.parseNumberArray(w.flatten(e)),t=w.parseNumberArray(w.flatten(t)),w.anyIsError(e,t))return r.value;var n=0;e=w.flatten(e),t=w.flatten(t);for(var a=0;a<e.length;a++)n+=Math.pow(e[a]-t[a],2);return n},t.TAN=function(e){return e=w.parseNumber(e),e instanceof Error?e:Math.tan(e)},t.TANH=function(e){return e=w.parseNumber(e),e instanceof Error?e:(e=Math.exp(2*e),(e-1)/(e+1))},t.TRUNC=function(e,t){return t=void 0===t?0:t,e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:(0<e?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t}(),k.misc=function(){var e={UNIQUE:function(){for(var e=[],t=0;t<arguments.length;++t){for(var n=!1,r=arguments[t],a=0;a<e.length&&!(n=e[a]===r);++a);n||e.push(r)}return e}};return e.FLATTEN=w.flatten,e.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},e.REFERENCE=function(e,t){try{for(var n=t.split("."),r=e,a=0;a<n.length;++a){var o=n[a];if("]"===o[o.length-1]){var i=o.indexOf("["),s=o.substring(i+1,o.length-1);r=r[o.substring(0,i)][s]}else r=r[o]}return r}catch(l){}},e.JOIN=function(e,t){return e.join(t)},e.NUMBERS=function(){return w.flatten(arguments).filter((function(e){return"number"===typeof e}))},e.NUMERAL=null,e}(),k.text=function(){var e={ASC:null,BAHTTEXT:null,CHAR:function(e){return e=w.parseNumber(e),e instanceof Error?e:String.fromCharCode(e)},CLEAN:function(e){return(e||"").replace(/[\0-\x1F]/g,"")},CODE:function(e){return(e||"").charCodeAt(0)},CONCATENATE:function(){for(var e,t=w.flatten(arguments);-1<(e=t.indexOf(!0));)t[e]="TRUE";for(;-1<(e=t.indexOf(!1));)t[e]="FALSE";return t.join("")},DBCS:null,DOLLAR:null,EXACT:function(e,t){return e===t},FIND:function(e,t,n){return t?t.indexOf(e,(void 0===n?0:n)-1)+1:null},FIXED:null,HTML2TEXT:function(e){var t="";return e&&(e instanceof Array?e.forEach((function(e){""!==t&&(t+="\n"),t+=e.replace(/<(?:.|\n)*?>/gm,"")})):t=e.replace(/<(?:.|\n)*?>/gm,"")),t},LEFT:function(e,t){return t=w.parseNumber(void 0===t?1:t),t instanceof Error||"string"!==typeof e?r.value:e?e.substring(0,t):null},LEN:function(e){return 0===arguments.length?r.error:"string"===typeof e?e?e.length:0:e.length?e.length:r.value},LOWER:function(e){return"string"!==typeof e?r.value:e?e.toLowerCase():e},MID:function(e,t,n){return t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(t,n)||"string"!==typeof e?n:(--t,e.substring(t,t+n))},NUMBERVALUE:null,PRONETIC:null,PROPER:function(e){return void 0===e||0===e.length?r.value:(!0===e&&(e="TRUE"),!1===e&&(e="FALSE"),isNaN(e)&&"number"===typeof e?r.value:("number"===typeof e&&(e=""+e),e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))))},REGEXEXTRACT:function(e,t){var n=e.match(new RegExp(t));return n?n[1<n.length?n.length-1:0]:null},REGEXMATCH:function(e,t,n){return e=e.match(new RegExp(t)),n?e:!!e},REGEXREPLACE:function(e,t,n){return e.replace(new RegExp(t),n)},REPLACE:function(e,t,n,a){return t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(t,n)||"string"!==typeof e||"string"!==typeof a?r.value:e.substr(0,t-1)+a+e.substr(t-1+n)},REPT:function(e,t){return t=w.parseNumber(t),t instanceof Error?t:Array(t+1).join(e)},RIGHT:function(e,t){return t=w.parseNumber(void 0===t?1:t),t instanceof Error?t:e?e.substring(e.length-t):null},SEARCH:function(e,t,n){return"string"!==typeof e||"string"!==typeof t?r.value:(n=void 0===n?0:n,e=t.toLowerCase().indexOf(e.toLowerCase(),n-1)+1,0===e?r.value:e)},SPLIT:function(e,t){return e.split(t)},SUBSTITUTE:function(e,t,n,r){if(!(e&&t&&n))return e;if(void 0===r)return e.replace(new RegExp(t,"g"),n);for(var a=0,o=0;0<e.indexOf(t,a);)if(a=e.indexOf(t,a+1),o++,o===r)return e.substring(0,a)+n+e.substring(a+t.length)},T:function(e){return"string"===typeof e?e:""},TEXT:null,TRIM:function(e){return"string"!==typeof e?r.value:e.replace(/ +/g," ").trim()}};return e.UNICHAR=e.CHAR,e.UNICODE=e.CODE,e.UPPER=function(e){return"string"!==typeof e?r.value:e.toUpperCase()},e.VALUE=null,e}(),k.stats=function(){var t={AVEDEV:null,AVERAGE:function(){for(var e=w.numbers(w.flatten(arguments)),t=e.length,n=0,r=0,a=0;a<t;a++)n+=e[a],r+=1;return n/r},AVERAGEA:function(){for(var e=w.flatten(arguments),t=e.length,n=0,r=0,a=0;a<t;a++){var o=e[a];"number"===typeof o&&(n+=o),!0===o&&n++,null!==o&&r++}return n/r},AVERAGEIF:function(h,f,b){if(b=b||h,h=w.flatten(h),b=w.parseNumberArray(w.flatten(b)),b instanceof Error)return b;for(var c=0,e=0,g=0;g<h.length;g++)eval(h[g]+f)&&(e+=b[g],c++);return e/c},AVERAGEIFS:null,COUNT:function(){return w.numbers(w.flatten(arguments)).length},COUNTA:function(){var e=w.flatten(arguments);return e.length-t.COUNTBLANK(e)},COUNTIN:function(e,t){for(var n=0,r=0;r<e.length;r++)e[r]===t&&n++;return n},COUNTBLANK:function(){for(var e,t=w.flatten(arguments),n=0,r=0;r<t.length;r++)e=t[r],null!==e&&""!==e||n++;return n},COUNTIF:function(){var h=w.argsToArray(arguments),f=h.pop();h=w.flatten(h),/[<>=!]/.test(f)||(f='=="'+f+'"');for(var b=0,c=0;c<h.length;c++)"string"!==typeof h[c]?eval(h[c]+f)&&b++:eval('"'+h[c]+'"'+f)&&b++;return b},COUNTIFS:function(){for(var h=w.argsToArray(arguments),f=Array(w.flatten(h[0]).length),b=0;b<f.length;b++)f[b]=!0;for(b=0;b<h.length;b+=2){var c=w.flatten(h[b]),e=h[b+1];/[<>=!]/.test(e)||(e='=="'+e+'"');for(var g=0;g<c.length;g++)f[g]="string"!==typeof c[g]?f[g]&&eval(c[g]+e):f[g]&&eval('"'+c[g]+'"'+e)}for(b=h=0;b<f.length;b++)f[b]&&h++;return h},COUNTUNIQUE:function(){return UNIQUE.apply(null,w.flatten(arguments)).length},FISHER:function(e){return e=w.parseNumber(e),e instanceof Error?e:Math.log((1+e)/(1-e))/2},FISHERINV:function(e){return e=w.parseNumber(e),e instanceof Error?e:(e=Math.exp(2*e),(e-1)/(e+1))},FREQUENCY:function(e,t){if(e=w.parseNumberArray(w.flatten(e)),t=w.parseNumberArray(w.flatten(t)),w.anyIsError(e,t))return r.value;for(var n=e.length,a=t.length,o=[],i=0;i<=a;i++)for(var s=o[i]=0;s<n;s++)0===i?e[s]<=t[0]&&(o[0]+=1):i<a?e[s]>t[i-1]&&e[s]<=t[i]&&(o[i]+=1):i===a&&e[s]>t[a-1]&&(o[a]+=1);return o},LARGE:function(e,t){return e=w.parseNumberArray(w.flatten(e)),t=w.parseNumber(t),w.anyIsError(e,t)?e:e.sort((function(e,t){return t-e}))[t-1]},MAX:function(){var e=w.numbers(w.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},MAXA:function(){var e=w.arrayValuesToNumbers(w.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},MIN:function(){var e=w.numbers(w.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},MINA:function(){var e=w.arrayValuesToNumbers(w.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},MODE:{}};return t.MODE.MULT=function(){var e=w.parseNumberArray(w.flatten(arguments));if(e instanceof Error)return e;for(var t,n=e.length,r={},a=[],o=0,i=0;i<n;i++)t=e[i],r[t]=r[t]?r[t]+1:1,r[t]>o&&(o=r[t],a=[]),r[t]===o&&(a[a.length]=t);return a},t.MODE.SNGL=function(){var e=w.parseNumberArray(w.flatten(arguments));return e instanceof Error?e:t.MODE.MULT(e).sort((function(e,t){return e-t}))[0]},t.PERCENTILE={},t.PERCENTILE.EXC=function(e,t){if(e=w.parseNumberArray(w.flatten(e)),t=w.parseNumber(t),w.anyIsError(e,t))return r.value;e=e.sort((function(e,t){return e-t}));var n=e.length;if(t<1/(n+1)||t>1-1/(n+1))return r.num;n=t*(n+1)-1;var a=Math.floor(n);return w.cleanFloat(n===a?e[n]:e[a]+(n-a)*(e[a+1]-e[a]))},t.PERCENTILE.INC=function(e,t){if(e=w.parseNumberArray(w.flatten(e)),t=w.parseNumber(t),w.anyIsError(e,t))return r.value;e=e.sort((function(e,t){return e-t}));var n=t*(e.length-1),a=Math.floor(n);return w.cleanFloat(n===a?e[n]:e[a]+(n-a)*(e[a+1]-e[a]))},t.PERCENTRANK={},t.PERCENTRANK.EXC=function(e,t,n){if(n=void 0===n?3:n,e=w.parseNumberArray(w.flatten(e)),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n))return r.value;e=e.sort((function(e,t){return e-t}));var a=UNIQUE.apply(null,e),o=e.length,i=a.length;n=Math.pow(10,n);for(var s=0,l=!1,u=0;!l&&u<i;)t===a[u]?(s=(e.indexOf(a[u])+1)/(o+1),l=!0):t>=a[u]&&(t<a[u+1]||u===i-1)&&(s=(e.indexOf(a[u])+1+(t-a[u])/(a[u+1]-a[u]))/(o+1),l=!0),u++;return Math.floor(s*n)/n},t.PERCENTRANK.INC=function(e,t,n){if(n=void 0===n?3:n,e=w.parseNumberArray(w.flatten(e)),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n))return r.value;e=e.sort((function(e,t){return e-t}));var a=UNIQUE.apply(null,e),o=e.length,i=a.length;n=Math.pow(10,n);for(var s=0,l=!1,u=0;!l&&u<i;)t===a[u]?(s=e.indexOf(a[u])/(o-1),l=!0):t>=a[u]&&(t<a[u+1]||u===i-1)&&(s=(e.indexOf(a[u])+(t-a[u])/(a[u+1]-a[u]))/(o-1),l=!0),u++;return Math.floor(s*n)/n},t.PERMUT=function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:FACT(e)/FACT(e-t)},t.PERMUTATIONA=function(e,t){return e=w.parseNumber(e),t=w.parseNumber(t),w.anyIsError(e,t)?r.value:Math.pow(e,t)},t.PHI=function(e){return e=w.parseNumber(e),e instanceof Error?r.value:Math.exp(-.5*e*e)/2.5066282746310002},t.PROB=function(e,t,n,a){if(void 0===n)return 0;if(a=void 0===a?n:a,e=w.parseNumberArray(w.flatten(e)),t=w.parseNumberArray(w.flatten(t)),n=w.parseNumber(n),a=w.parseNumber(a),w.anyIsError(e,t,n,a))return r.value;if(n===a)return 0<=e.indexOf(n)?t[e.indexOf(n)]:0;for(var o=e.sort((function(e,t){return e-t})),i=o.length,s=0,l=0;l<i;l++)o[l]>=n&&o[l]<=a&&(s+=t[e.indexOf(o[l])]);return s},t.QUARTILE={},t.QUARTILE.EXC=function(e,n){if(e=w.parseNumberArray(w.flatten(e)),n=w.parseNumber(n),w.anyIsError(e,n))return r.value;switch(n){case 1:return t.PERCENTILE.EXC(e,.25);case 2:return t.PERCENTILE.EXC(e,.5);case 3:return t.PERCENTILE.EXC(e,.75);default:return r.num}},t.QUARTILE.INC=function(e,n){if(e=w.parseNumberArray(w.flatten(e)),n=w.parseNumber(n),w.anyIsError(e,n))return r.value;switch(n){case 1:return t.PERCENTILE.INC(e,.25);case 2:return t.PERCENTILE.INC(e,.5);case 3:return t.PERCENTILE.INC(e,.75);default:return r.num}},t.RANK={},t.RANK.AVG=function(e,t,n){if(e=w.parseNumber(e),t=w.parseNumberArray(w.flatten(t)),w.anyIsError(e,t))return r.value;t=w.flatten(t),t=t.sort(n?function(e,t){return e-t}:function(e,t){return t-e}),n=t.length;for(var a=0,o=0;o<n;o++)t[o]===e&&a++;return 1<a?(2*t.indexOf(e)+a+1)/2:t.indexOf(e)+1},t.RANK.EQ=function(e,t,n){return e=w.parseNumber(e),t=w.parseNumberArray(w.flatten(t)),w.anyIsError(e,t)?r.value:(t=t.sort(n?function(e,t){return e-t}:function(e,t){return t-e}),t.indexOf(e)+1)},t.RSQ=function(e,n){return e=w.parseNumberArray(w.flatten(e)),n=w.parseNumberArray(w.flatten(n)),w.anyIsError(e,n)?r.value:Math.pow(t.PEARSON(e,n),2)},t.SMALL=function(e,t){return e=w.parseNumberArray(w.flatten(e)),t=w.parseNumber(t),w.anyIsError(e,t)?e:e.sort((function(e,t){return e-t}))[t-1]},t.STANDARDIZE=function(e,t,n){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:(e-t)/n},t.STDEV={},t.STDEV.P=function(){var e=t.VAR.P.apply(this,arguments);return Math.sqrt(e)},t.STDEV.S=function(){var e=t.VAR.S.apply(this,arguments);return Math.sqrt(e)},t.STDEVA=function(){var e=t.VARA.apply(this,arguments);return Math.sqrt(e)},t.STDEVPA=function(){var e=t.VARPA.apply(this,arguments);return Math.sqrt(e)},t.VAR={},t.VAR.P=function(){for(var e=w.numbers(w.flatten(arguments)),n=e.length,r=0,a=t.AVERAGE(e),o=0;o<n;o++)r+=Math.pow(e[o]-a,2);return r/n},t.VAR.S=function(){for(var e=w.numbers(w.flatten(arguments)),n=e.length,r=0,a=t.AVERAGE(e),o=0;o<n;o++)r+=Math.pow(e[o]-a,2);return r/(n-1)},t.VARA=function(){for(var e=w.flatten(arguments),n=e.length,r=0,a=0,o=t.AVERAGEA(e),i=0;i<n;i++){var s=e[i];r="number"===typeof s?r+Math.pow(s-o,2):!0===s?r+Math.pow(1-o,2):r+Math.pow(0-o,2),null!==s&&a++}return r/(a-1)},t.VARPA=function(){for(var e=w.flatten(arguments),n=e.length,r=0,a=0,o=t.AVERAGEA(e),i=0;i<n;i++){var s=e[i];r="number"===typeof s?r+Math.pow(s-o,2):!0===s?r+Math.pow(1-o,2):r+Math.pow(0-o,2),null!==s&&a++}return r/a},t.WEIBULL={},t.WEIBULL.DIST=function(e,t,n,a){return e=w.parseNumber(e),t=w.parseNumber(t),n=w.parseNumber(n),w.anyIsError(e,t,n)?r.value:a?1-Math.exp(-Math.pow(e/n,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/n,t))*t/Math.pow(n,t)},t.Z={},t.Z.TEST=function(e,n,a){if(e=w.parseNumberArray(w.flatten(e)),n=w.parseNumber(n),w.anyIsError(e,n))return r.value;a=a||t.STDEV.S(e);var o=e.length;return 1-t.NORM.S.DIST((t.AVERAGE(e)-n)/(a/Math.sqrt(o)),!0)},t}(),k.utils=function(){return{PROGRESS:function(e,t){return'<div style="width:'+(e||"0")+"%;height:4px;background-color:"+(t||"red")+';margin-top:1px;"></div>'},RATING:function(e){for(var t='<div class="jrating">',n=0;5>n;n++)t=n<e?t+'<div class="jrating-selected"></div>':t+"<div></div>";return t+"</div>"}}}();for(var v=0;v<Object.keys(k).length;v++)for(var d=k[Object.keys(k)[v]],n=Object.keys(d),q=0;q<n.length;q++)if(d[n[q]])if("function"==typeof d[n[q]]||"object"==typeof d[n[q]]){if(window[n[q]]=d[n[q]],window[n[q]].toString=function(){return"#ERROR"},"object"==typeof d[n[q]])for(var y=Object.keys(d[n[q]]),a=0;a<y.length;a++)window[n[q]][y[a]].toString=function(){return"#ERROR"}}else window[n[q]]=function(){return n[q]+"Not implemented"};else window[n[q]]=function(){return n[q]+"Not implemented"};var x=null,A=null,H=null;window.TABLE=function(){return H},window.COLUMN=window.COL=function(){return parseInt(x)+1},window.ROW=function(){return parseInt(A)+1},window.CELL=function(){return B.getColumnNameFromCoords(x,A)},window.VALUE=function(e,t,n){return H.getValueFromCoords(parseInt(e)-1,parseInt(t)-1,n)},window.THISROWCELL=function(e){return H.getValueFromCoords(parseInt(e)-1,parseInt(A))};var B=function(e,t,n,r,a){if(H=a,x=n,A=r,r="",a=Object.keys(t),a.length)for(n=0;n<a.length;n++)r=-1==a[n].indexOf(".")&&-1==a[n].indexOf("!")?r+"var "+a[n]+" = "+t[a[n]]+";\n":r+(a[n]+" = ")+t[a[n]]+";\n";e=e.replace(/\$/g,""),e=e.replace(/!/g,"."),t="",n=0,a=["=","!",">","<"];for(var o=0;o<e.length;o++)'"'==e[o]&&(n=0==n?1:0),1==n?t+=e[o]:(t+=e[o].toUpperCase(),0<o&&"="==e[o]&&-1==a.indexOf(e[o-1])&&-1==a.indexOf(e[o+1])&&(t+="="));if(t=t.replace(/\^/g,"**"),t=t.replace(/<>/g,"!="),t=t.replace(/&/g,"+"),e=t=t.replace(/\$/g,""),(t=e.match(/([A-Z]+[0-9]*\.)?(\$?[A-Z]+\$?[0-9]+):(\$?[A-Z]+\$?[0-9]+)?/g))&&t.length)for(n=0;n<t.length;n++)a=B.getTokensFromRange(t[n]),e=e.replace(t[n],"["+a.join(",")+"]");return new Function(r+"; return "+e)()};return B.getColumnNameFromCoords=function(e,t){var n=parseInt(e),r="";return 701<n?(r+=String.fromCharCode(64+parseInt(n/676)),r+=String.fromCharCode(64+parseInt(n%676/26))):25<n&&(r+=String.fromCharCode(64+parseInt(n/26))),r+=String.fromCharCode(65+n%26),r+(parseInt(t)+1)},B.getCoordsFromColumnName=function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,r=0;r<t[0].length;r++)n+=parseInt(t[0].charCodeAt(r)-64)*Math.pow(26,t[0].length-1-r);return n--,0>n&&(n=0),e=parseInt(/[0-9]+$/.exec(e))||null,0<e&&e--,[n,e]}},B.getRangeFromTokens=function(e){e=e.filter((function(e){return"#REF!"!=e}));for(var t="",n="",r=0;r<e.length;r++)0<=e[r].indexOf(".")?t=".":0<=e[r].indexOf("!")&&(t="!"),t&&(n=e[r].split(t),e[r]=n[1],n=n[0]+t);return e.sort((function(e,t){var n=Helpers.getCoordsFromColumnName(e),r=Helpers.getCoordsFromColumnName(t);return n[1]>r[1]?1:n[1]<r[1]?-1:n[0]>r[0]?1:n[0]<r[0]?-1:0})),e.length?n+(e[0]+":")+e[e.length-1]:"#REF!"},B.getTokensFromRange=function(e){if(0<e.indexOf(".")){var t=e.split(".");e=t[1],t=t[0]+"."}else 0<e.indexOf("!")?(t=e.split("!"),e=t[1],t=t[0]+"!"):t="";e=e.split(":");var n=B.getCoordsFromColumnName(e[0]),r=B.getCoordsFromColumnName(e[1]);if(n[0]<=r[0]){e=n[0];var a=r[0]}else e=r[0],a=n[0];if(null===n[1]&&null==r[1])for(var o=null,i=null,s=Object.keys(vars),l=0;l<s.length;l++){var u=B.getCoordsFromColumnName(s[l]);u[0]===n[0]&&(null===o||u[1]<o)&&(o=u[1]),u[0]===r[0]&&(null===i||u[1]>i)&&(i=u[1])}else n[1]<=r[1]?(o=n[1],i=r[1]):(o=r[1],i=n[1]);for(n=[];o<=i;o++){for(r=[],l=e;l<=a;l++)r.push(t+B.getColumnNameFromCoords(l,o));n.push(r)}return n},B.setFormula=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)"function"==typeof e[t[n]]&&(window[t[n]]=e[t[n]])},B}()}))},{}],2:[function(e,t,n){(function(e,r){"object"===typeof n&&"undefined"!==typeof t?t.exports=r():e.jSuites=r()})(this,(function(){var e=function(t){var n={},r=function(e,t){return!(!e[t.type]||e[t.type]!=t)||!!e.parentNode&&r(e.parentNode,t)},a=function(t){if(0<e.current.length)for(var n=0;n<e.current.length;n++)e.current[n]&&!r(t.target,e.current[n])&&e.current[n].close()};return n.init=function(){document.addEventListener("click",a),n.version="4.9.0"},n.tracking=function(t,n){if(1==n)e.current=e.current.filter((function(e){return null!==e})),setTimeout((function(){e.current.push(t)}),0);else{var r=e.current.indexOf(t);0<=r&&(e.current[r]=null)}},n.path=function(e,t){if(e=e.split("."),e.length){for(var n,r=this;1<e.length;){if(n=e.shift(),!r.hasOwnProperty(n)){if(void 0===t)return;r[n]={}}r=r[n]}return n=e.shift(),void 0!==t?(r[n]=t,!0):r[n]}return!1},n.setDictionary=function(t){n.dictionary=t;for(var r=0;r<e.calendar.weekdays.length;r++)t=e.translate(e.calendar.weekdays[r]),e.calendar.weekdays[r]&&(e.calendar.weekdays[r]=t,e.calendar.weekdaysShort[r]=t.substr(0,3));for(r=0;r<e.calendar.months.length;r++)(t=e.translate(e.calendar.months[r]))&&(e.calendar.months[r]=t,e.calendar.monthsShort[r]=t.substr(0,3))},n.dictionary={},n.translate=function(e){return n.dictionary[e]||e},n.current=[],n}();"undefined"!==typeof document&&e.init(),e.ajax=function(t,n){if(Array.isArray(t)){var r={instance:[],complete:n};if(0<t.length)for(var a=0;a<t.length;a++)t[a].multiple=r,r.instance.push(e.ajax(t[a]));return r}if(t.data||(t.data={}),t.type&&(t.method=t.type),t.method||(t.method="GET"),t.dataType||(t.dataType="json"),t.data){var o=function(e,t){var n=[],r=Object.keys(e);if(r.length)for(var a=0;a<r.length;a++){var i=t?t+"["+r[a]+"]":r[a];if("object"==typeof e[r[a]]){i=o(e[r[a]],i);for(var s=Object.keys(i),l=0;l<s.length;l++)n[s[l]]=i[s[l]]}else n[i]=e[r[a]]}return n};r=[];var i=o(t.data),s=Object.keys(i);for(a=0;a<s.length;a++)r.push(s[a]+"="+encodeURIComponent(i[s[a]]));"GET"==t.method&&0<r.length&&(0>t.url.indexOf("?")&&(t.url+="?"),t.url+=r.join("&"))}var l=new XMLHttpRequest;return l.open(t.method,t.url,!0),l.setRequestHeader("X-Requested-With","XMLHttpRequest"),"POST"==t.method?(l.setRequestHeader("Accept","application/json"),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded")):"json"==t.dataType?l.setRequestHeader("Content-Type","text/json"):"blob"==t.dataType?l.responseType="blob":"html"==t.dataType&&l.setRequestHeader("Content-Type","text/html"),1!=t.cache&&(l.setRequestHeader("pragma","no-cache"),l.setRequestHeader("cache-control","no-cache")),1==t.withCredentials&&(l.withCredentials=!0),"function"==typeof t.beforeSend&&t.beforeSend(l),l.onload=function(){if(200===l.status)if("json"==t.dataType)try{var n=JSON.parse(l.responseText);t.success&&"function"==typeof t.success&&t.success(n)}catch(a){t.error&&"function"==typeof t.error&&t.error(a,n)}else n="blob"==t.dataType?l.response:l.responseText,t.success&&"function"==typeof t.success&&t.success(n);else t.error&&"function"==typeof t.error&&t.error(l.responseText,l.status);if(e.ajax.queue&&0<e.ajax.queue.length&&e.ajax.send(e.ajax.queue.shift()),e.ajax.requests&&e.ajax.requests.length){var r=e.ajax.requests.indexOf(l);e.ajax.requests.splice(r,1),e.ajax.requests.length||t.complete&&"function"==typeof t.complete&&t.complete(n),t.group&&e.ajax.oncomplete&&"function"==typeof e.ajax.oncomplete[t.group]&&!e.ajax.pending(t.group)&&(e.ajax.oncomplete[t.group](),e.ajax.oncomplete[t.group]=null),t.multiple&&t.multiple.instance&&(r=t.multiple.instance.indexOf(l),t.multiple.instance.splice(r,1),t.multiple.instance.length||t.multiple.complete&&"function"==typeof t.multiple.complete&&t.multiple.complete(n))}},l.options=t,l.data=r,1==t.queue&&0<e.ajax.requests.length?e.ajax.queue.push(l):e.ajax.send(l),l},e.ajax.send=function(t){t.data?t.send(t.data.join("&")):t.send(),e.ajax.requests.push(t)},e.ajax.exists=function(e,t){var n=new XMLHttpRequest;n.open("HEAD",e,!1),n.send(),n.status&&t(n.status)},e.ajax.pending=function(t){var n=0,r=e.ajax.requests;if(r&&r.length)for(var a=0;a<r.length;a++)t&&t!=r[a].options.group||n++;return n},e.ajax.oncomplete={},e.ajax.requests=[],e.ajax.queue=[],e.alert=function(t){800>e.getWindowWidth()&&e.dialog?e.dialog.open({title:"Alert",message:t}):alert(t)},e.animation={},e.animation.slideLeft=function(e,t,n){1==t?(e.classList.add("slide-left-in"),setTimeout((function(){e.classList.remove("slide-left-in"),"function"==typeof n&&n()}),400)):(e.classList.add("slide-left-out"),setTimeout((function(){e.classList.remove("slide-left-out"),"function"==typeof n&&n()}),400))},e.animation.slideRight=function(e,t,n){1==t?(e.classList.add("slide-right-in"),setTimeout((function(){e.classList.remove("slide-right-in"),"function"==typeof n&&n()}),400)):(e.classList.add("slide-right-out"),setTimeout((function(){e.classList.remove("slide-right-out"),"function"==typeof n&&n()}),400))},e.animation.slideTop=function(e,t,n){1==t?(e.classList.add("slide-top-in"),setTimeout((function(){e.classList.remove("slide-top-in"),"function"==typeof n&&n()}),400)):(e.classList.add("slide-top-out"),setTimeout((function(){e.classList.remove("slide-top-out"),"function"==typeof n&&n()}),400))},e.animation.slideBottom=function(e,t,n){1==t?(e.classList.add("slide-bottom-in"),setTimeout((function(){e.classList.remove("slide-bottom-in"),"function"==typeof n&&n()}),400)):(e.classList.add("slide-bottom-out"),setTimeout((function(){e.classList.remove("slide-bottom-out"),"function"==typeof n&&n()}),100))},e.animation.fadeIn=function(e,t){e.style.display="",e.classList.add("fade-in"),setTimeout((function(){e.classList.remove("fade-in"),"function"==typeof t&&t()}),2e3)},e.animation.fadeOut=function(e,t){e.classList.add("fade-out"),setTimeout((function(){e.style.display="none",e.classList.remove("fade-out"),"function"==typeof t&&t()}),1e3)},e.calendar=function(t,n){if(t.calendar)return t.calendar.setOptions(n,!0);var r={type:"calendar",options:{},date:null,setOptions:function(n,a){for(var o={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:e.calendar.monthsShort,monthsFull:e.calendar.months,weekdays:e.calendar.weekdays,weekdays_short:e.calendar.weekdays,textDone:e.translate("Done"),textReset:e.translate("Reset"),textUpdate:e.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null},i=0;i<o.weekdays_short.length;i++)o.weekdays_short[i]=o.weekdays_short[i].substr(0,1);for(var s in o)n&&n.hasOwnProperty(s)?r.options[s]=n[s]:"undefined"!=typeof r.options[s]&&!0!==a||(r.options[s]=o[s]);return l.style.display=0==r.options.resetButton?"none":"",r.options.readonly?t.setAttribute("readonly","readonly"):t.removeAttribute("readonly"),r.options.placeholder?t.setAttribute("placeholder",r.options.placeholder):t.removeAttribute("placeholder"),e.isNumeric(r.options.value)&&0<r.options.value&&(r.options.value=e.calendar.numToDate(r.options.value),r.options.dataType="numeric"),l.innerHTML=r.options.textReset,u.innerHTML=r.options.textDone,y.innerHTML=r.options.textUpdate,t.setAttribute("data-mask",r.options.format.toLowerCase()),(o=!r.options.value&&r.options.today?e.calendar.now():r.options.value)&&(r.options.value=null,r.setValue(o)),r},open:function(n){if(!s.classList.contains("jcalendar-focus")&&!s.classList.contains("jcalendar-inline")){if(e.calendar.current=r,e.tracking(r,!0),r.getDays(),"year-month-picker"==r.options.type&&r.getMonths(),r.options.time&&(b.value=r.date[3],C.value=r.date[4]),s.classList.add("jcalendar-focus"),800>e.getWindowWidth()||r.options.fullscreen)s.classList.add("jcalendar-fullsize"),e.animation.slideBottom(d,1);else{s.classList.remove("jcalendar-fullsize"),n=t.getBoundingClientRect();var a=d.getBoundingClientRect();if(r.options.position)c.style.position="fixed",c.style.top=window.innerHeight<n.bottom+a.height?n.top-(a.height+2)+"px":n.top+n.height+2+"px",c.style.left=n.left+"px";else{if(window.innerHeight<n.bottom+a.height){var o=-1*(n.height+a.height+2);0>o+n.top&&(o=-1*(n.top+n.height)),c.style.top=o+"px"}else c.style.top="2px";window.innerWidth<n.left+a.width?(o=window.innerWidth-(n.left+a.width+20),c.style.left=o+"px"):c.style.left="0px"}}"function"==typeof r.options.onopen&&r.options.onopen(t)}},close:function(n,a){if(s.classList.contains("jcalendar-focus")){if(!1!==a){var o=s.querySelector(".jcalendar-selected");o="string"==typeof a?a:!o||o.classList.contains("jcalendar-disabled")?r.options.value:r.getValue(),r.setValue(o)}n||"function"!=typeof r.options.onclose||r.options.onclose(t),s.classList.remove("jcalendar-focus"),e.tracking(r,!1),e.calendar.current=null}return r.options.value},prev:function(){"years"==r.options.mode?(r.date[0]-=12,r.getYears()):"months"==r.options.mode?(r.date[0]=parseInt(r.date[0])-1,r.getMonths()):(2>r.date[1]?(--r.date[0],r.date[1]=12):--r.date[1],r.getDays())},next:function(){"years"==r.options.mode?(r.date[0]=parseInt(r.date[0])+12,r.getYears()):"months"==r.options.mode?(r.date[0]=parseInt(r.date[0])+1,r.getMonths()):(11<r.date[1]?(r.date[0]=parseInt(r.date[0])+1,r.date[1]=1):r.date[1]=parseInt(r.date[1])+1,r.getDays())},setToday:function(){var e=(new Date).toISOString().substr(0,10);return r.setValue(e),e},setValue:function(e){e||(e=""+e);var n=e,a=r.options.value;if(a!=n){if(n){r.setLabel(n,r.options);var o=n.split(" ");o[1]||(o[1]="00:00:00");var i=o[1].split(":");o=o[0].split("-"),e=parseInt(o[0]);var s=parseInt(o[1]);o=parseInt(o[2]);var l=parseInt(i[0]);i=parseInt(i[1]),r.date=[e,s,o,l,i,0],e=r.setLabel(n,r.options)}else r.date=null,e="";r.options.value=n,"function"==typeof r.options.onchange&&r.options.onchange(t,n,a),t.value!=e&&(t.value=e,"function"==typeof t.onchange)&&t.onchange({type:"change",target:t,value:t.value})}r.getDays()},getValue:function(){return r.date?r.options.time?e.two(r.date[0])+"-"+e.two(r.date[1])+"-"+e.two(r.date[2])+" "+e.two(r.date[3])+":"+e.two(r.date[4])+":"+e.two(0):e.two(r.date[0])+"-"+e.two(r.date[1])+"-"+e.two(r.date[2])+" "+e.two(0)+":"+e.two(0)+":"+e.two(0):""},update:function(e,t){if(!e.classList.contains("jcalendar-disabled")){var n=s.querySelector(".jcalendar-selected");n&&n.classList.remove("jcalendar-selected"),e.classList.add("jcalendar-selected"),e.classList.contains("jcalendar-set-month")?r.date[1]=t:r.date[2]=e.innerText,r.options.time?(r.date[3]=b.value,r.date[4]=C.value):r.close()}i()},reset:function(){r.setValue(""),r.date=null,r.close(!1,!1)},getDays:function(){r.options.mode="days";var t=new Date,n=r.date&&e.isNumeric(r.date[0])?r.date[0]:parseInt(t.getFullYear()),a=r.date&&e.isNumeric(r.date[1])?r.date[1]:parseInt(t.getMonth())+1,o=r.date&&e.isNumeric(r.date[2])?r.date[2]:parseInt(t.getDate()),s=r.date&&e.isNumeric(r.date[3])?r.date[3]:parseInt(t.getHours()),l=r.date&&e.isNumeric(r.date[4])?r.date[4]:parseInt(t.getMinutes());r.date=[n,a,o,s,l,0],p.innerHTML=n,f.innerHTML=r.options.months[a-1],s=t.getMonth()==a-1&&t.getFullYear()==n,l=t.getDate(),t=new Date(n,a,0,0,0);var u=t.getDate();t=new Date(n,a-1,0,0,0),t=t.getDay()+1;var c=r.options.startingDay||0;t-=c,m.innerHTML="";var d=document.createElement("tr");d.setAttribute("align","center"),m.appendChild(d);for(var h=0;7>h;h++){var g=document.createElement("td");g.classList.add("jcalendar-weekday"),g.innerHTML=r.options.weekdays_short[c],d.appendChild(g),c++,6<c&&(c=0)}for(var w=c=0,y=0;6>y;y++){d=document.createElement("tr"),d.setAttribute("align","center");var b=!0;for(h=0;7>h;h++){if(g=document.createElement("td"),g.classList.add("jcalendar-set-day"),c>=t&&c<t+u){if(w++,g.innerHTML=w,w==o&&g.classList.add("jcalendar-selected"),s&&l==w&&(g.style.fontWeight="bold"),b=e.calendar.now(new Date(n,a-1,w),!0),r.options.validRange){var C=!r.options.validRange[1]||b<=r.options.validRange[1];(!r.options.validRange[0]||b>=r.options.validRange[0])&&C||g.classList.add("jcalendar-disabled")}b=!1}d.appendChild(g),c++}0==b&&m.appendChild(d)}v.style.display=r.options.time?"":"none",i()},getMonths:function(){r.options.mode="months";var t=r.options.months,n=new Date,a=parseInt(n.getFullYear());n=parseInt(n.getMonth())+1;var o=r.date&&e.isNumeric(r.date[0])?r.date[0]:a,s=r.date&&e.isNumeric(r.date[1])?r.date[1]:n;p.innerHTML=r.date[0],f.innerHTML=t[s-1];var l=document.createElement("table");l.setAttribute("width","100%");for(var u=null,c=0;12>c;c++){c%4||(u=document.createElement("tr"),u.setAttribute("align","center"),l.appendChild(u));var d=document.createElement("td");if(d.classList.add("jcalendar-set-month"),d.setAttribute("data-value",c+1),d.innerText=t[c],r.options.validRange){var h=o+"-"+e.two(c+1),g=!r.options.validRange[0]||h>=r.options.validRange[0].substr(0,7);h=!r.options.validRange[1]||h<=r.options.validRange[1].substr(0,7),g&&h||d.classList.add("jcalendar-disabled")}c+1==s&&d.classList.add("jcalendar-selected"),a==o&&c+1==n&&(d.style.fontWeight="bold"),u.appendChild(d)}m.innerHTML='<tr><td colspan="7"></td></tr>',m.children[0].children[0].appendChild(l),i()},getYears:function(){r.options.mode="years";var t=new Date,n=t.getFullYear();t=r.date&&e.isNumeric(r.date[0])?r.date[0]:parseInt(t.getFullYear());for(var a=[],o=0;25>o;o++)a[o]=parseInt(r.date[0])+(o-12);var s=document.createElement("table");for(s.setAttribute("width","100%"),o=0;25>o;o++){if(!(o%5)){var l=document.createElement("tr");l.setAttribute("align","center"),s.appendChild(l)}var u=document.createElement("td");u.classList.add("jcalendar-set-year"),u.innerText=a[o],t==a[o]&&u.classList.add("jcalendar-selected"),n==a[o]&&(u.style.fontWeight="bold"),l.appendChild(u)}m.innerHTML='<tr><td colspan="7"></td></tr>',m.firstChild.firstChild.appendChild(s),i()},setLabel:function(t,n){return e.calendar.getDateString(t,n)},fromFormatted:function(t,n){return e.calendar.extractDateFromString(t,n)}},a=function(t){if(e.findElement(t.target,"jcalendar-container")){var n=t.target.className;"jcalendar-prev"==n?r.prev():"jcalendar-next"==n?r.next():"jcalendar-month"==n?r.getMonths():"jcalendar-year"==n?r.getYears():"jcalendar-set-year"==n?(r.date[0]=t.target.innerText,"year-month-picker"==r.options.type?r.getMonths():r.getDays()):t.target.classList.contains("jcalendar-set-month")?(n=parseInt(t.target.getAttribute("data-value")),"year-month-picker"==r.options.type?r.update(t.target,n):(r.date[1]=n,r.getDays())):"jcalendar-confirm"==n||"jcalendar-update"==n||"jcalendar-close"==n?r.close():"jcalendar-backdrop"==n?r.close(!1,!1):"jcalendar-reset"==n?r.reset():t.target.classList.contains("jcalendar-set-day")&&t.target.innerText&&r.update(t.target)}else r.close()},o=function(t){t.target.value&&3<t.target.value.length&&(t=e.calendar.extractDateFromString(t.target.value,r.options.format))&&r.setValue(t)},i=function(){var e=s.querySelector(".jcalendar-selected");e&&e.classList.contains("jcalendar-disabled")?(y.setAttribute("disabled","disabled"),b.setAttribute("disabled","disabled"),C.setAttribute("disabled","disabled")):(y.removeAttribute("disabled"),b.removeAttribute("disabled"),C.removeAttribute("disabled")),"function"==typeof r.options.onupdate&&r.options.onupdate(t,r.getValue())},s=null,l=null,u=null,c=null,d=null,p=null,f=null,h=null,m=null,g=null,v=null,w=null,y=null,b=null,C=null;return function(){"INPUT"==t.tagName&&t.value&&(n.value=t.value),l=document.createElement("div"),l.className="jcalendar-reset",u=document.createElement("div"),u.className="jcalendar-confirm",g=document.createElement("div"),g.className="jcalendar-controls",g.style.borderBottom="1px solid #ddd",g.appendChild(l),g.appendChild(u),c=document.createElement("div"),c.className="jcalendar-container",d=document.createElement("div"),d.className="jcalendar-content",c.appendChild(d),"DIV"==t.tagName?(s=t,s.classList.add("jcalendar-inline")):(d.appendChild(g),s=document.createElement("div"),s.className="jcalendar"),s.classList.add("jcalendar-container"),s.appendChild(c);var i=document.createElement("div");i.className="jcalendar-table",d.appendChild(i);var E=document.createElement("td");E.setAttribute("colspan","2"),E.className="jcalendar-prev",p=document.createElement("span"),p.className="jcalendar-year",f=document.createElement("span"),f.className="jcalendar-month";var A=document.createElement("td");A.className="jcalendar-header",A.setAttribute("colspan","3"),A.appendChild(f),A.appendChild(p);var x=document.createElement("td");x.setAttribute("colspan","2"),x.className="jcalendar-next";var N=document.createElement("thead"),L=document.createElement("tr");for(L.appendChild(E),L.appendChild(A),L.appendChild(x),N.appendChild(L),h=document.createElement("table"),m=document.createElement("tbody"),h.setAttribute("cellpadding","0"),h.setAttribute("cellspacing","0"),h.appendChild(N),h.appendChild(m),i.appendChild(h),b=document.createElement("select"),b.className="jcalendar-select",b.onchange=function(){r.date[3]=this.value,"function"==typeof r.options.onupdate&&r.options.onupdate(t,r.getValue())},i=0;24>i;i++)E=document.createElement("option"),E.value=i,E.innerHTML=e.two(i),b.appendChild(E);for(C=document.createElement("select"),C.className="jcalendar-select",C.onchange=function(){r.date[4]=this.value,"function"==typeof r.options.onupdate&&r.options.onupdate(t,r.getValue())},i=0;60>i;i++)E=document.createElement("option"),E.value=i,E.innerHTML=e.two(i),C.appendChild(E);i=document.createElement("div"),i.className="jcalendar-controls",v=document.createElement("div"),v.className="jcalendar-time",v.style.maxWidth="140px",v.appendChild(b),v.appendChild(C),y=document.createElement("button"),y.setAttribute("type","button"),y.className="jcalendar-update",w=document.createElement("div"),w.style.flexGrow="10",w.appendChild(y),i.appendChild(v),"INPUT"==t.tagName&&i.appendChild(w),d.appendChild(i),i=document.createElement("div"),i.className="jcalendar-backdrop",s.appendChild(i),t.addEventListener("keyup",o),s.addEventListener("swipeleft",(function(t){e.animation.slideLeft(h,0,(function(){r.next(),e.animation.slideRight(h,1)})),t.preventDefault(),t.stopPropagation()})),s.addEventListener("swiperight",(function(t){e.animation.slideRight(h,0,(function(){r.prev(),e.animation.slideLeft(h,1)})),t.preventDefault(),t.stopPropagation()})),t.onmouseup=function(){r.open()},!0==="ontouchend"in document.documentElement?s.addEventListener("touchend",a):s.addEventListener("mouseup",a),e.calendar.hasEvents||(e.calendar.hasEvents=!0,document.addEventListener("keydown",e.calendar.keydown)),r.setOptions(n),"INPUT"==t.tagName?(t.parentNode.insertBefore(s,t.nextSibling),t.setAttribute("autocomplete","off"),t.classList.add("jcalendar-input"),t.value=r.setLabel(r.getValue(),r.options)):(r.getDays(),r.options.time&&(b.value=r.date[3],C.value=r.date[4])),1==r.options.opened&&r.open(),t.change=r.setValue,t.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},t.calendar=s.calendar=r}(),r},e.calendar.keydown=function(t){var n;(n=e.calendar.current)&&(13==t.which?n.close(!1,!0):27==t.which&&n.close(!1,!1))},e.calendar.prettify=function(e,t){t||(t={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"});var n=parseInt((new Date-new Date(e))/1e3/60);return String.prototype.format=function(e){return this.replace("{0}",e)},0==n?t.justNow:90>n?t.xMinutesAgo.format(n):1440>n?t.xHoursAgo.format(Math.round(n/60)):20160>n?t.xDaysAgo.format(Math.round(n/1440)):43200>n?t.xWeeksAgo.format(Math.round(n/10080)):1036800>n?t.xMonthsAgo.format(Math.round(n/43200)):t.xYearsAgo.format(Math.round(n/525600))},e.calendar.prettifyAll=function(){for(var t=document.querySelectorAll(".prettydate"),n=0;n<t.length;n++)t[n].getAttribute("data-date")?t[n].innerHTML=e.calendar.prettify(t[n].getAttribute("data-date")):(t[n].setAttribute("data-date",t[n].innerHTML),t[n].innerHTML=e.calendar.prettify(t[n].innerHTML))},e.calendar.now=function(t,n){if(Array.isArray(t))var r=t[0],a=t[1],o=t[2],i=t[3],s=t[4],l=t[5];else t||(t=new Date),r=t.getFullYear(),a=t.getMonth()+1,o=t.getDate(),i=t.getHours(),s=t.getMinutes(),l=t.getSeconds();return 1==n?e.two(r)+"-"+e.two(a)+"-"+e.two(o):e.two(r)+"-"+e.two(a)+"-"+e.two(o)+" "+e.two(i)+":"+e.two(s)+":"+e.two(l)},e.calendar.toArray=function(e){var t=e.split(-1!==e.indexOf("T")?"T":" "),n=t[1];t=t[0].split("-"),e=parseInt(t[0]);var r=parseInt(t[1]);if(t=parseInt(t[2]),n){n=n.split(":");var a=parseInt(n[0]);n=parseInt(n[1])}else n=a=0;return[e,r,t,a,n,0]},e.calendar.extractDateFromString=function(t,n){if(0<t&&Number(t)==t){var r=new Date(Math.round(864e5*(t-25569)));return r.getFullYear()+"-"+e.two(r.getMonth())+"-"+e.two(r.getDate())+" 00:00:00"}var a=""+t,o=n.replace(/[0-9]/g,""),i=1,s=o.search("YYYY");s=a.substr(s,4),parseInt(s)!=s&&(i=0);var l=o.search("MM");l=a.substr(l,2),(parseInt(l)!=l||12<l)&&(i=0),r=o.search("DD"),r=a.substr(r,2),(parseInt(r)!=r||31<r)&&(i=0);var u=o.search("HH");0<=u?(u=a.substr(u,2),(!parseInt(u)||23<u)&&(u="00")):u="00";var c=o.search("MI");0<=c?(c=a.substr(c,2),(!parseInt(c)||59<c)&&(c="00")):c="00";var d=o.search("SS");return 0<=d?(d=a.substr(d,2),(!parseInt(d)||59<d)&&(d="00")):d="00",1==i&&t.length==o.length?s+"-"+l+"-"+r+" "+u+":"+c+":"+d:""},e.calendar.dateToNum=function(e,t){e=new Date(e),t||(t="1899-12-30 "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()),t=new Date(t);var n=e.getTime()-t.getTime();return Math.round(n/864e5)},e.calendar.numToDate=function(t){return t=new Date(Math.round(864e5*(t-25569))),t.getFullYear()+"-"+e.two(t.getMonth()+1)+"-"+e.two(t.getDate())+" 00:00:00"},e.calendar.getDateString=function(t,n){n||(n={});var r,a=n&&"object"==typeof n?n.format:n;if(a||(a="YYYY-MM-DD"),"number"==typeof t&&0<=a.indexOf("[h]")){var o=parseFloat(24*Number(t));if(0<=a.indexOf("mm")){var i=(""+o).split(".");i[1]?(o=60*parseFloat("0."+i[1]),o=parseFloat(o.toFixed(2))):o=0,o=parseInt(i[0])+":"+e.two(o)}return o}for(t instanceof Date?t=e.calendar.now(t):t&&e.isNumeric(t)&&(t=e.calendar.numToDate(t)),a=a.match(RegExp("DAY|WD|DDDD|DDD|DD|D|Q|HH24|HH12|HH|H|AM/PM|MI|SS|MS|YYYY|YYY|YY|Y|MONTH|MON|MMMMM|MMMM|MMM|MM|M|.","gi")),o=0;o<a.length;o++)"MM"==a[o].toUpperCase()&&(a[o-1]&&0<=a[o-1].toUpperCase().indexOf("H")||a[o-2]&&0<=a[o-2].toUpperCase().indexOf("H")||a[o+1]&&0<=a[o+1].toUpperCase().indexOf("S")||a[o+2]&&0<=a[o+2].toUpperCase().indexOf("S"))&&(a[o]="mi");if(t){o=""+t,i=-1!==o.indexOf("T")?"T":" ",o=o.split(i);var s=r=i=0;if(o[1]&&(i=o[1].split(":"),r=i[1]?i[1]:0,s=i[2]?i[2]:0,i=i[0]?i[0]:0),o=o[0].split("-"),o[0]&&o[1]&&o[2]&&0<o[0]&&0<o[1]&&13>o[1]&&0<o[2]&&32>o[2]){for(i=[o[0],o[1],o[2],i,r,s],r=[],s=new Date(i[0],i[1]-1,i[2],i[3],i[4],i[5]),o=0;o<a.length;o++){var l=o,u=a[l],c=u.toUpperCase(),d=null;"YYYY"===c?d=i[0]:"YYY"===c?d=i[0].substring(1,4):"YY"===c?d=i[0].substring(2,4):"Y"===c?d=i[0].substring(3,4):"MON"===u?d=e.calendar.months[s.getMonth()].substr(0,3).toUpperCase():"mon"===u?d=e.calendar.months[s.getMonth()].substr(0,3).toLowerCase():"MONTH"===u?d=e.calendar.months[s.getMonth()].toUpperCase():"month"===u?d=e.calendar.months[s.getMonth()].toLowerCase():"MMMMM"===c?d=e.calendar.months[s.getMonth()].substr(0,1):"MMMM"===c||"Month"===u?d=e.calendar.months[s.getMonth()]:"MMM"===c||"Mon"==u?d=e.calendar.months[s.getMonth()].substr(0,3):"MM"===c?d=e.two(i[1]):"M"===c?d=s.getMonth()+1:"DAY"===u?d=e.calendar.weekdays[s.getDay()].toUpperCase():"day"===u?d=e.calendar.weekdays[s.getDay()].toLowerCase():"DDDD"===c||"Day"==u?d=e.calendar.weekdays[s.getDay()]:"DDD"===c?d=e.calendar.weekdays[s.getDay()].substr(0,3):"DD"===c?d=e.two(i[2]):"D"===c?d=i[2]:"Q"===c?d=Math.floor((s.getMonth()+3)/3):"HH24"===c||"HH"===c?d=e.two(i[3]):"HH12"===c?d=12<i[3]?e.two(i[3]-12):e.two(i[3]):"H"===c?d=i[3]:"MI"===c?d=e.two(i[4]):"SS"===c?d=e.two(i[5]):"MS"===c?d=s.getMilliseconds():"AM/PM"===c?d=12<=i[3]?"PM":"AM":"WD"===c&&(d=e.calendar.weekdays[s.getDay()]),r[l]=null===d?a[l]:d}t=r.join("")}else t=""}return t},e.calendar.weekdays="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),e.calendar.months="January February March April May June July August September October November December".split(" "),e.calendar.weekdaysShort="Sun Mon Tue Wed Thu Fri Sat".split(" "),e.calendar.monthsShort="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),e.color=function(t,n){if(t.color)return t.color.setOptions(n,!0);var r={type:"color",options:{}},a=null,o=null,i=null,s=null,l=null,u=null,c=null;r.setOptions=function(n,a){var o={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};for(var i in n||(n={}),n&&!n.palette&&(n.palette=e.palette()),o)n&&n.hasOwnProperty(i)?r.options[i]=n[i]:"undefined"!=typeof r.options[i]&&!0!==a||(r.options[i]=o[i]);return s&&(s.innerHTML=r.options.resetLabel),l&&(l.innerHTML=r.options.doneLabel),r.options.palette&&c&&c.updateContent(0,h()),"string"===typeof r.options.value&&(t.value=r.options.value),r.options.placeholder?t.setAttribute("placeholder",r.options.placeholder):t.getAttribute("placeholder")&&t.removeAttribute("placeholder"),r},r.open=function(){if(!a.classList.contains("jcolor-focus")){e.tracking(r,!0),a.classList.add("jcolor-focus");var n=i.getBoundingClientRect();if(800>e.getWindowWidth()||1==r.options.fullscreen)i.style.top="",i.classList.add("jcolor-fullscreen"),e.animation.slideBottom(i,1),o.style.display="block";else{i.classList.contains("jcolor-fullscreen")&&(i.classList.remove("jcolor-fullscreen"),o.style.display="");var s=t.getBoundingClientRect();r.options.position?(i.style.position="fixed",i.style.top=window.innerHeight<s.bottom+n.height?s.top-(n.height+2)+"px":s.top+s.height+2+"px",i.style.left=s.left+"px"):i.style.top=window.innerHeight<s.bottom+n.height?-1*(n.height+s.height+2)+"px":"2px"}if("function"==typeof r.options.onopen&&r.options.onopen(t),c.setBorder(c.getActive()),r.options.value){var l=f(r.options.value);b.forEach((function(e,t){e.value=l[t],e.dispatchEvent(new Event("input"))}))}}},r.close=function(n){return a.classList.contains("jcolor-focus")&&(a.classList.remove("jcolor-focus"),o.style.display="",n||"function"!=typeof r.options.onclose||r.options.onclose(t),e.tracking(r,!1)),r.options.value},r.setValue=function(e){if(e||(e=""),e!=r.options.value){y=r.options.value=e;var n=a.querySelector(".jcolor-selected");n&&n.classList.remove("jcolor-selected"),r.values[e]&&r.values[e].classList.add("jcolor-selected"),"function"==typeof r.options.onchange&&r.options.onchange(t,e),t.value!=r.options.value&&(t.value=r.options.value,"function"==typeof t.onchange)&&t.onchange({type:"change",target:t,value:t.value}),1==r.options.closeOnChange&&r.close()}},r.getValue=function(){return r.options.value};var d=!1,p=function(e){return e=e.toString(16),1===e.length?"0"+e:e},f=function(e){return[parseInt("0x"+e.substr(1,2)),parseInt("0x"+e.substr(3,2)),parseInt("0x"+e.substr(5,2))]},h=function(){var e=document.createElement("div");e.className="jcolor-grid",r.values=[];var t=document.createElement("table");t.setAttribute("cellpadding","7"),t.setAttribute("cellspacing","0");for(var n=0;n<r.options.palette.length;n++){for(var a=document.createElement("tr"),o=0;o<r.options.palette[n].length;o++){var i=document.createElement("td"),s=r.options.palette[n][o];7>s.length&&"#"!==s.substr(0,1)&&(s="#"+s),i.style.backgroundColor=s,i.setAttribute("data-value",s),i.innerHTML="",a.appendChild(i),r.options.value==s&&i.classList.add("jcolor-selected"),r.values[s]=i}t.appendChild(a)}return e.appendChild(t),e.addEventListener("mousedown",(function(e){"TD"==e.target.tagName&&(e=e.target.getAttribute("data-value"))&&r.setValue(e)})),e},m=document.createElement("canvas");m.width=200,m.height=160;var g=m.getContext("2d"),v=function(){var e=u.firstChild.getBoundingClientRect();m.width=e.width-14,e=g.createLinearGradient(0,0,m.width,0),e.addColorStop(0,"rgb(255,0,0)"),e.addColorStop(.15,"rgb(255,0,255)"),e.addColorStop(.33,"rgb(0,0,255)"),e.addColorStop(.49,"rgb(0,255,255)"),e.addColorStop(.67,"rgb(0,255,0)"),e.addColorStop(.84,"rgb(255,255,0)"),e.addColorStop(1,"rgb(255,0,0)"),g.fillStyle=e,g.fillRect(0,0,m.width,m.height),e=g.createLinearGradient(0,0,0,m.height),e.addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(.5,"rgba(255,255,255,0)"),e.addColorStop(.5,"rgba(0,0,0,0)"),e.addColorStop(1,"rgba(0,0,0,1)"),g.fillStyle=e,g.fillRect(0,0,m.width,m.height)},w=function(){var e=document.createElement("div");e.className="jcolor-hsl";var t=document.createElement("div");t.className="jcolor-point";var n=document.createElement("div");n.appendChild(m),n.appendChild(t),e.appendChild(n);var r=function(n,r,a){1===n&&(n=e.getBoundingClientRect(),r-=n.left,a-=n.top,0>r&&(r=0),0>a&&(a=0),r>n.width&&(r=n.width),a>n.height&&(a=n.height),t.style.left=r+"px",t.style.top=a+"px",a=g.getImageData(r,a,1,1).data,n=a[1],r=a[2],y="#"+p(a[0])+p(n)+p(r))};return e.addEventListener("mousedown",(function(e){r(e.buttons,e.clientX,e.clientY)})),e.addEventListener("mousemove",(function(e){r(e.buttons,e.clientX,e.clientY)})),e.addEventListener("touchmove",(function(e){r(1,e.changedTouches[0].clientX,e.changedTouches[0].clientY)})),e},y="",b=[],C=function(){var e=document.createElement("div");e.className="jcolor-sliders";var t=document.createElement("div"),n=function(e){var n=document.createElement("div");n.className="jcolor-sliders-input-container";var r=document.createElement("label");r.innerText=e,e=document.createElement("div"),e.className="jcolor-sliders-input-subcontainer";var a=document.createElement("input");a.type="range",a.min=0,a.max=255,a.value=0,n.appendChild(r),e.appendChild(a);var o=document.createElement("div");return o.innerText=a.value,a.addEventListener("input",(function(){o.innerText=a.value})),e.appendChild(o),n.appendChild(e),t.appendChild(n),a};b=[n("Red"),n("Green"),n("Blue")],e.appendChild(t),n=document.createElement("div"),n.className="jcolor-sliders-final-color";var r=document.createElement("div");return r.style.visibility="hidden",r.innerText="a",n.appendChild(r),b.forEach((function(e){e.addEventListener("input",(function(){var e=parseInt(b[0].value),t=parseInt(b[1].value),n=parseInt(b[2].value);if(e="#"+p(e)+p(t)+p(n),r.innerText=e,r.style.color=e,r.style.removeProperty("visibility"),y=e,""!==y)for(e=0;e<b.length;e++)t=f(y),t[e]=0,n="linear-gradient(90deg, rgb(",n+=t.join(", "),n+="), rgb(",t[e]=255,n+=t.join(", "),n+="))",b[e].style.backgroundImage=n}))})),e.appendChild(n),e};return function(){r.setOptions(n),"INPUT"==t.tagName&&(t.classList.add("jcolor-input"),t.readOnly=!0),a=document.createElement("div"),a.className="jcolor",o=document.createElement("div"),o.className="jcolor-backdrop",a.appendChild(o),i=document.createElement("div"),i.className="jcolor-content";var p=document.createElement("div");p.className="jcolor-controls",i.appendChild(p),s=document.createElement("div"),s.className="jcolor-reset",s.innerHTML=r.options.resetLabel,s.onclick=function(e){r.setValue(""),r.close()},p.appendChild(s),l=document.createElement("div"),l.className="jcolor-close",l.innerHTML=r.options.doneLabel,l.onclick=function(e){0<c.getActive()&&r.setValue(y),r.close()},p.appendChild(l),u=document.createElement("div"),i.appendChild(u),c=e.tabs(u,{animation:!0,data:[{title:"Grid",contentElement:h()},{title:"Spectrum",contentElement:w()},{title:"Sliders",contentElement:C()}],onchange:function(e,t,n){if(1===n)v();else if(e=""!==y?y:r.getValue(),2===n&&e){var a=f(e);b.forEach((function(e,t){e.value=a[t],e.dispatchEvent(new Event("input"))}))}},palette:"modern"}),a.appendChild(i),"INPUT"==t.tagName?t.parentNode.insertBefore(a,t.nextSibling):t.appendChild(a),t.addEventListener("mouseup",(function(e){r.open()})),o.addEventListener("mousedown",(function(e){d=!0})),o.addEventListener("mouseup",(function(e){d&&(r.close(),d=!1)})),window.addEventListener("resize",(function(){a.classList.contains("jcolor-focus")&&1==c.getActive()&&v()})),1==r.options.opened&&r.open(),t.change=r.setValue,t.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},t.color=r,a.color=r}(),r},e.contextmenu=function(t,n){function r(e){if(!e.type||"line"!=e.type&&"divisor"!=e.type){o=document.createElement("div");var t=document.createElement("a");if(t.innerHTML=e.title,e.tooltip&&o.setAttribute("title",e.tooltip),e.icon&&o.setAttribute("data-icon",e.icon),e.id&&(o.id=e.id),e.disabled?o.className="jcontextmenu-disabled":e.onclick&&(o.method=e.onclick,o.addEventListener("mousedown",(function(e){e.preventDefault()})),o.addEventListener("mouseup",(function(){this.method(this)}))),o.appendChild(t),e.submenu){t=document.createElement("span"),t.innerHTML="&#9658;",o.appendChild(t),o.classList.add("jcontexthassubmenu"),t=document.createElement("div"),t.classList.add("jcontextmenu"),t.setAttribute("tabindex","900"),e=e.submenu;for(var n=0;n<e.length;n++){var a=r(e[n]);t.appendChild(a)}o.appendChild(t)}else e.shortcut&&(t=document.createElement("span"),t.innerHTML=e.shortcut,o.appendChild(t))}else var o=document.createElement("hr");return o}var a,o={options:{}},i={items:null,onclick:null};for(a in i)n&&n.hasOwnProperty(a)?o.options[a]=n[a]:o.options[a]=i[a];return t.classList.add("jcontextmenu"),t.setAttribute("tabindex","900"),o.open=function(e,n){if(n&&(o.options.items=n,o.create(n)),o.options.items&&0<o.options.items.length||t.children.length){if(e.target)var r=e.clientX,a=e.clientY;else r=e.x,a=e.y;t.classList.add("jcontextmenu-focus"),t.focus();var i=t.getBoundingClientRect();window.innerHeight<a+i.height?(a-=i.height,0>a&&(a=0),t.style.top=a+"px"):t.style.top=a+"px",t.style.left=window.innerWidth<r+i.width?0<r-i.width?r-i.width+"px":"10px":r+"px"}},o.close=function(){t.classList.contains("jcontextmenu-focus")&&t.classList.remove("jcontextmenu-focus")},o.create=function(e){t.innerHTML="";for(var n=0;n<e.length;n++){var a=r(e[n]);t.appendChild(a)}},"function"==typeof o.options.onclick&&t.addEventListener("click",(function(e){o.options.onclick(o,e)})),o.options.items&&o.create(o.options.items),t.addEventListener("blur",(function(e){o.close()})),e.contextmenu.hasEvents||(window.addEventListener("mousewheel",(function(){o.close()})),document.addEventListener("contextmenu",(function(t){var n=e.contextmenu.getElement(t.target);n&&((n=document.querySelector("#"+n))?(n.contextmenu.open(t),t.preventDefault()):console.error("JSUITES: Contextmenu id not found"))})),e.contextmenu.hasEvents=!0),t.contextmenu=o},e.contextmenu.getElement=function(e){function t(e){e.parentNode&&e.getAttribute("aria-contextmenu-id")?n=e.getAttribute("aria-contextmenu-id"):e.parentNode&&t(e.parentNode)}var n=0;return t(e),n},e.dropdown=function(t,n){if(t.dropdown)return t.dropdown.setOptions(n,!0);var r={type:"dropdown",options:{}},a=function(e,n){e&&e.length&&(!1!==r.options.sortResults&&("function"==typeof r.options.sortResults?e.sort(r.options.sortResults):e.sort(o)),r.setData(e),"function"==typeof r.options.onload)&&r.options.onload(t,r,e,n),n&&s(n),void 0!==n&&null!==n||(r.options.value=""),t.value=r.options.value,1==r.options.opened&&r.open()},o=function(e,t){if("string"==typeof e)var n=e;else e.text?n=e.text:e.name&&(n=e.name);if("string"==typeof t)var r=t;else t.text?r=t.text:t.name&&(r=t.name);return"string"==typeof n||"string"==typeof r?("string"!=typeof n&&(n=""+n),"string"!=typeof r&&(r=""+r),n.localeCompare(r)):n-r},i=function(){r.value={};for(var e=0;e<r.items.length;e++)1==r.items[e].selected&&(r.items[e].element&&r.items[e].element.classList.remove("jdropdown-selected"),r.items[e].selected=null);r.options.value=""},s=function(e){if(i(),null!==e)if(e){Array.isArray(e)||(e=(""+e).split(";"));for(var t=0;t<e.length;t++)r.value[e[t]]=""}else"undefined"!==typeof r.value[""]&&(r.value[""]="");for(t=0;t<r.items.length;t++)"undefined"!==typeof r.value[l(t)]&&(r.items[t].element&&r.items[t].element.classList.add("jdropdown-selected"),r.items[t].selected=!0,r.value[l(t)]=u(t));r.options.value=Object.keys(r.value).join(";"),r.header.value=r.getText()},l=function(e,t){var n=r.options.format?"id":"value";return r.items[e]?void 0!==t?r.items[e].data[n]=t:r.items[e].data[n]:""},u=function(e,t){var n=r.options.format?"name":"text";return r.items[e]?void 0!==t?r.items[e].data[n]=t:r.items[e].data[n]:""},c=function(){for(var e=[],t=Object.keys(r.value),n=0;n<t.length;n++)e.push(r.value[t[n]]);return e};r.setOptions=function(n,o){n||(n={});var i,s={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,sortResults:!1,autofocus:!1};for(i in s)n&&n.hasOwnProperty(i)?r.options[i]=n[i]:"undefined"!=typeof r.options[i]&&!0!==o||(r.options[i]=s[i]);return 1!=r.options.remoteSearch&&"searchbar"!==r.options.type||(r.options.autocomplete=!0),1==r.options.newOptions?r.header.classList.add("jdropdown-add"):r.header.classList.remove("jdropdown-add"),1==r.options.autocomplete?r.header.removeAttribute("readonly"):r.header.setAttribute("readonly","readonly"),r.options.placeholder?r.header.setAttribute("placeholder",r.options.placeholder):r.header.removeAttribute("placeholder"),t.classList.remove("jdropdown-searchbar"),t.classList.remove("jdropdown-picker"),t.classList.remove("jdropdown-list"),"searchbar"==r.options.type?t.classList.add("jdropdown-searchbar"):"list"==r.options.type?t.classList.add("jdropdown-list"):"picker"==r.options.type?t.classList.add("jdropdown-picker"):800>e.getWindowWidth()?r.options.autocomplete?(t.classList.add("jdropdown-searchbar"),r.options.type="searchbar"):(t.classList.add("jdropdown-picker"),r.options.type="picker"):(r.options.width?(t.style.width=r.options.width,t.style.minWidth=r.options.width):(t.style.removeProperty("width"),t.style.removeProperty("min-width")),t.classList.add("jdropdown-default"),r.options.type="default"),"searchbar"==r.options.type?d.appendChild(h):p.insertBefore(h,p.firstChild),r.options.url&&!n.data?e.ajax({url:r.options.url,method:"GET",dataType:"json",success:function(e){e&&a(e,r.options.value)}}):a(r.options.data,r.options.value),r};var d=null,p=null,f=null,h=null,m=null,g=null,v=null;r.getUrl=function(){return r.options.url},r.setUrl=function(t,n){r.options.url=t,e.ajax({url:r.options.url,method:"GET",dataType:"json",success:function(e){r.setData(e),"function"==typeof n&&n(r)}})},r.setId=function(e,t){var n=r.options.format?"id":"value";"object"==typeof e?e[n]=t:r.items[e].data[n]=t},r.add=function(t,n){if(!t){var a=1==r.options.autocomplete?r.header.value:"";if(t=prompt(e.translate("Add A New Option"),a),!t)return!1}if(n||(n=e.guid()),a=r.options.format?{id:n,name:t}:{value:n,text:t},"function"==typeof r.options.onbeforeinsert){var o=r.options.onbeforeinsert(r,a);if(!1===o)return!1;o&&(a=o)}return r.options.data.push(a),o=r.createItem(a),f.appendChild(o.element),"function"==typeof r.options.oninsert&&r.options.oninsert(r,a,o),"none"==f.style.display&&(f.style.display=""),r.results&&r.results.push(o),a},r.createItem=function(e,t,n){r.options.format?(e.id||void 0===e.value||(e.id=e.value),e.name||void 0===e.text||(e.name=e.text)):(e.value||void 0===e.id||(e.value=e.id),e.text||void 0===e.name||(e.text=e.name)),n={},n.element=document.createElement("div"),n.element.className="jdropdown-item",n.element.indexValue=r.items.length,n.data=e,t&&(n.group=t),e.id&&n.element.setAttribute("id",e.id),1==e.disabled&&n.element.setAttribute("data-disabled",!0),e.tooltip&&n.element.setAttribute("title",e.tooltip),e.image?(t=document.createElement("img"),t.className="jdropdown-image",t.src=e.image,e.title||t.classList.add("jdropdown-image-small"),n.element.appendChild(t)):e.icon?(t=document.createElement("span"),t.className="jdropdown-icon material-icons",t.innerText=e.icon,e.title||t.classList.add("jdropdown-icon-small"),e.color&&(t.style.color=e.color),n.element.appendChild(t)):e.color&&(t=document.createElement("div"),t.className="jdropdown-color",t.style.backgroundColor=e.color,n.element.appendChild(t));var a=r.options.format?e.name:e.text;return t=document.createElement("div"),t.className="jdropdown-description",t.innerHTML=a||"&nbsp;",e.title&&(a=document.createElement("div"),a.className="jdropdown-title",a.innerText=e.title,t.appendChild(a)),r.value[r.options.format?e.id:e.value]&&(n.element.classList.add("jdropdown-selected"),n.selected=!0),r.items.push(n),n.element.appendChild(t),n},r.appendData=function(e){if(e.length){for(var t=[],n=[],a=0;a<e.length;a++)e[a].group?(n[e[a].group]||(n[e[a].group]=[]),n[e[a].group].push(a)):t.push(a);var o=0,i=Object.keys(n);if(0<i.length)for(a=0;a<i.length;a++){var s=document.createElement("div");s.className="jdropdown-group";var l=document.createElement("div");l.className="jdropdown-group-name",l.innerHTML=i[a];var u=document.createElement("i");u.className="jdropdown-group-arrow jdropdown-group-arrow-down",l.appendChild(u),u=document.createElement("div"),u.className="jdropdown-group-items";for(var c=0;c<n[i[a]].length;c++){var d=r.createItem(e[n[i[a]][c]],s,i[a]);(0==r.options.lazyLoading||200>o)&&(u.appendChild(d.element),o++)}s.appendChild(l),s.appendChild(u),r.groups.push(s),0<u.children.length&&f.appendChild(s)}if(t.length)for(a=0;a<t.length;a++)d=r.createItem(e[t[a]]),(0==r.options.lazyLoading||200>o)&&(f.appendChild(d.element),o++)}},r.setData=function(e){if(e.length){for(var t=0;t<e.length;t++)"object"!=typeof e[t]&&(e[t]=r.options.format?{id:e[t],name:e[t]}:{value:e[t],text:e[t]});i(),f.innerHTML="",r.header.value="",r.items=[],r.appendData(e),r.options.data=e}},r.getData=function(){return r.options.data},r.getPosition=function(e){for(var t=0;t<r.items.length;t++)if(l(t)==e)return t;return!1},r.getText=function(e){var t=c();return e?t:t.join("; ")},r.getValue=function(e){var t=Object.keys(r.value);return e?t:t.join(";")};var w=function(e){"function"==typeof r.options.onchange&&r.options.onchange(t,r,e,r.options.value),t.value!=r.options.value&&(t.value=r.options.value,"function"==typeof t.onchange)&&t.onchange({type:"change",target:t,value:t.value})};return r.setValue=function(e){var t=r.getValue();Array.isArray(e)&&(e=e.join(";")),t!==e&&(s(e),w(t))},r.resetSelected=function(){r.setValue(null)},r.selectIndex=function(e,t){if(e=parseInt(e),r.items&&r.items[e]&&(!0===t||!0!==r.items[e].data.disabled))if(r.setCursor(e,!1),r.options.multiple){var n=r.options.value;r.items[e].selected?(r.items[e].element.classList.remove("jdropdown-selected"),r.items[e].selected=!1,delete r.value[l(e)]):(r.items[e].element.classList.add("jdropdown-selected"),r.items[e].selected=!0,r.value[l(e)]=u(e)),r.options.value=Object.keys(r.value).join(";"),0==r.options.autocomplete&&(r.header.value=c().join("; ")),w(n)}else r.items[e].selected?r.setValue(null):r.setValue(l(e)),r.close()},r.selectItem=function(e){r.selectIndex(e.indexValue)},r.find=function(t){if(r.search==t.trim())return!1;if(r.search=t,r.setCursor(),r.groups.length)for(var n=0;n<r.groups.length;n++)r.groups[n].lastChild.innerHTML="";if(f.innerHTML="",1==r.options.remoteSearch)r.results=null,n=r.options.url+(0<r.options.url.indexOf("?")?"&":"?")+"q="+t,e.ajax({url:n,method:"GET",dataType:"json",success:function(e){r.items=[];var t=Object.keys(r.value);if(t.length)for(var n=0;n<t.length;n++){e:{for(var a=t[n],o=0;o<e.length;o++)if(r.options.format){if(e[o].id==a){a=!0;break e}}else if(e[o].value==a){a=!0;break e}a=!1}a||(r.options.format?e.unshift({id:t[n],name:r.value[t[n]]}):e.unshift({value:t[n],text:r.value[t[n]]}))}r.appendData(e),f.style.display=e.length?"":"none"}});else{t=new RegExp(t,"gi");var a=[];for(n=0;n<r.items.length;n++){var o=u(n),i=r.items[n].data.title||"",s=r.items[n].data.group||"",l=r.items[n].data.synonym||"";l&&(l=l.join(" ")),(null==t||1==r.items[n].selected||o.match(t)||i.match(t)||s.match(t)||l.match(t))&&a.push(r.items[n])}if(a.length)for(f.style.display="",r.results=a,t=a.length||0,1==r.options.lazyLoading&&200<t&&(t=200),n=0;n<t;n++)r.results[n].group?(r.results[n].group.parentNode||f.appendChild(r.results[n].group),r.results[n].group.lastChild.appendChild(r.results[n].element)):f.appendChild(r.results[n].element);else f.style.display="none",r.results=null}1==r.options.autofocus&&r.first()},r.open=function(){if(!t.classList.contains("jdropdown-focus")){e.dropdown.current=r,e.tracking(r,!0),t.classList.add("jdropdown-focus"),800>e.getWindowWidth()&&(null==r.options.type||"picker"==r.options.type)&&e.animation.slideBottom(p,1),1==r.options.autocomplete&&(r.header.value=r.search,r.header.focus());var n=Object.keys(r.value);if(n[0]&&(n=r.getPosition(n[0]),!1!==n&&r.setCursor(n)),!r.options.type||"default"==r.options.type){n=t.getBoundingClientRect();var a=p.getBoundingClientRect();r.options.position?(p.style.position="fixed",window.innerHeight<n.bottom+a.height?(p.style.top="",p.style.bottom=window.innerHeight-n.top+1+"px"):(p.style.top=n.bottom+"px",p.style.bottom=""),p.style.left=n.left+"px"):window.innerHeight<n.bottom+a.height?(p.style.top="",p.style.bottom=n.height+1+"px"):(p.style.top="",p.style.bottom=""),p.style.minWidth=n.width+"px",r.options.maxWidth&&(p.style.maxWidth=r.options.maxWidth),f.style.display=r.items.length||1!=r.options.autocomplete?"":"none"}}"function"==typeof r.options.onopen&&r.options.onopen(t)},r.close=function(n){return t.classList.contains("jdropdown-focus")&&(r.header.value=r.getText(),r.setCursor(),n||"function"!=typeof r.options.onclose||r.options.onclose(t),r.header.blur&&r.header.blur(),t.classList.remove("jdropdown-focus"),e.tracking(r,!1),e.dropdown.current=null),r.getValue()},r.setCursor=function(e,t){if(null!=r.currentIndex&&r.items&&r.items[r.currentIndex]&&r.items[r.currentIndex].element.classList.remove("jdropdown-cursor"),void 0==e)r.currentIndex=null;else if(e=parseInt(e),r.items[e].element.parentNode&&(r.items[e].element.classList.add("jdropdown-cursor"),r.currentIndex=e,!1!==t&&r.items[r.currentIndex].element)){var n=r.items[r.currentIndex].element;f.scrollTop=n.offsetTop-n.scrollTop+n.clientTop-95}},r.resetCursor=r.setCursor,r.updateCursor=r.setCursor,r.reset=function(){r.setCursor(),r.setValue(null)},r.first=function(){!0===r.options.lazyLoading&&r.loadFirst();var e=f.querySelectorAll(".jdropdown-item");e.length&&r.setCursor(e[0].indexValue)},r.last=function(){!0===r.options.lazyLoading&&r.loadLast();var e=f.querySelectorAll(".jdropdown-item");e.length&&r.setCursor(e[e.length-1].indexValue)},r.next=function(e){var t=null;if(e){if(1==e.length){var n=r.currentIndex||-1;e=e.toLowerCase();var a,o,i=f.querySelectorAll(".jdropdown-item");if(i.length){for(var s=0;s<i.length;s++)if(i[s].indexValue>n&&(a=r.items[i[s].indexValue])&&(o=a.element.innerText[0])&&(o=o.toLowerCase(),e==o)){t=i[s].indexValue;break}r.setCursor(t)}}}else void 0==r.currentIndex||null==r.currentIndex?r.first():(e=r.items[r.currentIndex].element,(n=e.nextElementSibling)?(n.classList.contains("jdropdown-group")&&(n=n.lastChild.firstChild),t=n.indexValue):e.parentNode.classList.contains("jdropdown-group-items")&&((n=e.parentNode.parentNode.nextElementSibling)&&(n.classList.contains("jdropdown-group")?n=n.lastChild.firstChild:n.classList.contains("jdropdown-item")?t=n.indexValue:n=null),n&&(t=n.indexValue)),null!==t&&r.setCursor(t))},r.prev=function(){var e=null;if(null===r.currentIndex)r.first();else{var t=r.items[r.currentIndex].element,n=t.previousElementSibling;n?(n.classList.contains("jdropdown-group")&&(n=n.lastChild.lastChild),e=n.indexValue):t.parentNode.classList.contains("jdropdown-group-items")&&((n=t.parentNode.parentNode.previousElementSibling)&&(n.classList.contains("jdropdown-group")?n=n.lastChild.lastChild:n.classList.contains("jdropdown-item")?e=n.indexValue:n=null),n&&(e=n.indexValue))}null!==e&&r.setCursor(e)},r.loadFirst=function(){var e=r.results?r.results:r.items,t=e.length||0;1==r.options.lazyLoading&&200<t&&(t=200),f.innerHTML="";for(var n=0;n<t;n++)e[n].group?(e[n].group.parentNode||f.appendChild(e[n].group),e[n].group.lastChild.appendChild(e[n].element)):f.appendChild(e[n].element);f.scrollTop=0},r.loadLast=function(){var e=r.results?r.results:r.items,t=e.length;if(200<t){for(f.innerHTML="",t-=200;t<e.length;t++)e[t].group?(e[t].group.parentNode||f.appendChild(e[t].group),e[t].group.lastChild.appendChild(e[t].element)):f.appendChild(e[t].element);f.scrollTop=f.scrollHeight}},r.loadUp=function(){var e=!1,t=r.results?r.results:r.items,n=f.querySelectorAll(".jdropdown-item")[0].indexValue;if(n=r.items[n],n=t.indexOf(n)-1,0<n){for(e=0;0<n&&t[n]&&200>e;)t[n].group?(t[n].group.parentNode||f.insertBefore(t[n].group,f.firstChild),t[n].group.lastChild.insertBefore(t[n].element,t[n].group.lastChild.firstChild)):f.insertBefore(t[n].element,f.firstChild),n--,e++;e=!0}return e},r.loadDown=function(){var e=!1,t=r.results?r.results:r.items,n=f.querySelectorAll(".jdropdown-item");if(n=n[n.length-1].indexValue,n=r.items[n],n=t.indexOf(n)+1,n<t.length){for(e=0;n<t.length&&t[n]&&200>e;)t[n].group?(t[n].group.parentNode||f.appendChild(t[n].group),t[n].group.lastChild.appendChild(t[n].element)):f.appendChild(t[n].element),n++,e++;e=!0}return e},function(){if(n||(n={}),"SELECT"==t.tagName){var a=e.dropdown.extractFromDom(t,n);t=a.el,n=a.options}!n.placeholder&&t.getAttribute("placeholder")&&(n.placeholder=t.getAttribute("placeholder")),r.value={},r.items=[],r.groups=[],r.search="",r.results=null,t.classList.add("jdropdown"),d=document.createElement("div"),d.className="jdropdown-container-header",r.header=document.createElement("input"),r.header.className="jdropdown-header",r.header.type="text",r.header.setAttribute("autocomplete","off"),r.header.onfocus=function(){"function"==typeof r.options.onfocus&&r.options.onfocus(t)},r.header.onblur=function(){"function"==typeof r.options.onblur&&r.options.onblur(t)},r.header.onkeyup=function(e){1!=r.options.autocomplete||v?r.options.autocomplete||r.next(e.key):(r.search!=r.header.value.trim()&&(v=setTimeout((function(){r.find(r.header.value.trim()),v=null}),400)),t.classList.contains("jdropdown-focus")||r.open())},e.dropdown.hasEvents||(e.dropdown.hasEvents=!0,document.addEventListener("keydown",e.dropdown.keydown)),p=document.createElement("div"),p.className="jdropdown-container",f=document.createElement("div"),f.className="jdropdown-content",h=document.createElement("div"),h.className="jdropdown-close",h.innerHTML="Done",m=document.createElement("div"),m.className="jdropdown-reset",m.innerHTML="x",m.onclick=function(){r.reset(),r.close()},g=document.createElement("div"),g.className="jdropdown-backdrop",d.appendChild(r.header),p.appendChild(f),t.appendChild(d),t.appendChild(p),t.appendChild(g),r.setOptions(n),!0==="ontouchsend"in document.documentElement?t.addEventListener("touchsend",e.dropdown.mouseup):t.addEventListener("mouseup",e.dropdown.mouseup),1==r.options.lazyLoading&&e.lazyLoading(f,{loadUp:r.loadUp,loadDown:r.loadDown}),t.change=r.setValue,t.val=function(e){if(void 0===e)return r.getValue(!!r.options.multiple);r.setValue(e)},t.dropdown=r}(),r},e.dropdown.keydown=function(t){var n;if(n=e.dropdown.current)if(13==t.which||9==t.which)n.header.value&&null==n.currentIndex&&n.options.newOptions?n.add():(null==n.currentIndex&&1==n.options.autocomplete&&""!=n.header.value&&n.find(n.header.value),n.selectIndex(n.currentIndex));else if(38==t.which)null==n.currentIndex?n.first():0<n.currentIndex&&n.prev(),t.preventDefault();else if(40==t.which)null==n.currentIndex?n.first():n.currentIndex+1<n.items.length&&n.next(),t.preventDefault();else if(36==t.which)n.first(),t.target.classList.contains("jdropdown-header")||t.preventDefault();else if(35==t.which)n.last(),t.target.classList.contains("jdropdown-header")||t.preventDefault();else if(27==t.which)n.close();else if(33==t.which){if(null==n.currentIndex)n.first();else if(0<n.currentIndex)for(var r=0;7>r;r++)n.prev();t.preventDefault()}else if(34==t.which){if(null==n.currentIndex)n.first();else if(n.currentIndex+1<n.items.length)for(r=0;7>r;r++)n.next();t.preventDefault()}},e.dropdown.mouseup=function(t){var n=e.findElement(t.target,"jdropdown");if(n){var r=n.dropdown;if(t.target.classList.contains("jdropdown-header"))n.classList.contains("jdropdown-focus")&&n.classList.contains("jdropdown-default")?(n=n.getBoundingClientRect(),30>n.width-((t.changedTouches&&t.changedTouches[0]?t.changedTouches[0].clientX:t.clientX)-n.left)?t.target.classList.contains("jdropdown-add")?r.add():r.close():0==r.options.autocomplete&&r.close()):r.open();else if(t.target.classList.contains("jdropdown-group-name")){if(n=t.target.nextSibling.children,"none"!=t.target.nextSibling.style.display)for(t=0;t<n.length;t++)"none"!=n[t].style.display&&r.selectItem(n[t])}else t.target.classList.contains("jdropdown-group-arrow")?t.target.classList.contains("jdropdown-group-arrow-down")?(t.target.classList.remove("jdropdown-group-arrow-down"),t.target.classList.add("jdropdown-group-arrow-up"),t.target.parentNode.nextSibling.style.display="none"):(t.target.classList.remove("jdropdown-group-arrow-up"),t.target.classList.add("jdropdown-group-arrow-down"),t.target.parentNode.nextSibling.style.display=""):t.target.classList.contains("jdropdown-item")?r.selectItem(t.target):t.target.classList.contains("jdropdown-image")||t.target.classList.contains("jdropdown-description")?r.selectItem(t.target.parentNode):t.target.classList.contains("jdropdown-title")?r.selectItem(t.target.parentNode.parentNode):(t.target.classList.contains("jdropdown-close")||t.target.classList.contains("jdropdown-backdrop"))&&r.close()}},e.dropdown.extractFromDom=function(e,t){if(t||(t={}),!e.getAttribute("multiple")||t&&void 0!=t.multiple||(t.multiple=!0),!e.getAttribute("placeholder")||t&&void 0!=t.placeholder||(t.placeholder=e.getAttribute("placeholder")),!e.getAttribute("data-autocomplete")||t&&void 0!=t.autocomplete||(t.autocomplete=!0),t&&void 0!=t.width||(t.width=e.offsetWidth),!e.value||t&&void 0!=t.value||(t.value=e.value),!t||void 0==t.data){t.data=[];for(var n=0;n<e.children.length;n++)if("OPTGROUP"==e.children[n].tagName)for(var r=0;r<e.children[n].children.length;r++)t.data.push({value:e.children[n].children[r].value,text:e.children[n].children[r].innerHTML,group:e.children[n].getAttribute("label")});else t.data.push({value:e.children[n].value,text:e.children[n].innerHTML})}return t&&void 0!=t.onchange||(t.onchange=function(n,r,a,o){1==t.multiple?obj.items[r].classList.contains("jdropdown-selected")?e.options[r].setAttribute("selected","selected"):e.options[r].removeAttribute("selected"):e.value=o}),n=document.createElement("div"),e.parentNode.insertBefore(n,e),e.style.display="none",{el:n,options:t}},e.editor=function(t,n){var r,a={options:{}},o={value:null,snippet:null,toolbar:null,remoteParser:null,placeholder:null,parseURL:!1,filterPaste:!0,dropZone:!1,dropAsSnippet:!1,acceptImages:!1,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,border:!0,padding:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null};for(r in o)n&&n.hasOwnProperty(r)?a.options[r]=n[r]:a.options[r]=o[r];var i=null,s=null,l=[];t.innerHTML="",a.el=t,"function"==typeof a.options.onclick&&(t.onclick=function(e){a.options.onclick(t,a,e)}),t.classList.add("jeditor-container"),1==a.options.padding&&t.classList.add("jeditor-padding"),0==a.options.border&&(t.style.border="0px");var u=document.createElement("div");u.className="jsnippet",u.setAttribute("contenteditable",!1);var c=document.createElement("div");c.className="jeditor-toolbar";var d=document.createElement("div");d.setAttribute("contenteditable",!0),d.setAttribute("spellcheck",!1),d.className="jeditor",a.options.placeholder&&d.setAttribute("data-placeholder",a.options.placeholder),(a.options.maxHeight||a.options.height)&&(d.style.overflowY="auto",a.options.maxHeight&&(d.style.maxHeight=a.options.maxHeight),a.options.height&&(d.style.height=a.options.height)),(o=a.options.value?a.options.value:t.innerHTML?t.innerHTML:"")||(o="");var p=function(e){"function"==typeof a.options.onchange&&a.options.onchange(t,a,e),a.options.value=a.getData(),t.value!=a.options.value&&(t.value=a.options.value,"function"==typeof t.onchange)&&t.onchange({type:"change",target:t,value:t.value})},f=function(e){if(window.getSelection){var t=window.getSelection();if(t.rangeCount){var n=t.getRangeAt(0);n.deleteContents(),n.insertNode(e),n.setStartAfter(e),n.setEndAfter(e),t.removeAllRanges(),t.addRange(n)}}},h=function(){var e;if(e=u.children[0]){e.classList.contains("jslider-grid")||e.classList.add("jslider-grid");var t=e.children.length;e.setAttribute("data-number",4<t?4:t),4<t?e.setAttribute("data-total",t-4):e.removeAttribute("data-total")}},m=function(e){u.innerHTML="";for(var t=["image","title","description","host","url"],n=0;n<t.length;n++){var r=document.createElement("div");if(r.className="jsnippet-"+t[n],r.setAttribute("data-k",t[n]),u.appendChild(r),e[t[n]])if("image"==t[n]){Array.isArray(e.image)||(e.image=[e.image]);for(var a=0;a<e.image.length;a++){var o=document.createElement("img");o.src=e.image[a],r.appendChild(o)}}else r.innerHTML=e[t[n]]}d.appendChild(document.createElement("br")),d.appendChild(u)},g=function(){clearTimeout(i),i=setTimeout((function(){if(!d.querySelector(".jsnippet")){var t=d.innerHTML.replace(/\n/g," "),n=document.createElement("div");n.innerHTML=t,(t=e.editor.detectUrl(n.innerText))&&("jpg"==t[0].substr(-3)||"png"==t[0].substr(-3)||"gif"==t[0].substr(-3)?a.addImage(t[0],!0):(n=e.editor.youtubeParser(t[0]),a.parseWebsite(t[0],n)))}}),1e3)};a.parseContent=function(){g()},a.parseWebsite=function(t,n){if(a.options.remoteParser){n&&(t="https://www.youtube.com/watch?v="+n);var r={title:"",description:"",image:"",host:t.split("/")[2],url:t};e.ajax({url:a.options.remoteParser+encodeURI(t.trim()),method:"GET",dataType:"json",success:function(e){e.title&&(r.title=e.title),e.description&&(r.description=e.description),e.host&&(r.host=e.host),e.url&&(r.url=e.url),m(r),e.image?a.addImage(e.image,!0):e["og:image"]&&a.addImage(e["og:image"],!0)}})}else console.log("The remoteParser is not defined")},a.setData=function(t){d.innerHTML=t,a.options.focus&&e.editor.setCursor(d,!0),l=[]},a.getFiles=function(){for(var e=d.querySelectorAll(".jfile"),t=[],n=0;n<e.length;n++)l[e[n].src]&&t.push(l[e[n].src]);return t},a.getText=function(){return d.innerText},a.getData=function(e){if(e){if(e={content:""},u.innerHTML){e.snippet={};for(var t=0;t<u.children.length;t++){var n=u.children[t].getAttribute("data-k");if(n)if("image"==n)for(e.snippet.image||(e.snippet.image=[]),n=0;n<u.children[t].children.length;n++)e.snippet.image.push(u.children[t].children[n].getAttribute("src"));else e.snippet[n]=u.children[t].innerHTML}}if(n=Object.keys(l),n.length)for(e.files=[],t=0;t<n.length;t++)e.files.push(l[n[t]]);t=d.innerHTML,t=t.replace(/<br>/g,"\n"),t=t.replace(/<\/div>/g,"</div>\n"),t=t.replace(/<(?:.|\n)*?>/gm,""),e.content=t.trim()}else e=d.innerHTML;return e},a.reset=function(){d.innerHTML="",u.innerHTML="",l=[]},a.addPdf=function(e){if("data"!=e.result.substr(0,4))console.error("Invalid source");else{var t=document.createElement("canvas");t.width=60,t.height=60;var n=new Image;t.getContext("2d").drawImage(n,0,0,t.width,t.height),t.toBlob((function(t){var n=document.createElement("img");n.src=window.URL.createObjectURL(t),n.title=e.name,n.className="jfile pdf",l[n.src]={file:n.src,extension:"pdf",content:e.result},f(n)}))}},a.addImage=function(e,t){if("data"==e.substr(0,4)||a.options.remoteParser){if("data"==e.substr(0,4)){var n=e.split(";");n=n[0].split("/"),n=n[1]}else n=e.substr(e.lastIndexOf(".")+1),e=a.options.remoteParser+e;var r=new Image;r.onload=function(){var e=document.createElement("canvas");e.width=r.width,e.height=r.height,e.getContext("2d").drawImage(r,0,0,e.width,e.height),e.toBlob((function(r){var o=document.createElement("img");o.src=window.URL.createObjectURL(r),o.classList.add("jfile"),o.setAttribute("tabindex","900"),l[o.src]={file:o.src,extension:n,content:e.toDataURL()},a.options.dropAsSnippet||t?(u.innerHTML||m({}),u.children[0].appendChild(o),h(),l[o.src].snippet=!0):f(o),p()}))},r.src=e}else console.error("remoteParser not defined in your initialization")},a.addFile=function(e){for(var t=[],n=0;n<e.length;n++)if(e[n].size>a.options.maxFileSize)alert("The file is too big");else{var r=e[n].type.split("/");(r="image"==r[0]?1:"pdf"==r[1]?2:0)?(t[n]=new FileReader,t[n].index=n,t[n].type=r,t[n].name=e[n].name,t[n].date=e[n].lastModified,t[n].size=e[n].size,t[n].addEventListener("load",(function(e){2==e.target.type?1==a.options.acceptFiles&&a.addPdf(e.target):a.addImage(e.target.result)}),!1),t[n].readAsDataURL(e[n])):alert("The extension is not allowed")}},a.destroy=function(){d.removeEventListener("mouseup",v),d.removeEventListener("mousedown",w),d.removeEventListener("mousemove",y),d.removeEventListener("keyup",b),d.removeEventListener("keydown",C),d.removeEventListener("dragstart",I),d.removeEventListener("dragenter",M),d.removeEventListener("dragover",T),d.removeEventListener("drop",D),d.removeEventListener("paste",L),"function"==typeof a.options.onblur&&d.removeEventListener("blur",j),"function"==typeof a.options.onfocus&&d.removeEventListener("focus",S),t.editor=null,t.classList.remove("jeditor-container"),c.remove(),u.remove(),d.remove()};var v=function(e){s&&s.e&&s.e.classList.remove("resizing"),s=!1},w=function(e){var t=function(t){var n=t.getBoundingClientRect();40>n.width-(e.clientX-n.left)&&40>e.clientY-n.top&&(t.innerHTML="",t.remove())};if("IMG"==e.target.tagName)if(e.target.style.cursor){if(t=e.target.getBoundingClientRect(),s={e:e.target,x:e.clientX,y:e.clientY,w:t.width,h:t.height,d:e.target.style.cursor},e.target.width||(e.target.width=t.width+"px"),e.target.height||(e.target.height=t.height+"px"),t=window.getSelection(),t.rangeCount)for(var n=0;n<t.rangeCount;n++)t.removeRange(t.getRangeAt(n));e.target.classList.add("resizing")}else s=!0;else e.target.classList.contains("jsnippet")?t(e.target):e.target.parentNode.classList.contains("jsnippet")&&t(e.target.parentNode),s=!0},y=function(e){if("IMG"==e.target.tagName&&!e.target.parentNode.classList.contains("jsnippet-image")&&1==a.options.allowImageResize&&e.target.getAttribute("tabindex")){var t=e.target.getBoundingClientRect();e.target.style.cursor=5>e.clientY-t.top?5>t.width-(e.clientX-t.left)?"ne-resize":5>e.clientX-t.left?"nw-resize":"n-resize":5>t.height-(e.clientY-t.top)?5>t.width-(e.clientX-t.left)?"se-resize":5>e.clientX-t.left?"sw-resize":"s-resize":5>t.width-(e.clientX-t.left)?"e-resize":5>e.clientX-t.left?"w-resize":""}if(1==e.which&&s&&s.d){if("e-resize"==s.d||"ne-resize"==s.d||"se-resize"==s.d)if(s.e.width=s.w+(e.clientX-s.x),e.shiftKey){var n=s.h/s.w*(e.clientX-s.x);s.e.height=s.h+n}else n=null;n||"s-resize"!=s.d&&"se-resize"!=s.d&&"sw-resize"!=s.d||e.shiftKey||(s.e.height=s.h+(e.clientY-s.y))}},b=function(e){d.innerHTML||(d.innerHTML="<div><br></div>"),"function"==typeof a.options.onkeyup&&a.options.onkeyup(t,a,e)},C=function(e){1==a.options.parseURL&&g(),"function"==typeof a.options.onkeydown&&a.options.onkeydown(t,a,e),"Delete"==e.key&&"IMG"==e.target.tagName&&e.target.parentNode.classList.contains("jsnippet-image")&&(e.target.remove(),h())},E=[HTMLUnknownElement],A="color font-weight font-size background background-color margin".split(" "),x=function(e){if(e.attributes&&e.attributes.length){var t=null,n=e.getAttribute("style");if(n){t=[],n=n.split(";");for(var r=0;r<n.length;r++){var o=n[r].trim().split(":");if(0<=A.indexOf(o[0].trim())){var i=o.shift();o=o.join(":"),t.push(i+":"+o)}}}if("IMG"==e.tagName)a.options.acceptImages?(e.setAttribute("tabindex","900"),a.addImage(e.src)):e.remove();else for(n=e.attributes.length-1;0<=n;n--)e.removeAttribute(e.attributes[n].name);e.style="",t&&t.length&&e.setAttribute("style",t.join(";"))}if(e.children.length)for(n=0;n<e.children.length;n++)x(e.children[n]);0<=E.indexOf(e.constructor)&&e.remove()},N=function(e){e&&(e=e.replace(RegExp("\x3c!--(.*?)--\x3e","gsi"),""));var t=document.createElement("span");return t.innerHTML=e,x(t),t},L=function(e){if(1==a.options.filterPaste){if(e.clipboardData||e.originalEvent.clipboardData)var t=(e.originalEvent||e).clipboardData.getData("text/html"),n=(e.originalEvent||e).clipboardData.getData("text/plain"),r=(e.originalEvent||e).clipboardData.files;else window.clipboardData&&(t=window.clipboardData.getData("Html"),n=window.clipboardData.getData("Text"),r=window.clipboardData.files);r.length?a.addFile(r):t?(t=N(t),f(t)):(t=n.split("\r\n"),e.target.innerText?(t=t.map((function(e){return"<div>"+e+"</div>"})),document.execCommand("insertHtml",!1,t.join(""))):t.map((function(e){var t=document.createElement("div");t.innerText=e,d.appendChild(t)}))),e.preventDefault()}},I=function(e){s&&s.e&&e.preventDefault()},M=function(e){s||0==a.options.dropZone||(t.classList.add("jeditor-dragging"),e.preventDefault())},T=function(e){s||0==a.options.dropZone||(i&&clearTimeout(i),i=setTimeout((function(){t.classList.remove("jeditor-dragging")}),100),e.preventDefault())},D=function(e){if(!s&&0!=a.options.dropZone){var n=null;document.caretRangeFromPoint?n=document.caretRangeFromPoint(e.clientX,e.clientY):e.rangeParent&&(n=document.createRange(),n.setStart(e.rangeParent,e.rangeOffset));var r=window.getSelection();r.removeAllRanges(),r.addRange(n),r.anchorNode.parentNode.focus(),n=(e.originalEvent||e).dataTransfer.getData("text/html"),r=(e.originalEvent||e).dataTransfer.getData("text/plain");var o=(e.originalEvent||e).dataTransfer.files;if(o.length)a.addFile(o);else if(r&&(r=document.createElement("div"),r.innerHTML=n,n=r.querySelectorAll("img"),n.length))for(r=0;r<n.length;r++)a.addImage(n[r].src);t.classList.remove("jeditor-dragging"),e.preventDefault()}},j=function(e){"function"==typeof a.options.onblur&&a.options.onblur(t,a,e),p(e)},S=function(e){"function"==typeof a.options.onfocus&&a.options.onfocus(t,a,e)};return d.addEventListener("mouseup",v),d.addEventListener("mousedown",w),d.addEventListener("mousemove",y),d.addEventListener("keyup",b),d.addEventListener("keydown",C),d.addEventListener("dragstart",I),d.addEventListener("dragenter",M),d.addEventListener("dragover",T),d.addEventListener("drop",D),d.addEventListener("paste",L),d.addEventListener("focus",S),d.addEventListener("blur",j),"function"==typeof a.options.onload&&a.options.onload(t,a,d),d.innerHTML=o,t.appendChild(d),a.options.snippet&&m(a.options.snippet),null==a.options.toolbar&&(a.options.toolbar=e.editor.getDefaultToolbar()),a.options.toolbar&&(t.appendChild(c),e.toolbar(c,{container:!0,responsive:!0,items:a.options.toolbar})),a.options.focus&&e.editor.setCursor(d,"initial"==a.options.focus),t.change=a.setData,t.val=function(e){if(void 0===e)return e="true"!==t.getAttribute("data-html"),a.getData(e);a.setData(e)},t.editor=a},e.editor.setCursor=function(e,t){e.focus(),document.execCommand("selectAll");var n=window.getSelection(),r=n.getRangeAt(0);if(1==t)var a=r.startContainer,o=0;else a=r.endContainer,o=a.length;r.setStart(a,o),r.setEnd(a,o),n.removeAllRanges(),n.addRange(r)},e.editor.getDomain=function(e){return e.replace("http://","").replace("https://","").replace("www.","").split(/[/?#]/)[0].split(/:/g)[0]},e.editor.detectUrl=function(e){return(e=e.match(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi))&&"www"==e[0].substr(0,3)&&(e[0]="http://"+e[0]),e},e.editor.youtubeParser=function(e){return!(!(e=e.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&\?]*).*/))||11!=e[7].length)&&e[7]},e.editor.getDefaultToolbar=function(){return[{content:"undo",onclick:function(){document.execCommand("undo")}},{content:"redo",onclick:function(){document.execCommand("redo")}},{type:"divisor"},{content:"format_bold",onclick:function(e,t,n){document.execCommand("bold"),document.queryCommandState("bold")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_italic",onclick:function(e,t,n){document.execCommand("italic"),document.queryCommandState("italic")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_underline",onclick:function(e,t,n){document.execCommand("underline"),document.queryCommandState("underline")?n.classList.add("selected"):n.classList.remove("selected")}},{type:"divisor"},{content:"format_list_bulleted",onclick:function(e,t,n){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_list_numbered",onclick:function(e,t,n){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_indent_increase",onclick:function(e,t,n){document.execCommand("indent",!0,null),document.queryCommandState("indent")?n.classList.add("selected"):n.classList.remove("selected")}},{content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}]},e.form=function(t,n){var r,a={options:{}},o={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(t,n){e.alert(n)}};for(r in o)n&&n.hasOwnProperty(r)?a.options[r]=n[r]:a.options[r]=o[r];return a.options.validations||(a.options.validations={}),a.options.submitButton||(a.options.submitButton=t.querySelector("input[type=submit]")),a.options.submitButton&&a.options.url&&(a.options.submitButton.onclick=function(){a.save()}),a.options.validations.email||(a.options.validations.email=e.validations.email),a.options.validations.length||(a.options.validations.length=e.validations.length),a.options.validations.required||(a.options.validations.required=e.validations.required),a.setUrl=function(e){a.options.url=e},a.load=function(){e.ajax({url:a.options.url,method:"GET",dataType:"json",queue:!0,success:function(n){if("function"==typeof a.options.onbeforeload){var r=a.options.onbeforeload(t,n);r&&(n=r)}e.form.setElements(t,n),"function"==typeof a.options.onload&&a.options.onload(t,n)}})},a.save=function(){var n=a.validate();if(n)a.options.onerror(t,n);else{var r=e.form.getElements(t,!0);if("function"==typeof a.options.onbeforesave&&(r=a.options.onbeforesave(t,r),!1===r))return;e.ajax({url:a.options.url,method:"POST",dataType:"json",data:r,success:function(e){"function"==typeof a.options.onsave&&a.options.onsave(t,r,e)}})}},a.remove=function(){if("function"==typeof a.options.onbeforeremove&&!1===a.options.onbeforeremove(t,a))return!1;e.ajax({url:a.options.url,method:"DELETE",dataType:"json",success:function(e){"function"==typeof a.options.onremove&&a.options.onremove(t,a,e),a.reset()}})},a.validateElement=function(n){var r=!1,o=e.form.getValue(n),i=n.getAttribute("data-validation");if("function"!=typeof a.options.validations[i]||a.options.validations[i](o,n)){if(n.classList.contains("error")){for(o=!1,n.classList.remove("error"),n.removeAttribute("title"),n=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<n.length;i++)n[i].getAttribute("data-validation")&&n[i].classList.contains("error")&&(o=!0);a.options.submitButton&&(o?a.options.submitButton.setAttribute("disabled",!0):a.options.submitButton.removeAttribute("disabled"))}}else n.classList.add("error"),a.options.submitButton&&a.options.submitButton.setAttribute("disabled",!0),r=n.getAttribute("data-error")||"There is an error in the form",n.setAttribute("title",r);return r},a.reset=function(){for(var e=t.querySelectorAll("input, select, textarea, div[name]"),n=0;n<e.length;n++)e[n].getAttribute("name")&&("checkbox"==e[n].type||"radio"==e[n].type?e[n].checked=!1:"function"==typeof e[n].val?e[n].val(""):e[n].value="")},a.validate=function(){for(var e=[],n=t.querySelectorAll("input, select, textarea, div[name]"),r=0;r<n.length;r++)if(n[r].getAttribute("data-validation")){var o=a.validateElement(n[r]);o&&e.push(o)}return 0<e.length&&e.join("<br>")},a.getError=function(){return!!a.validation()},a.setHash=function(){return a.getHash(e.form.getElements(t))},a.getHash=function(e){var t,n=0;if(0!==e.length)for(t=0;t<e.length;t++){var r=e.charCodeAt(t);n=(n<<5)-n+r,n|=0}return n},a.isChanged=function(){var e=a.setHash();return a.options.currentHash!=e},a.resetTracker=function(){a.options.currentHash=a.setHash(),a.options.ignore=!1},a.setIgnore=function(e){a.options.ignore=!!e},setTimeout((function(){a.options.currentHash=a.setHash()}),1e3),t.addEventListener("keyup",(function(e){e.target.getAttribute("data-validation")&&a.validateElement(e.target)})),e.form.hasEvents||(window.addEventListener("beforeunload",(function(e){if(a.isChanged()&&0==a.options.ignore){var t=a.options.message?a.options.message:"o/";if(t)return"undefined"==typeof e&&(e=window.event),e&&(e.returnValue=t),t}})),e.form.hasEvents=!0),t.form=a},e.form.getValue=function(e){var t=null;if("checkbox"==e.type)1==e.checked&&(t=e.value||!0);else if("radio"==e.type)1==e.checked&&(t=e.value);else if("select"==e.tagName&&1==e.multiple){t=[],e=e.querySelectorAll("options[selected]");for(var n=0;n<e.length;n++)t.push(e[n].value)}else t="function"==typeof e.val?e.val():e.value||"";return t},e.form.getElements=function(t,n){for(var r,a={},o=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<o.length;i++)(r=o[i].getAttribute("name"))&&(a[r]=e.form.getValue(o[i])||"");return 1==n?a:JSON.stringify(a)},e.form.setElements=function(t,n){for(var r,a,o=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<o.length;i++){var s=o[i].getAttribute("type");(r=o[i].getAttribute("name"))&&(r=r.replace(new RegExp(/\[(.*?)\]/gi),".$1"),a=null,r.match(/\./)?(r=e.path.call(n,r)||"","undefined"!==typeof r&&(a=r)):"undefined"!==typeof n[r]&&(a=n[r]),null!==a&&("checkbox"==s||"radio"==s?o[i].checked=!!a:"function"==typeof o[i].val?o[i].val(a):o[i].value=a))}},e.tracker=e.form,e.focus=function(e){if(e.innerText.length){var t=document.createRange(),n=window.getSelection(),r=e.childNodes[e.childNodes.length-1];t.setStart(r,r.length),t.collapse(!0),n.removeAllRanges(),n.addRange(t),e.scrollLeft=e.scrollWidth}},e.isNumeric=function(e){return!isNaN(e)&&null!==e&&""!==e},e.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},e.getNode=function(){var e=document.getSelection().anchorNode;return e?3==e.nodeType?e.parentNode:e:null},e.hash=function(e){var t,n=0;if(0!==e.length)for(t=0;t<e.length;t++){var r=e.charCodeAt(t);32<r&&(n=(n<<5)-n+r,n|=0)}return n},e.randomColor=function(t){var n=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");6>n.length&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]);var r,a=[];for(r=0;3>r;r++){var o=parseInt(n.substr(2*r,2),16);o=Math.round(Math.min(Math.max(0,o+-.25*o),255)).toString(16),a.push(("00"+o).substr(o.length))}return 1==t?"#"+e.two(a[0].toString(16))+e.two(a[1].toString(16))+e.two(a[2].toString(16)):a},e.getWindowWidth=function(){var e=window,t=document,n=t.documentElement;return t=t.getElementsByTagName("body")[0],e.innerWidth||n.clientWidth||t.clientWidth},e.getWindowHeight=function(){var e=window,t=document,n=t.documentElement;return t=t.getElementsByTagName("body")[0],e.innerHeight||n.clientHeight||t.clientHeight},e.getPosition=function(e){if(e.changedTouches&&e.changedTouches[0]){var t=e.changedTouches[0].pageX;e=e.changedTouches[0].pageY}else t=window.Event?e.pageX:e.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),e=window.Event?e.pageY:e.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[t,e]},e.click=function(e){if(e.click)e.click();else{var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});e.dispatchEvent(t)}},e.findElement=function(e,t){function n(e){e&&!r&&("function"==typeof t?r=t(e):"string"==typeof t&&e.classList&&e.classList.contains(t)&&(r=e)),e.parentNode&&!r&&n(e.parentNode)}var r=!1;return n(e),r},e.two=function(e){return e=""+e,1==e.length&&(e="0"+e),e},e.sha512=function(e){function t(e,t){this.highOrder=e,this.lowOrder=t}function n(e,n){var r=(65535&e.lowOrder)+(65535&n.lowOrder),a=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(r>>>16),o=(65535&a)<<16|65535&r;return r=(65535&e.highOrder)+(65535&n.highOrder)+(a>>>16),a=(e.highOrder>>>16)+(n.highOrder>>>16)+(r>>>16),new t((65535&a)<<16|65535&r,o)}function r(e,n,r,a){var o=(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&r.lowOrder)+(65535&a.lowOrder),i=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(r.lowOrder>>>16)+(a.lowOrder>>>16)+(o>>>16),s=(65535&i)<<16|65535&o;return o=(65535&e.highOrder)+(65535&n.highOrder)+(65535&r.highOrder)+(65535&a.highOrder)+(i>>>16),i=(e.highOrder>>>16)+(n.highOrder>>>16)+(r.highOrder>>>16)+(a.highOrder>>>16)+(o>>>16),new t((65535&i)<<16|65535&o,s)}function a(e,n,r,a,o){var i=(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&r.lowOrder)+(65535&a.lowOrder)+(65535&o.lowOrder),s=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(r.lowOrder>>>16)+(a.lowOrder>>>16)+(o.lowOrder>>>16)+(i>>>16),l=(65535&s)<<16|65535&i;return i=(65535&e.highOrder)+(65535&n.highOrder)+(65535&r.highOrder)+(65535&a.highOrder)+(65535&o.highOrder)+(s>>>16),s=(e.highOrder>>>16)+(n.highOrder>>>16)+(r.highOrder>>>16)+(a.highOrder>>>16)+(o.highOrder>>>16)+(i>>>16),new t((65535&s)<<16|65535&i,l)}function o(e,n){return 32>=n?new t(e.highOrder>>>n|e.lowOrder<<32-n,e.lowOrder>>>n|e.highOrder<<32-n):new t(e.lowOrder>>>n|e.highOrder<<32-n,e.highOrder>>>n|e.lowOrder<<32-n)}function i(e){var n=o(e,28),r=o(e,34);return e=o(e,39),new t(n.highOrder^r.highOrder^e.highOrder,n.lowOrder^r.lowOrder^e.lowOrder)}function s(e){var n=o(e,14),r=o(e,18);return e=o(e,41),new t(n.highOrder^r.highOrder^e.highOrder,n.lowOrder^r.lowOrder^e.lowOrder)}function l(e){var n=o(e,1),r=o(e,8);return e=c(e,7),new t(n.highOrder^r.highOrder^e.highOrder,n.lowOrder^r.lowOrder^e.lowOrder)}function u(e){var n=o(e,19),r=o(e,61);return e=c(e,6),new t(n.highOrder^r.highOrder^e.highOrder,n.lowOrder^r.lowOrder^e.lowOrder)}function c(e,n){return 32>=n?new t(e.highOrder>>>n,e.lowOrder>>>n|e.highOrder<<32-n):new t(0,e.highOrder<<32-n)}var d,p=[new t(1779033703,4089235720),new t(3144134277,2227873595),new t(1013904242,4271175723),new t(2773480762,1595750129),new t(1359893119,2917565137),new t(2600822924,725511199),new t(528734635,4215389547),new t(1541459225,327033209)],f=[new t(1116352408,3609767458),new t(1899447441,602891725),new t(3049323471,3964484399),new t(3921009573,2173295548),new t(961987163,4081628472),new t(1508970993,3053834265),new t(2453635748,2937671579),new t(2870763221,3664609560),new t(3624381080,2734883394),new t(310598401,1164996542),new t(607225278,1323610764),new t(1426881987,3590304994),new t(1925078388,4068182383),new t(2162078206,991336113),new t(2614888103,633803317),new t(3248222580,3479774868),new t(3835390401,2666613458),new t(4022224774,944711139),new t(264347078,2341262773),new t(604807628,2007800933),new t(770255983,1495990901),new t(1249150122,1856431235),new t(1555081692,3175218132),new t(1996064986,2198950837),new t(2554220882,3999719339),new t(2821834349,766784016),new t(2952996808,2566594879),new t(3210313671,3203337956),new t(3336571891,1034457026),new t(3584528711,2466948901),new t(113926993,3758326383),new t(338241895,168717936),new t(666307205,1188179964),new t(773529912,1546045734),new t(1294757372,1522805485),new t(1396182291,2643833823),new t(1695183700,2343527390),new t(1986661051,1014477480),new t(2177026350,1206759142),new t(2456956037,344077627),new t(2730485921,1290863460),new t(2820302411,3158454273),new t(3259730800,3505952657),new t(3345764771,106217008),new t(3516065817,3606008344),new t(3600352804,1432725776),new t(4094571909,1467031594),new t(275423344,851169720),new t(430227734,3100823752),new t(506948616,1363258195),new t(659060556,3750685593),new t(883997877,3785050280),new t(958139571,3318307427),new t(1322822218,3812723403),new t(1537002063,2003034995),new t(1747873779,3602036899),new t(1955562222,1575990012),new t(2024104815,1125592928),new t(2227730452,2716904306),new t(2361852424,442776044),new t(2428436474,593698344),new t(2756734187,3733110249),new t(3204031479,2999351573),new t(3329325298,3815920427),new t(3391569614,3928383900),new t(3515267271,566280711),new t(3940187606,3454069534),new t(4118630271,4000239992),new t(116418474,1914138554),new t(174292421,2731055270),new t(289380356,3203993006),new t(460393269,320620315),new t(685471733,587496836),new t(852142971,1086792851),new t(1017036298,365543100),new t(1126000580,2618297676),new t(1288033470,3409855158),new t(1501505948,4234509866),new t(1607167915,987167468),new t(1816402316,1246189591)],h=Array(64);e=unescape(encodeURIComponent(e));var m=8*e.length;for(e=function(e){for(var t=[],n=8*e.length,r=0;r<n;r+=8)t[r>>5]|=(255&e.charCodeAt(r/8))<<24-r%32;return t}(e),e[m>>5]|=128<<24-m%32,e[31+(m+128>>10<<5)]=m,m=0;m<e.length;m+=32){var g=p[0],v=p[1],w=p[2],y=p[3],b=p[4],C=p[5],E=p[6],A=p[7];for(d=0;80>d;d++){h[d]=16>d?new t(e[2*d+m],e[2*d+m+1]):r(u(h[d-2]),h[d-7],l(h[d-15]),h[d-16]);var x=a(A,s(b),new t(b.highOrder&C.highOrder^~b.highOrder&E.highOrder,b.lowOrder&C.lowOrder^~b.lowOrder&E.lowOrder),f[d],h[d]),N=n(i(g),new t(g.highOrder&v.highOrder^g.highOrder&w.highOrder^v.highOrder&w.highOrder,g.lowOrder&v.lowOrder^g.lowOrder&w.lowOrder^v.lowOrder&w.lowOrder));A=E,E=C,C=b,b=n(y,x),y=w,w=v,v=g,g=n(x,N)}p[0]=n(g,p[0]),p[1]=n(v,p[1]),p[2]=n(w,p[2]),p[3]=n(y,p[3]),p[4]=n(b,p[4]),p[5]=n(C,p[5]),p[6]=n(E,p[6]),p[7]=n(A,p[7])}for(e=[],m=0;m<p.length;m++)e.push(p[m].highOrder),e.push(p[m].lowOrder);return function(e){for(var t,n="",r=4*e.length,a=0;a<r;a+=1)t=e[a>>2]>>8*(3-a%4),n+="0123456789abcdef".charAt(t>>4&15)+"0123456789abcdef".charAt(15&t);return n}(e)},e.login||(e.login={},e.login.sha512=e.sha512),e.image=e.upload=function(t,n){var r,a={options:{}},o={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null,text:{extensionNotAllowed:"The extension is not allowed"}};for(r in o)n&&n.hasOwnProperty(r)?a.options[r]=n[r]:a.options[r]=o[r];1==a.options.multiple&&t.setAttribute("data-multiple",!0),t.content=[],t.classList.add("jupload"),1==a.options.input&&t.classList.add("input"),a.add=function(n){if(0==a.options.multiple&&(t.content=[],t.innerText=""),"image"==a.options.type){var r=document.createElement("img");r.setAttribute("src",n.file),r.setAttribute("tabindex",-1),t.getAttribute("name")||(r.className="jfile",r.content=n),t.appendChild(r)}else{r=n.name?n.name:n.file;var o=document.createElement("div");o.innerText=r||a.options.type,o.classList.add("jupload-item"),o.setAttribute("tabindex",-1),t.appendChild(o)}n.content&&(n.file=e.guid()),t.content.push(n),"function"==typeof a.options.onchange&&a.options.onchange(t,n)},a.addFromFile=function(e){if(e.type.split("/")[0]==a.options.type){var t=new FileReader;t.addEventListener("load",(function(t){t={file:t.srcElement.result,extension:e.name.substr(e.name.lastIndexOf(".")+1),name:e.name,size:e.size,lastmodified:e.lastModified,content:t.srcElement.result},a.add(t)})),t.readAsDataURL(e)}else alert(a.options.text.extensionNotAllowed)},a.addFromUrl=function(t){if("data"==t.substr(0,4)||a.options.remoteParser)if("data"==t.substr(0,4)){var n=t.split(";");n=n[0].split("/"),n[0].replace("data:","")==a.options.type?a.add({file:t,name:"",extension:n[1],content:t}):alert(a.options.text.extensionNotAllowed)}else n=t.substr(t.lastIndexOf(".")+1),t=a.options.remoteParser+t,e.ajax({url:t,type:"GET",dataType:"blob",success:function(e){}});else console.error("remoteParser not defined in your initialization")},o=a.options.type+"/"+a.options.extension;var i=document.createElement("input");i.type="file",i.setAttribute("accept",o),i.onchange=function(){for(var e=0;e<this.files.length;e++)a.addFromFile(this.files[e])},1==a.options.multiple&&i.setAttribute("multiple",!0);var s=null;return t.addEventListener("click",(function(n){s=null,t.children.length&&n.target!==t?n.target.parentNode==t&&(s=n.target):e.click(i)})),t.addEventListener("dblclick",(function(t){e.click(i)})),t.addEventListener("dragenter",(function(e){t.style.border="1px dashed #000"})),t.addEventListener("dragleave",(function(e){t.style.border="1px solid #eee"})),t.addEventListener("dragstop",(function(e){t.style.border="1px solid #eee"})),t.addEventListener("dragover",(function(e){e.preventDefault()})),t.addEventListener("keydown",(function(e){s&&46==e.which&&(e=Array.prototype.indexOf.call(t.children,s),0<=e&&(t.content.splice(e,1),s.remove(),s=null))})),t.addEventListener("drop",(function(e){e.preventDefault(),e.stopPropagation();var n=(e.originalEvent||e).dataTransfer.getData("text/html");if((e.originalEvent||e).dataTransfer.files.length)for(n=0;n<e.dataTransfer.files.length;n++)a.addFromFile(e.dataTransfer.files[n]);else if(n&&(0==a.options.multiple&&(t.innerText=""),e=document.createElement("div"),e.innerHTML=n,e=e.querySelectorAll("img"),e.length))for(n=0;n<e.length;n++)a.addFromUrl(e[n].src);return t.style.border="1px solid #eee",!1})),t.val=function(e){if(void 0===e)return t.content&&t.content.length?t.content:null;if(t.innerText="",t.content=[],e)if(Array.isArray(e))for(var n=0;n<e.length;n++)"string"==typeof e[n]?a.add({file:e[n]}):a.add(e[n]);else"string"==typeof e&&a.add({file:e})},t.upload=t.image=a},e.image.create=function(e){var t=document.createElement("img");return t.setAttribute("src",e.file),t.className="jfile",t.setAttribute("tabindex",-1),t.content=e,t},e.lazyLoading=function(e,t){t.loadUp&&"function"==typeof t.loadUp||(t.loadUp=function(){return!1}),t.loadDown&&"function"==typeof t.loadDown||(t.loadDown=function(){return!1}),t.timer||(t.timer=100);var n=null,r=function(r){if(null==n){r=!1;var a=e.scrollTop;e.scrollTop+2*e.clientHeight>=e.scrollHeight?t.loadDown()&&(a==e.scrollTop&&(e.scrollTop-=e.clientHeight),r=!0):e.scrollTop<=e.clientHeight&&t.loadUp()&&(a==e.scrollTop&&(e.scrollTop+=e.clientHeight),r=!0),n=setTimeout((function(){n=null}),t.timer),r&&"function"==typeof t.onupdate&&t.onupdate()}};return e.onscroll=function(e){r(e)},e.onwheel=function(e){r(e)},{}},e.loading=function(){var e={},t=null;return e.show=function(){t||(t=document.createElement("div"),t.className="jloading"),document.body.appendChild(t)},e.hide=function(){t&&t.parentNode&&document.body.removeChild(t)},e}(),e.mask=function(){var t={currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:"YYYY YYY YY MMMMM MMMM MMM MM DDDDD DDDD DDD DD DY DAY WD D Q HH24 HH12 HH \\[H\\] H AM/PM PM AM MI SS MS MONTH MON Y M".split(" "),general:["A","0","[0-9a-zA-Z$]+","."]},n=function(){if(-1!==this.mask.toLowerCase().indexOf("[h]")){var t=0;this.date[4]&&(t=parseFloat(this.date[4]/60)),t=parseInt(this.date[3])+t,t/=24}else this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]?(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),t=e.two(this.date[0])+"-"+e.two(this.date[1])+"-"+e.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(t+=" "+e.two(this.date[3])+":"+e.two(this.date[4])+":"+e.two(this.date[5]))):t=e.two(this.date[3])+":"+e.two(this.date[4])+":"+e.two(this.date[5]);return t},r=function(e){return null===e||""===e||void 0===e},a=function(e){return"="==(""+e).chartAt(0)},o=function(e){return"currency"===e||"percentage"===e||"numeric"===e},i=function(e){if(e&&Number(e)==e)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var t=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=t[1]}return e||(e=this.mask),t=RegExp("0{1}(.{1})0+","ig"),(t=t.exec(e))&&t[1]&&1==t[1].length?(this.options.decimal=t[1],t[1]):(t=RegExp("#,##","ig"),e.match(t)?this.options.decimal=".":this.options.decimal=",",null)},s=function(e,t){return""==e?"":(t||(t=i.call(this)),e=(""+e).split(t),e[0]=e[0].match(/[\-0-9]+/g,""),e[0]&&(e[0]=e[0].join("")),e[0]?(void 0!==e[1]&&(e[1]=e[1].match(/[0-9]+/g,""),e[1]=e[1]?e[1].join(""):""),e):"")},l=function(e){if(""==e)return"";var t=i.call(this),n=Object.create(this.options||{});if(n.minimumFractionDigits||(n.minimumFractionDigits=1),e=s.call(this,e),""==e)return"";if(e[0]){var r=parseFloat(e.join("."));"percent"==n.style&&(r/=100)}else r=null;return n=new Intl.NumberFormat(this.locale,n).format(r),n=n.split(t),(r=n[1].replace(/[0-9]*/g,""))&&(n[2]=r),n[1]=void 0!==e[1]?t+e[1]:"",n.join("")},u=function(e){return(e=s.call(this,e))?parseFloat(e.join(".")):null},c=function(e,t){if(void 0===e){if("DIV"==this.tagName){var n=0,r=window.getSelection();return r&&0!==r.rangeCount&&(n=r.getRangeAt(0),r=n.cloneRange(),r.selectNodeContents(this),r.setEnd(n.endContainer,n.endOffset),n=r.toString().length),n}return this.selectionStart}if(n=d.call(this),t){r=null;for(var a=0;a<n.length;a++)(n[a].match(/[\-0-9]/g)||"."==n[a]||","==n[a])&&(r=a);null===r&&(r=n.indexOf(" ")),e>=r&&(e=r+1)}e>n.length&&(e=n.length),e&&("DIV"==this.tagName?(r=window.getSelection(),n=document.createRange(),n.setStart(this.childNodes[0],e),r.removeAllRanges(),r.addRange(n)):this.selectionEnd=this.selectionStart=e)},d=function(e,t,n){if("DIV"==this.tagName){if(void 0===e)return this.innerText;this.innerText!==e&&(this.innerText=e,t&&c.call(this,t,n))}else{if(void 0===e)return this.value;this.value!==e&&(this.value=e,t&&c.call(this,t,n))}},p=e.calendar.weekdays,f=e.calendar.weekdaysShort,h=e.calendar.months,m=e.calendar.monthsShort,g={YEAR:function(e,t){var n=""+(new Date).getFullYear();"undefined"===typeof this.values[this.index]&&(this.values[this.index]=""),0<=parseInt(e)&&10>=parseInt(e)&&this.values[this.index].length<t&&(this.values[this.index]+=e),this.values[this.index].length==t&&(2==t?n=n.substr(0,2)+this.values[this.index]:3==t?n=n.substr(0,1)+this.values[this.index]:4==t&&(n=this.values[this.index]),this.date[0]=n,this.index++)},YYYY:function(e){g.YEAR.call(this,e,4)},YYY:function(e){g.YEAR.call(this,e,3)},YY:function(e){g.YEAR.call(this,e,2)},FIND:function(e,t){r(this.values[this.index])&&(this.values[this.index]="");for(var n=0,a=0,o=(this.values[this.index]+e).toLowerCase(),i=0;i<t.length;i++)0==t[i].toLowerCase().indexOf(o)&&(n=i,a++);if(1<a)this.values[this.index]+=e;else if(1==a)return this.values[this.index]=t[n],this.index++,n},MMM:function(e){e=g.FIND.call(this,e,m),void 0!==e&&(this.date[1]=e+1)},MMMM:function(e){e=g.FIND.call(this,e,h),void 0!==e&&(this.date[1]=e+1)},MMMMM:function(e){r(this.values[this.index])&&(this.values[this.index]=""),e=(this.values[this.index]+e).toLowerCase();for(var t=0;t<h.length;t++)if(0==h[t][0].toLowerCase().indexOf(e)){this.values[this.index]=h[t][0],this.date[1]=t+1,this.index++;break}},MM:function(e){r(this.values[this.index])?1<parseInt(e)&&10>parseInt(e)?(this.date[1]=this.values[this.index]="0"+e,this.index++):2>parseInt(e)&&(this.values[this.index]=e):(1==this.values[this.index]&&3>parseInt(e)||0==this.values[this.index]&&0<parseInt(e)&&10>parseInt(e))&&(this.date[1]=this.values[this.index]+=e,this.index++)},M:function(e){var t=!1;0<=parseInt(e)&&10>parseInt(e)?r(this.values[this.index])?(this.values[this.index]=e,1<e&&(this.date[1]=this.values[this.index],this.index++)):1==this.values[this.index]&&3>parseInt(e)||0==this.values[this.index]&&0<parseInt(e)?(this.date[1]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t&&(e=parseInt(this.values[this.index]),0<e&&12>e&&(this.date[2]=this.values[this.index],this.index++,this.position--))},D:function(e){var t=!1;0<=parseInt(e)&&10>parseInt(e)?r(this.values[this.index])?(this.values[this.index]=e,3<parseInt(e)&&(this.date[2]=this.values[this.index],this.index++)):3==this.values[this.index]&&2>parseInt(e)||1==this.values[this.index]||2==this.values[this.index]||0==this.values[this.index]&&0<parseInt(e)?(this.date[2]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t&&(e=parseInt(this.values[this.index]),0<e&&32>e&&(this.date[2]=this.values[this.index],this.index++,this.position--))},DD:function(e){r(this.values[this.index])?3<parseInt(e)&&10>parseInt(e)?(this.date[2]=this.values[this.index]="0"+e,this.index++):10>parseInt(e)&&(this.values[this.index]=e):(3==this.values[this.index]&&2>parseInt(e)||(1==this.values[this.index]||2==this.values[this.index])&&10>parseInt(e)||0==this.values[this.index]&&0<parseInt(e)&&10>parseInt(e))&&(this.date[2]=this.values[this.index]+=e,this.index++)},DDD:function(e){g.FIND.call(this,e,f)},DDDD:function(e){g.FIND.call(this,e,p)},HH12:function(e,t){r(this.values[this.index])?1<parseInt(e)&&10>parseInt(e)?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):10>parseInt(e)&&(this.values[this.index]=e):(1==this.values[this.index]&&3>parseInt(e)||1>this.values[this.index]&&10>parseInt(e))&&(this.date[3]=this.values[this.index]+=e,this.index++)},HH24:function(e,t){0<=parseInt(e)&&10>parseInt(e)&&(null==this.values[this.index]||""==this.values[this.index]?2<parseInt(e)&&10>parseInt(e)?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):10>parseInt(e)&&(this.values[this.index]=e):(2==this.values[this.index]&&4>parseInt(e)||2>this.values[this.index]&&10>parseInt(e))&&(this.date[3]=this.values[this.index]+=e,this.index++))},HH:function(e){g.HH24.call(this,e,1)},H:function(e){g.HH24.call(this,e,0)},"\\[H\\]":function(e){void 0==this.values[this.index]&&(this.values[this.index]=""),e.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=e:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(e,t){null==this.values[this.index]||""==this.values[this.index]?5<parseInt(e)&&10>parseInt(e)?(this.date[t]=this.values[this.index]="0"+e,this.index++):10>parseInt(e)&&(this.values[this.index]=e):10>parseInt(e)&&(this.date[t]=this.values[this.index]+=e,this.index++)},MI:function(e){g.N60.call(this,e,4)},SS:function(e){g.N60.call(this,e,5)},"AM/PM":function(e){this.values[this.index]="",e&&(this.values[this.index]=12<this.date[3]?"PM":"AM"),this.index++},WD:function(e){"undefined"===typeof this.values[this.index]&&(this.values[this.index]=""),0<=parseInt(e)&&7>parseInt(e)&&(this.values[this.index]=e),1==this.value[this.index].length&&this.index++},"0{1}(.{1}0+)?":function(e){var t=i.call(this),n=!1;r(this.values[this.index])?this.values[this.index]="":"-"==this.values[this.index]&&(n=!0);var a=s.call(this,this.values[this.index],t);a&&(this.values[this.index]=a.join(t)),0<=parseInt(e)&&10>parseInt(e)?"0"==this.values[this.index]&&e!=t||(this.values[this.index]+=e):this.values[this.index]&&e==t?t&&-1==this.values[this.index].indexOf(t)&&(this.values[this.index]+=e):"-"==e&&(n=!0),!0===n&&"-"!==this.values[this.index][0]&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?%":function(e){g["0{1}(.{1}0+)?"].call(this,e),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&-1==this.values[this.index].indexOf("%")&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(e){g["0{1}(.{1}0+)?"].call(this,e),e=i.call(this);var t=this.tokens[this.index].substr(1,1),n="-"===this.values[this.index][0],r=s.call(this,this.values[this.index],e);if(""!==r){var a=r[0].match(/[0-9]/g);if(a){a=a.join("");for(var o=[],l=0,u=a.length-1;0<=u;u--)o.push(a[u]),l++,l%3||o.push(t);o=o.reverse(),r[0]=o.join(""),r[0].substr(0,1)==t&&(r[0]=r[0].substr(1))}else r[0]="";this.values[this.index]=r.join(e),n&&(this.values[this.index]="-"+this.values[this.index])}},0:function(e){e.match(/[0-9]/g)&&(this.values[this.index]=e,this.index++)},"[0-9a-zA-Z$]+":function(e){r(this.values[this.index])&&(this.values[this.index]="");var t=this.tokens[this.index];t[this.values[this.index].length]==e?(this.values[this.index]+=e,this.values[this.index]==t&&this.index++):(this.values[this.index]=t,this.index++,e.match(/[\-0-9]/g)&&this.position--)},A:function(e){e.match(/[a-zA-Z]/gi)&&(this.values[this.index]=e,this.index++)},".":function(e){g["[0-9a-zA-Z$]+"].call(this,e)}},v=function(e){var n="general"==this.type?[].concat(t.general):[].concat(t.currency,t.datetime,t.percentage,t.numeric,t.general);return n=new RegExp(n.join("|"),"gi"),e.match(n)},w=function(e){for(var n=this.type?"general"==this.type?["general"]:"datetime"==this.type?["numeric","datetime","general"]:["currency","percentage","numeric","general"]:Object.keys(t),r=0;r<n.length;r++)for(var a=n[r],o=0;o<t[a].length;o++)if(e.match(new RegExp(t[a][o],"gi")))return{type:a,method:t[a][o]}},y=function(e){var t=w.call(this,e);if(t)var n=t.type;if(n){var r=0;e=v.call(this,e);for(var a=0;a<e.length;a++)(t=w.call(this,e[a]))&&o(t.type)&&r++;1<r&&(n="general")}return n};a=function(e){return"="==(""+e)[0]};var b=function(e){return(""+ +e).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,(function(e,t,n,r,a){return 0>a?t+"0."+Array(1-a-n.length).join(0)+n+r:t+n+r+Array(a-r.length+1).join(0)}))},C=function(t,r,s){var p,f={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if("object"==typeof t){if(f.input=t.target,f.value=d.call(t.target),f.caret=c.call(t.target),(p=t.target.getAttribute("data-mask"))&&(f.mask=p),(p=t.target.getAttribute("data-type"))&&(f.type=p),t.target.mask?(t.target.mask.options&&(f.options=t.target.mask.options),t.target.mask.locale&&(f.locale=t.target.mask.locale)):(p=t.target.getAttribute("data-locale"))&&(f.locale=p,f.mask&&(f.options.style=f.mask)),t.target.attributes&&t.target.attributes.length)for(p=0;p<t.target.attributes.length;p++){var h=t.target.attributes[p].name;r=t.target.attributes[p].value,"data"==h.substr(0,4)&&(f.options[h.substr(5)]=r)}}else{if("string"==typeof r)f.mask=r;else for(h=Object.keys(r),p=0;p<h.length;p++)f[h[p]]=r[h[p]];"number"===typeof t&&(i.call(f,f.mask),t=(""+t).replace(".",f.options.decimal)),f.value=t,f.input&&(d.call(f.input,t),e.focus(f.input),f.caret=c.call(f.input))}if(!a(f.value)&&(f.mask||f.locale)){if(f.mask&&(f.mask=f.mask.replace("[-]",""),f.mask.indexOf("##")&&(p=f.mask.split(";"),p[0]&&(p[0]=p[0].replace("*",""),p[0]=p[0].replace(/_/g,""),p[0]=p[0].replace(/-/g,""),p[0]=p[0].replace("(",""),p[0]=p[0].replace(")","")),f.mask=p[0]),f.type||(f.type=y.call(f,f.mask)),f.tokens=v.call(f,f.mask)),"object"!==typeof t||!t.inputType||"insertText"==t.inputType||"insertFromPaste"==t.inputType)if(f.locale)if(f.input)t=f.input,(h=d.call(t))&&(i.call(f),p=l.call(f,h),h=p.length-h.length,h=c.call(t)+h,d.call(t,p,h,!0));else var m=l.call(f,f.value);else{for(m=f.tokens,t=[],p=0;p<m.length;p++)(h=w.call(f,m[p]))?t.push(h.method):t.push(null);for(p=0;p<t.length;p++)"MM"==t[p]&&(t[p-1]&&0<=t[p-1].indexOf("H")||t[p-2]&&0<=t[p-2].indexOf("H")||t[p+1]&&0<=t[p+1].indexOf("S")||t[p+2]&&0<=t[p+2].indexOf("S"))&&(t[p]="MI");for(f.methods=t;f.position<f.value.length&&"undefined"!==typeof f.tokens[f.index];)"function"==typeof g[f.methods[f.index]]?(g[f.methods[f.index]].call(f,f.value[f.position]),f.position++):(f.values[f.index]=f.tokens[f.index],f.index++);if(o(f.type)){for(;"undefined"!==typeof f.tokens[f.index];)(p=w.call(f,f.tokens[f.index]))&&"general"==p.type&&(f.values[f.index]=f.tokens[f.index]),f.index++;t=!0}else t=!1;m=f.values.join(""),f.input&&(p=m.length-f.value.length,d.call(f.input,m,0<p?f.caret+p:f.caret,t))}if(f.input&&(t=null,o(f.type)?(f.number=u.call(f,d.call(f.input)),t="percentage"==f.type?f.number/100:f.number):"datetime"==f.type&&(t=n.call(f),f.date[0]&&f.date[1]&&f.date[2]&&f.input.setAttribute("data-completed",!0)),t&&f.input.setAttribute("data-value",t)),void 0!==m)return s?f:m}};return C.prepare=function(e,t){return t||(t={}),v.call(t,e)},C.apply=function(e){var t=d.call(e.target);1==e.key.length&&(t+=e.key),d.call(e.target,C(t,e.target.getAttribute("data-mask")))},C.run=function(e,t,n){return C(e,{mask:t,decimal:n})},C.extract=function(t,a,o){if(r(t))return t;if("object"!=typeof a)return l;a.options||(a.options={}),!a.mask&&a.format&&(a.mask=a.format),i.call(a,a.mask);var s=null;if("percent"==a.type||"percent"==a.options.style?s="percentage":a.mask&&(s=y.call(a,a.mask)),"datetime"===s){t instanceof Date&&e.calendar.getDateString(l,a.mask),t=C(t,a,!0);var l=n.call(t);t.date[0]&&t.date[1]&&t.date[2]&&!(t.date[3]||t.date[4]||t.date[5])&&(l=e.calendar.now(t.date),l=e.calendar.dateToNum(l))}else l=u.call(a,t),"percentage"==s&&(l/=100),t=a;return t.value=l,o?t:l},C.render=function(t,n,a){if(r(t)||"object"!=typeof n)return t;n.options||(n.options={}),!n.mask&&n.format&&(n.mask=n.format);var o=null;"percent"==n.type||"percent"==n.options.style?o="percentage":n.mask?o=y.call(n,n.mask):t instanceof Date&&(o="datetime");var s=!1;if("datetime"==o||"calendar"==n.type?((o=e.calendar.getDateString(t,n.mask))&&(t=o),n.mask&&a&&(s=!0)):("percentage"==o&&(t*=100),"number"===typeof t?(n.mask&&a?(a=n.mask.match(RegExp("0{1}(.{1})0+","ig")))&&a[0]?(a=a[0].length-2,o=t.toFixed(a)):o=""+t:n.locale&&a?(a=(""+t).split("."),a[1]||(a[1]="00"),o=a.join(".")):o=b(t),null!==o&&(t=o,i.call(n,n.mask),n.options.decimal&&(t=t.replace(".",n.options.decimal)))):n.mask&&a&&(s=!0)),s&&(s=n.mask.length-t.length,0<s))for(a=0;a<s;a++)t+=" ";return C(t,n)},C.set=function(e,t){if(t){e.setAttribute("data-mask",t);var n=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(n)}},"undefined"!==typeof document&&document.addEventListener("input",(function(e){(e.target.getAttribute("data-mask")||e.target.mask)&&C(e)})),C}(),e.modal=function(t,n){var r,a={options:{}},o={url:null,onopen:null,onclose:null,closed:!1,width:null,height:null,title:null,padding:null};for(r in o)n&&n.hasOwnProperty(r)?a.options[r]=n[r]:a.options[r]=o[r];for(!a.options.title&&t.getAttribute("title")&&(a.options.title=t.getAttribute("title")),o=document.createElement("div");t.children[0];)o.appendChild(t.children[0]);for(a.content=document.createElement("div"),a.content.className="jmodal_content",a.content.innerHTML=t.innerHTML;o.children[0];)a.content.appendChild(o.children[0]);a.container=document.createElement("div"),a.container.className="jmodal",a.container.appendChild(a.content),a.options.padding&&(a.content.style.padding=a.options.padding),a.options.width&&(a.container.style.width=a.options.width),a.options.height&&(a.container.style.height=a.options.height),a.options.title?a.container.setAttribute("title",a.options.title):a.container.classList.add("no-title"),t.innerHTML="",t.style.display="none",t.appendChild(a.container);var i=document.createElement("div");return i.className="jmodal_backdrop",i.onclick=function(){a.close()},t.appendChild(i),a.open=function(){t.style.display="block";var n=a.container.getBoundingClientRect();e.getWindowWidth()<n.width?(a.container.style.top="",a.container.style.left="",a.container.classList.add("jmodal_fullscreen"),e.animation.slideBottom(a.container,1)):i.style.display="block",e.modal.current=a,"function"==typeof a.options.onopen&&a.options.onopen(t,a)},a.resetPosition=function(){a.container.style.top="",a.container.style.left=""},a.isOpen=function(){return"none"!=t.style.display},a.close=function(){t.style.display="none",i.style.display="",e.modal.current=null,a.container.classList.remove("jmodal_fullscreen"),"function"==typeof a.options.onclose&&a.options.onclose(t,a)},e.modal.hasEvents||(e.modal.current=a,!0==="ontouchstart"in document.documentElement?document.addEventListener("touchstart",e.modal.mouseDownControls):(document.addEventListener("mousedown",e.modal.mouseDownControls),document.addEventListener("mousemove",e.modal.mouseMoveControls),document.addEventListener("mouseup",e.modal.mouseUpControls)),document.addEventListener("keydown",e.modal.keyDownControls),e.modal.hasEvents=!0),a.options.url?e.ajax({url:a.options.url,method:"GET",dataType:"text/html",success:function(e){a.content.innerHTML=e,a.options.closed||a.open()}}):a.options.closed||a.open(),t.modal=a},e.modal.current=null,e.modal.position=null,e.modal.keyDownControls=function(t){27==t.which&&e.modal.current&&e.modal.current.close()},e.modal.mouseUpControls=function(t){e.modal.current&&(e.modal.current.container.style.cursor="auto"),e.modal.position=null},e.modal.mouseMoveControls=function(t){if(e.modal.current&&e.modal.position)if(1==t.which||3==t.which){var n=e.modal.position;e.modal.current.container.style.top=n[1]+(t.clientY-n[3])+n[5]/2+"px",e.modal.current.container.style.left=n[0]+(t.clientX-n[2])+n[4]/2+"px",e.modal.current.container.style.cursor="move"}else e.modal.current.container.style.cursor="auto"},e.modal.mouseDownControls=function(t){e.modal.position=[],t.target.classList.contains("jmodal")&&setTimeout((function(){var n=t.target.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var r=t.changedTouches[0].clientX,a=t.changedTouches[0].clientY;else r=t.clientX,a=t.clientY;50>n.width-(r-n.left)&&50>a-n.top?setTimeout((function(){e.modal.current.close()}),100):t.target.getAttribute("title")&&50>a-n.top&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),e.modal.position=[n.left,n.top,t.clientX,t.clientY,n.width,n.height])}),100)},e.notification=function(t){var n={options:{}},r={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(o in r)t&&t.hasOwnProperty(o)?n.options[o]=t[o]:n.options[o]=r[o];var a=document.createElement("div");a.className="jnotification",n.options.error&&a.classList.add("jnotification-error"),t=document.createElement("div"),t.className="jnotification-container",a.appendChild(t),r=document.createElement("div"),r.className="jnotification-header",t.appendChild(r);var o=document.createElement("div");if(o.className="jnotification-image",r.appendChild(o),n.options.icon){var i=document.createElement("img");i.src=n.options.icon,o.appendChild(i)}if(o=document.createElement("div"),o.className="jnotification-name",o.innerHTML=n.options.name,r.appendChild(o),1==n.options.closeable&&(o=document.createElement("div"),o.className="jnotification-close",o.onclick=function(){n.hide()},r.appendChild(o)),o=document.createElement("div"),o.className="jnotification-date",r.appendChild(o),r=document.createElement("div"),r.className="jnotification-content",t.appendChild(r),n.options.title&&(t=document.createElement("div"),t.className="jnotification-title",t.innerHTML=n.options.title,r.appendChild(t)),t=document.createElement("div"),t.className="jnotification-message",t.innerHTML=n.options.message,r.appendChild(t),n.show=function(){document.body.appendChild(a),800<e.getWindowWidth()?e.animation.fadeIn(a):e.animation.slideTop(a,1)},n.hide=function(){800<e.getWindowWidth()?e.animation.fadeOut(a,(function(){a.parentNode&&(a.parentNode.removeChild(a),s&&clearTimeout(s))})):e.animation.slideTop(a,0,(function(){a.parentNode&&(a.parentNode.removeChild(a),s&&clearTimeout(s))}))},n.show(),1==n.options.autoHide)var s=setTimeout((function(){n.hide()}),n.options.timeout);return 800>e.getWindowWidth()&&a.addEventListener("swipeup",(function(e){n.hide(),e.preventDefault(),e.stopPropagation()})),n},e.notification.isVisible=function(){var e=document.querySelector(".jnotification");return!(!e||!e.parentNode)},e.palette=function(e){var t={material:["#ffebee #fce4ec #f3e5f5 #e8eaf6 #e3f2fd #e0f7fa #e0f2f1 #e8f5e9 #f1f8e9 #f9fbe7 #fffde7 #fff8e1 #fff3e0 #fbe9e7 #efebe9 #fafafa #eceff1".split(" "),"#ffcdd2 #f8bbd0 #e1bee7 #c5cae9 #bbdefb #b2ebf2 #b2dfdb #c8e6c9 #dcedc8 #f0f4c3 #fff9c4 #ffecb3 #ffe0b2 #ffccbc #d7ccc8 #f5f5f5 #cfd8dc".split(" "),"#ef9a9a #f48fb1 #ce93d8 #9fa8da #90caf9 #80deea #80cbc4 #a5d6a7 #c5e1a5 #e6ee9c #fff59d #ffe082 #ffcc80 #ffab91 #bcaaa4 #eeeeee #b0bec5".split(" "),"#e57373 #f06292 #ba68c8 #7986cb #64b5f6 #4dd0e1 #4db6ac #81c784 #aed581 #dce775 #fff176 #ffd54f #ffb74d #ff8a65 #a1887f #e0e0e0 #90a4ae".split(" "),"#ef5350 #ec407a #ab47bc #5c6bc0 #42a5f5 #26c6da #26a69a #66bb6a #9ccc65 #d4e157 #ffee58 #ffca28 #ffa726 #ff7043 #8d6e63 #bdbdbd #78909c".split(" "),"#f44336 #e91e63 #9c27b0 #3f51b5 #2196f3 #00bcd4 #009688 #4caf50 #8bc34a #cddc39 #ffeb3b #ffc107 #ff9800 #ff5722 #795548 #9e9e9e #607d8b".split(" "),"#e53935 #d81b60 #8e24aa #3949ab #1e88e5 #00acc1 #00897b #43a047 #7cb342 #c0ca33 #fdd835 #ffb300 #fb8c00 #f4511e #6d4c41 #757575 #546e7a".split(" "),"#d32f2f #c2185b #7b1fa2 #303f9f #1976d2 #0097a7 #00796b #388e3c #689f38 #afb42b #fbc02d #ffa000 #f57c00 #e64a19 #5d4037 #616161 #455a64".split(" "),"#c62828 #ad1457 #6a1b9a #283593 #1565c0 #00838f #00695c #2e7d32 #558b2f #9e9d24 #f9a825 #ff8f00 #ef6c00 #d84315 #4e342e #424242 #37474f".split(" "),"#b71c1c #880e4f #4a148c #1a237e #0d47a1 #006064 #004d40 #1b5e20 #33691e #827717 #f57f17 #ff6f00 #e65100 #bf360c #3e2723 #212121 #263238".split(" ")],fire:["0b1a6d 840f38 b60718 de030b ff0c0c fd491c fc7521 faa331 fbb535 ffc73a".split(" "),"071147 5f0b28 930513 be0309 ef0000 fa3403 fb670b f9991b faad1e ffc123".split(" "),"03071e 370617 6a040f 9d0208 d00000 dc2f02 e85d04 f48c06 faa307 ffba08".split(" "),"020619 320615 61040d 8c0207 bc0000 c82a02 d05203 db7f06 e19405 efab00".split(" "),"020515 2d0513 58040c 7f0206 aa0000 b62602 b94903 c57205 ca8504 d89b00".split(" ")],baby:["eddcd2 fff1e6 fde2e4 fad2e1 c5dedd dbe7e4 f0efeb d6e2e9 bcd4e6 99c1de".split(" "),"e1c4b3 ffd5b5 fab6ba f5a8c4 aacecd bfd5cf dbd9d0 baceda 9dc0db 7eb1d5".split(" "),"daa990 ffb787 f88e95 f282a9 8fc4c3 a3c8be cec9b3 9dbcce 82acd2 649dcb".split(" "),"d69070 ff9c5e f66770 f05f8f 74bbb9 87bfae c5b993 83aac3 699bca 4d89c2".split(" "),"c97d5d f58443 eb4d57 e54a7b 66a9a7 78ae9c b5a67e 7599b1 5c88b7 4978aa".split(" ")]};return t[e]?t[e]:t.material},e.picker=function(t,n){if(t.picker)return t.picker.setOptions(n,!0);var r={type:"picker",options:{}},a=null,o=null;return r.setOptions=function(e,t){var n={value:0,data:null,render:null,onchange:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,content:!1,columns:null,height:null};for(var i in e&&e.options&&(e.data=e.options),n)e&&e.hasOwnProperty(i)?r.options[i]=e[i]:"undefined"!=typeof r.options[i]&&!0!==t||(r.options[i]=n[i]);for(a.style.display=!1===r.options.header?"none":"",a.style.width=r.options.width?parseInt(r.options.width)+"px":"",r.options.height?(o.style.maxHeight=r.options.height+"px",o.style.overflow="scroll"):o.style.overflow="",0<r.options.columns&&(o.classList.add("jpicker-columns"),o.style.width=r.options.width?r.options.width:36*r.options.columns+"px"),isNaN(r.options.value)&&(r.options.value="0"),o.innerHTML="",n=Object.keys(r.options.data),i=0;i<n.length;i++){var s=document.createElement("div");s.classList.add("jpicker-item"),s.k=n[i],s.v=r.options.data[n[i]],s.innerHTML=r.getLabel(n[i]),o.appendChild(s)}return r.setValue(r.options.value),r},r.getValue=function(){return r.options.value},r.setValue=function(e){r.setLabel(e),r.options.value=String(e),t.value!=r.options.value&&(t.value=r.options.value,"function"==typeof t.onchange)&&t.onchange({type:"change",target:t,value:t.value}),"generic"!==o.children[e].getAttribute("type")&&r.close()},r.getLabel=function(e){return e=r.options.data[e]||null,"function"==typeof r.options.render&&(e=r.options.render(e)),e},r.setLabel=function(e){e=r.options.content?'<i class="material-icons">'+r.options.content+"</i>":r.getLabel(e),a.innerHTML=e},r.open=function(){if(!t.classList.contains("jpicker-focus")){e.tracking(r,!0),t.classList.add("jpicker-focus"),t.focus();var n=a.getBoundingClientRect(),i=o.getBoundingClientRect();o.style.marginTop=window.innerHeight<n.bottom+i.height?-1*(i.height+4)+"px":n.height+2+"px",!0===r.options.right&&(o.style.marginLeft=-1*i.width+24+"px"),"function"==typeof r.options.onopen&&r.options.onopen(t,r)}},r.close=function(){t.classList.contains("jpicker-focus")&&(t.classList.remove("jpicker-focus"),e.tracking(r,!1),"function"==typeof r.options.onclose)&&r.options.onclose(t,r)},function(){t.classList.add("jpicker"),t.setAttribute("tabindex","900"),t.onmousedown=function(e){t.classList.contains("jpicker-focus")||r.open()},a=document.createElement("div"),a.classList.add("jpicker-header"),o=document.createElement("div"),o.classList.add("jpicker-content"),o.onclick=function(n){(n=e.findElement(n.target,"jpicker-item"))&&n.parentNode===o&&(r.setValue(n.k),"function"==typeof r.options.onchange&&r.options.onchange.call(r,t,r,n.v,n.v,n.k))},t.appendChild(a),t.appendChild(o),t.value=n.value||0,r.setOptions(n),"function"==typeof r.options.onload&&r.options.onload(t,r),t.change=r.setValue,t.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},t.picker=r}(),r},e.progressbar=function(e,t){var n,r={options:{}},a={value:0,onchange:null,width:null};for(n in a)t&&t.hasOwnProperty(n)?r.options[n]=t[n]:r.options[n]=a[n];e.classList.add("jprogressbar"),e.setAttribute("tabindex",1),e.setAttribute("data-value",r.options.value);var o=document.createElement("div");return o.style.width=r.options.value+"%",o.style.color="#fff",e.appendChild(o),r.options.width&&(e.style.width=r.options.width),r.setValue=function(t){t=parseInt(t),r.options.value=t,o.style.width=t+"%",e.setAttribute("data-value",t+"%"),e.style.color=6>t?"#000":"#fff",r.options.value=t,"function"==typeof r.options.onchange&&r.options.onchange(e,t),e.value!=r.options.value&&(e.value=r.options.value,"function"==typeof e.onchange)&&e.onchange({type:"change",target:e,value:e.value})},r.getValue=function(){return r.options.value},a=function(t){if(t.which){var n=e.getBoundingClientRect();r.setValue(Math.round(((t.changedTouches&&t.changedTouches[0]?t.changedTouches[0].clientX:t.clientX)-n.left)/n.width*100))}},!0==="touchstart"in document.documentElement?(e.addEventListener("touchstart",a),e.addEventListener("touchend",a)):(e.addEventListener("mousedown",a),e.addEventListener("mousemove",a)),e.change=r.setValue,e.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},e.progressbar=r},e.rating=function(e,t){if(e.rating)return e.rating.setOptions(t,!0);var n={options:{},setOptions:function(t,r){var a={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(o in a)t&&t.hasOwnProperty(o)?n.options[o]=t[o]:"undefined"!=typeof n.options[o]&&!0!==r||(n.options[o]=a[o]);for(e.innerHTML="",a=0;a<n.options.number;a++){var o=document.createElement("div");o.setAttribute("data-index",a+1),o.setAttribute("title",n.options.tooltip[a]),e.appendChild(o)}if(n.options.value)for(a=0;a<n.options.number;a++)a<n.options.value&&e.children[a].classList.add("jrating-selected");return n},setValue:function(t){for(var r=0;r<n.options.number;r++)r<t?e.children[r].classList.add("jrating-selected"):(e.children[r].classList.remove("jrating-over"),e.children[r].classList.remove("jrating-selected"));n.options.value=t,"function"==typeof n.options.onchange&&n.options.onchange(e,t),e.value!=n.options.value&&(e.value=n.options.value,"function"==typeof e.onchange)&&e.onchange({type:"change",target:e,value:e.value})},getValue:function(){return n.options.value}};return function(){n.setOptions(t),e.classList.add("jrating"),e.addEventListener("click",(function(e){e=e.target.getAttribute("data-index"),void 0!=e&&(e==n.options.value?n.setValue(0):n.setValue(e))})),e.addEventListener("mouseover",(function(t){t=t.target.getAttribute("data-index");for(var r=0;r<n.options.number;r++)r<t?e.children[r].classList.add("jrating-over"):e.children[r].classList.remove("jrating-over")})),e.addEventListener("mouseout",(function(t){for(t=0;t<n.options.number;t++)e.children[t].classList.remove("jrating-over")})),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.rating=n}(),n},e.search=function(t,n){if(t.search)return t.search;var r=null,a=function(e){if(l.innerHTML="",e.length){t.style.display="block";for(var n=11>e.length?e.length:10,r=0;r<n;r++){var a=e[r].text;!a&&e[r].name&&(a=e[r].name);var o=e[r].value;!o&&e[r].id&&(o=e[r].id);var i=document.createElement("div");i.setAttribute("data-value",o),i.setAttribute("data-text",a),i.className="jsearch_item",e[r].id&&i.setAttribute("id",e[r].id),0==r&&i.classList.add("selected"),o=document.createElement("img"),e[r].image?o.src=e[r].image:o.style.display="none",i.appendChild(o),o=document.createElement("div"),o.innerHTML=a,i.appendChild(o),l.appendChild(i)}}else t.style.display=""},o=function(t){if(t!=s.terms)if(s.terms=t,r=0,Array.isArray(s.options.data)){var n=s.options.data.filter((function(e){e:{for(var n in e)if(0<=(""+e[n]).toLowerCase().search(t)){e=!0;break e}e=!1}return e}));a(n)}else e.ajax({url:s.options.data+t,method:"GET",dataType:"json",success:function(e){a(e)}})},i=null,s=function(e){i&&clearTimeout(i),i=setTimeout((function(){o(e)}),500)};s.options={data:n.data||null,input:n.input||null,onselect:n.onselect||null},s.selectIndex=function(e){var t=e.getAttribute("id"),n=e.getAttribute("data-text");e=e.getAttribute("data-value"),"function"==typeof s.options.onselect&&s.options.onselect(s,n,e,t),s.close()},s.open=function(){t.style.display="block"},s.close=function(){i&&clearTimeout(i),s.terms="",l.innerHTML="",t.style.display=""},s.isOpened=function(){return!!t.style.display},s.keydown=function(e){s.isOpened()&&("Enter"==e.key?l.children[r]&&(s.selectIndex(l.children[r]),e.preventDefault()):"ArrowUp"===e.key?(l.children[0]&&(l.children[r].classList.remove("selected"),0<r&&r--,l.children[r].classList.add("selected")),e.preventDefault()):"ArrowDown"===e.key&&(l.children[r].classList.remove("selected"),9>r&&l.children[r+1]&&r++,l.children[r].classList.add("selected"),e.preventDefault()))},s.keyup=function(t){s.options.input?s(s.options.input.value):(t=e.getNode())&&s(t.innerText)};var l=document.createElement("div");return l.classList.add("jsearch_container"),l.onmousedown=function(e){var t=e.target.classList.contains("jsearch_item")?e.target:e.target.parentNode;s.selectIndex(t),e.preventDefault()},t.appendChild(l),t.classList.add("jsearch"),t.search=s},e.slider=function(e,t){var n={options:{},currentImage:null};if(t&&(n.options=t),e.setAttribute("tabindex","900"),n.options.items=[],!e.classList.contains("jslider")){if(e.classList.add("jslider"),e.classList.add("unselectable"),n.options.height&&(e.style.minHeight=n.options.height),n.options.width&&(e.style.width=n.options.width),n.options.grid){e.classList.add("jslider-grid");var r=e.children.length;4<r&&e.setAttribute("data-total",r-4),e.setAttribute("data-number",4<r?4:r)}var a=document.createElement("div");if(a.classList.add("jslider-counter"),0<e.children.length)for(r=0;r<e.children.length;r++){n.options.items.push(e.children[r]);var o=document.createElement("div");o.onclick=function(){var e=Array.prototype.slice.call(a.children).indexOf(this);n.show(n.currentImage=n.options.items[e])},a.appendChild(o)}r=document.createElement("div"),r.className="jslider-caption";var i=document.createElement("div");o=document.createElement("div"),o.className="jslider-close",o.innerHTML="",o.onclick=function(){n.close()},i.appendChild(r),i.appendChild(o)}return n.updateCounter=function(e){for(var t=0;t<a.children.length;t++)if(a.children[t].classList.contains("jslider-counter-focus")){a.children[t].classList.remove("jslider-counter-focus");break}a.children[e].classList.add("jslider-counter-focus")},n.show=function(t){t||(t=e.children[0]),e.classList.add("jslider-focus"),e.classList.remove("jslider-grid"),e.appendChild(i),e.appendChild(a);var r=n.options.items.indexOf(t);for(n.updateCounter(r),r=0;r<e.children.length;r++)e.children[r].style.display="";t.style.display="block",t.previousElementSibling?e.classList.add("jslider-left"):e.classList.remove("jslider-left"),t.nextElementSibling&&"IMG"==t.nextElementSibling.tagName?e.classList.add("jslider-right"):e.classList.remove("jslider-right"),n.currentImage=t,n.currentImage.offsetHeight>n.currentImage.offsetWidth&&n.currentImage.classList.add("jslider-vertical"),i.children[0].innerText=n.currentImage.getAttribute("title")},n.open=function(){n.show(),"function"==typeof n.options.onopen&&n.options.onopen(e)},n.close=function(){e.classList.remove("jslider-focus"),e.classList.remove("jslider-left"),e.classList.remove("jslider-right"),n.options.grid&&e.classList.add("jslider-grid");for(var t=0;t<e.children.length;t++)e.children[t].style.display="";a.remove(),i.remove(),n.currentImage=null,"function"==typeof n.options.onclose&&n.options.onclose(e)},n.reset=function(){e.innerHTML=""},n.next=function(){var e=n.currentImage.nextElementSibling;e&&"IMG"===e.tagName&&n.show(n.currentImage.nextElementSibling)},n.prev=function(){n.currentImage.previousElementSibling&&n.show(n.currentImage.previousElementSibling)},r=function(e){if("IMG"==e.target.tagName)n.show(e.target);else if(!e.target.classList.contains("jslider-close")&&!e.target.parentNode.classList.contains("jslider-counter")&&!e.target.classList.contains("jslider-counter")){var t=e.offsetX||e.changedTouches[0].clientX;40>e.target.clientWidth-t?n.next():40>t&&n.prev()}},!0==="ontouchend"in document.documentElement?e.addEventListener("touchend",r):e.addEventListener("mouseup",r),e.addEventListener("swipeleft",(function(e){n.next(),e.preventDefault(),e.stopPropagation()})),e.addEventListener("swiperight",(function(e){n.prev(),e.preventDefault(),e.stopPropagation()})),e.addEventListener("keydown",(function(e){27==e.which&&n.close()})),e.slider=n},e.sorting=function(e,t){var n,r={},a={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},o=null;for(n in a)t&&t.hasOwnProperty(n)?r[n]=t[n]:r[n]=a[n];e.classList.add("jsorting"),e.addEventListener("dragstart",(function(t){var n=Array.prototype.indexOf.call(t.target.parentNode.children,t.target);o={element:t.target,o:n,d:n},t.target.style.opacity="0.25","function"==typeof r.ondragstart&&r.ondragstart(e,t.target,t)})),e.addEventListener("dragover",(function(e){e.preventDefault(),i(e.target)&&o&&"true"==e.target.getAttribute("draggable")&&o.element!=e.target&&((r.direction?e.target.clientWidth/2>e.offsetX:e.target.clientHeight/2>e.offsetY)?e.target.parentNode.insertBefore(o.element,e.target):e.target.parentNode.insertBefore(o.element,e.target.nextSibling),o.d=Array.prototype.indexOf.call(e.target.parentNode.children,o.element))})),e.addEventListener("dragleave",(function(e){e.preventDefault()})),e.addEventListener("dragend",(function(t){t.preventDefault(),o&&("function"==typeof r.ondragend&&r.ondragend(e,o.element,t),o.o<o.d?t.target.parentNode.insertBefore(o.element,t.target.parentNode.children[o.o]):t.target.parentNode.insertBefore(o.element,t.target.parentNode.children[o.o].nextSibling),o.element.style.opacity="",o=null)})),e.addEventListener("drop",(function(t){t.preventDefault(),o&&o.o!=o.d&&"function"==typeof r.ondrop&&r.ondrop(e,o.o,o.d,o.element,t.target,t),o.element.style.opacity="",o=null}));var i=function(e){function t(e){e.className&&e.classList.contains("jsorting")&&(n=!0),n||t(e.parentNode)}var n=!1;return t(e),n};for(a=0;a<e.children.length;a++)e.children[a].hasAttribute("draggable")||e.children[a].setAttribute("draggable","true");return e.val=function(){for(var t,n=[],r=0;r<e.children.length;r++)(t=e.children[r].getAttribute("data-id"))&&n.push(t);return n},e},e.tabs=function(t,n){var r={options:{}},a={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null};for(c in a)n&&n.hasOwnProperty(c)?r.options[c]=n[c]:r.options[c]=a[c];t.classList.add("jtabs");var o=null,i=null,s=null,l=function(e){if(r.options.animation){var t=r.headers.children[e].getBoundingClientRect();"modern"==r.options.palette?(s.style.width=t.width-4+"px",s.style.left=r.headers.children[e].offsetLeft+2+"px"):(s.style.width=t.width+"px",s.style.left=r.headers.children[e].offsetLeft+"px"),"bottom"==r.options.position?s.style.top="0px":s.style.bottom="0px"}},u=function(e){"function"==typeof r.headers.scrollTo?r.headers.scrollTo({left:e,behavior:"smooth"}):r.headers.scrollLeft=e,1>=e?o.classList.add("disabled"):o.classList.remove("disabled"),e>=r.headers.scrollWidth-r.headers.offsetWidth?i.classList.add("disabled"):i.classList.remove("disabled"),r.headers.scrollWidth<=r.headers.offsetWidth?(o.style.display="none",i.style.display="none"):(o.style.display="",i.style.display="")};if(r.setBorder=l,r.open=function(e){for(var n=null,a=0;a<r.headers.children.length;a++)r.headers.children[a].classList.contains("jtabs-selected")&&(n=a),r.headers.children[a].classList.remove("jtabs-selected"),r.content.children[a]&&r.content.children[a].classList.remove("jtabs-selected");if(r.headers.children[e].classList.add("jtabs-selected"),r.content.children[e]&&r.content.children[e].classList.add("jtabs-selected"),n!=e&&"function"==typeof r.options.onchange&&r.content.children[e]&&r.options.onchange(t,r,e,r.headers.children[e],r.content.children[e]),1==r.options.hideHeaders&&3>r.headers.children.length&&0==r.options.allowCreate)r.headers.parentNode.style.display="none";else{l(e),r.headers.parentNode.style.display="",n=r.headers.children[e].offsetLeft,e=n+r.headers.children[e].offsetWidth,a=r.headers.scrollLeft;var o=a+r.headers.offsetWidth;a<=n&&o>=e||u(n-1)}},r.selectIndex=function(e){return e=Array.prototype.indexOf.call(r.headers.children,e),0<=e&&r.open(e),e},r.rename=function(e,t){t||(t=prompt("New title",r.headers.children[e].innerText)),r.headers.children[e].innerText=t,r.open(e)},r.create=function(e,n){if("function"==typeof r.options.onbeforecreate){var a=r.options.onbeforecreate(t);if(!1===a)return!1;e=a}return a=r.appendElement(e),"function"==typeof r.options.oncreate&&r.options.oncreate(t,a),a},r.remove=function(e){return r.deleteElement(e)},r.nextNumber=function(){for(var e=0,t=0;t<r.headers.children.length;t++){var n=r.headers.children[t].innerText.match(/[0-9].*/);n>e&&(e=parseInt(n))}return e?e++:e=1,e},r.deleteElement=function(e){if(!r.headers.children[e])return!1;r.headers.removeChild(r.headers.children[e]),r.content.removeChild(r.content.children[e]),r.open(0),"function"==typeof r.options.ondelete&&r.options.ondelete(t,e)},r.appendElement=function(e){if(e||(e=prompt("Title?","")),e){var t=document.createElement("div");r.content.appendChild(t);var n=document.createElement("div");return n.innerHTML=e,n.content=t,r.headers.insertBefore(n,r.headers.lastChild),r.options.allowChangePosition&&n.setAttribute("draggable","true"),r.selectIndex(n),t}},r.getActive=function(){for(var e=0;e<r.headers.children.length;e++)if(r.headers.children[e].classList.contains("jtabs-selected"))return e;return 0},r.updateContent=function(e,t){if("string"===typeof t){var n=document.createElement("div");n.innerHTML=t}r.content.children[e].classList.contains("jtabs-selected")&&t.classList.add("jtabs-selected"),r.content.replaceChild(t,r.content.children[e])},r.updatePosition=function(e,t){e>t?r.content.insertBefore(r.content.children[e],r.content.children[t]):r.content.insertBefore(r.content.children[e],r.content.children[t].nextSibling),r.open(t),"function"==typeof r.options.onchangeposition&&r.options.onchangeposition(r.headers,e,t)},r.move=function(e,t){e>t?r.headers.insertBefore(r.headers.children[e],r.headers.children[t]):r.headers.insertBefore(r.headers.children[e],r.headers.children[t].nextSibling),r.updatePosition(e,t)},r.setBorder=l,r.init=function(){t.innerHTML="",r.headers=document.createElement("div"),r.content=document.createElement("div"),r.headers.classList.add("jtabs-headers"),r.content.classList.add("jtabs-content"),r.options.palette?t.classList.add("jtabs-modern"):t.classList.remove("jtabs-modern"),r.options.padding&&(r.content.style.padding=parseInt(r.options.padding)+"px");var n=document.createElement("div");n.className="jtabs-headers-container",n.appendChild(r.headers);var a=document.createElement("div");for(a.className="jtabs-controls",a.setAttribute("draggable","false"),n.appendChild(a),"bottom"==r.options.position?(t.appendChild(r.content),t.appendChild(n)):(t.appendChild(n),t.appendChild(r.content)),1==r.options.allowCreate&&(n=document.createElement("div"),n.className="jtabs-add",n.onclick=function(){r.create()},a.appendChild(n)),o=document.createElement("div"),o.className="jtabs-prev",o.onclick=function(){u(r.headers.scrollLeft-r.headers.offsetWidth)},a.appendChild(o),i=document.createElement("div"),i.className="jtabs-next",i.onclick=function(){u(r.headers.scrollLeft+r.headers.offsetWidth)},a.appendChild(i),a=0;a<r.options.data.length;a++){if(n=r.options.data[a].titleElement?r.options.data[a].titleElement:document.createElement("div"),r.options.data[a].icon){var l=document.createElement("div"),c=document.createElement("i");c.classList.add("material-icons"),c.innerHTML=r.options.data[a].icon,l.appendChild(c),n.appendChild(l)}r.options.data[a].title&&(l=document.createTextNode(r.options.data[a].title),n.appendChild(l)),r.options.data[a].width&&(n.style.width=r.options.data[a].width),r.options.data[a].contentElement?l=r.options.data[a].contentElement:(l=document.createElement("div"),l.innerHTML=r.options.data[a].content),r.headers.appendChild(n),r.content.appendChild(l)}s=document.createElement("div"),s.className="jtabs-border",r.headers.appendChild(s),r.options.animation&&t.classList.add("jtabs-animation"),r.headers.addEventListener("click",(function(e){e=e.target.parentNode.classList.contains("jtabs-headers")?e.target:"I"==e.target.tagName?e.target.parentNode.parentNode:e.target.parentNode,e=r.selectIndex(e),"function"==typeof r.options.onclick&&r.options.onclick(t,r,e,r.headers.children[e],r.content.children[e])})),r.headers.addEventListener("contextmenu",(function(e){r.selectIndex(e.target)})),r.headers.children.length&&r.open(0),u(0),1==r.options.allowChangePosition&&e.sorting(r.headers,{direction:1,ondrop:function(e,t,n){r.updatePosition(t,n)}}),"function"==typeof r.options.onload&&r.options.onload(t,r)},t.children[0]&&t.children[0].children.length)for(a=0;a<t.children[0].children.length;a++){var c=r.options.data&&r.options.data[a]?r.options.data[a]:{};t.children[1]&&t.children[1].children[a]?(c.titleElement=t.children[0].children[a],c.contentElement=t.children[1].children[a]):c.contentElement=t.children[0].children[a],r.options.data[a]=c}if(c=!1,r.options.data)for(a=0;a<r.options.data.length;a++)r.options.data[a].url&&(e.ajax({url:r.options.data[a].url,type:"GET",dataType:"text/html",index:a,success:function(e){r.options.data[this.index].content=e},complete:function(){r.init()}}),c=!0);return c||r.init(),t.tabs=r},e.tags=function(t,n){if(t.tags)return t.tags.setOptions(n,!0);var r={type:"tags",options:{}},a=function(){return!!(r.options.limit&&t.children.length>=r.options.limit)},o=null,i=null;r.setOptions=function(n,a){var s,l={value:"",limit:null,limitMessage:"The limit of entries is: ",search:null,placeholder:null,validation:null,onbeforechange:null,onchange:null,onfocus:null,onblur:null,onload:null,colors:null};for(s in l)n&&n.hasOwnProperty(s)?r.options[s]=n[s]:"undefined"!=typeof r.options[s]&&!0!==a||(r.options[s]=l[s]);return r.options.placeholder?t.setAttribute("data-placeholder",r.options.placeholder):t.removeAttribute("data-placeholder"),t.placeholder=r.options.placeholder,r.setValue(r.options.value),c(),r.options.search?i||(i=document.createElement("div"),t.parentNode.insertBefore(i,t.nextSibling),o=e.search(i,{data:r.options.search,onselect:function(e,t,n){r.selectIndex(t,n)}})):i&&(o=null,i.remove(),i=null),r},r.add=function(n,i){if("function"==typeof r.options.onbeforechange){var c=r.options.onbeforechange(t,r,r.options.value,n);if(!1===c)return!1;null!=c&&(n=c)}if(o&&o.close(),a())alert(r.options.limitMessage+" "+r.options.limit);else{if(c=e.getNode(),!(c&&c.parentNode&&c.parentNode.classList.contains("jtags")&&c.nextSibling)||c.nextSibling.innerText&&c.nextSibling.innerText.trim()){if(t.lastChild&&(t.lastChild.innerText.trim()||t.removeChild(t.lastChild)),n&&"string"!=typeof n){for(c=0;c<=n.length;c++)if(!a()){if(n[c]&&"string"!=typeof n[c])d=n[c].text,p=n[c].value;else var d=n[c]||"",p=null;d=l(d,p)}}else d=l(n,n,c);u()}else d=c.nextSibling;i&&s(d)}},r.remove=function(e){e.parentNode.removeChild(e),t.children.length?u():r.add("",!0)},r.getData=function(){for(var e=[],n=0;n<t.children.length;n++){var r=t.children[n].innerText.replace("\n",""),a=t.children[n].getAttribute("data-value");a||(a=r),(r||a)&&e.push({text:r,value:a})}return e},r.getValue=function(e){var n;if(null!=e)(n=t.children[e].getAttribute("data-value"))||(n=t.children[e].innerText.replace("\n",""));else{e=[];for(var a=0;a<t.children.length;a++)(n=t.children[a].innerText.replace("\n",""))&&e.push(r.getValue(a));n=e.join(",")}return n},r.setValue=function(e){e?t.value!=e&&(Array.isArray(e)||(e=(""+e).trim(),e=p(e),t.innerHTML=""),r.add(e)):r.reset()},r.reset=function(){t.classList.add("jtags-empty"),t.innerHTML="<div></div>",u()},r.isValid=function(){for(var e=0,n=0;n<t.children.length;n++)t.children[n].classList.contains("jtags_error")&&e++;return 0==e},r.selectIndex=function(t,n){var o=e.getNode();o&&(o.innerText=t,n&&o.setAttribute("data-value",n),o.classList.remove("jtags_error"),a()||r.add("",!0))},r.search=function(e){},r.destroy=function(){t.removeEventListener("mouseup",v),t.removeEventListener("keydown",h),t.removeEventListener("keyup",m),t.removeEventListener("paste",g),t.removeEventListener("focus",w),t.removeEventListener("blur",y),t.parentNode.removeChild(t)};var s=function(e){var t=document.createRange(),n=window.getSelection();t.setStart(e,e.innerText.length||0),t.collapse(!0),n.removeAllRanges(),n.addRange(t),e.scrollLeft=e.scrollWidth},l=function(e,n,r){var a=document.createElement("div");return a.innerHTML=e||"",n&&a.setAttribute("data-value",n),r&&r.parentNode.classList.contains("jtags")?t.insertBefore(a,r.nextSibling):t.appendChild(a),a},u=function(){var e=r.getValue();e!=r.options.value&&(r.options.value=e,"function"==typeof r.options.onchange&&r.options.onchange(t,r,r.options.value),t.value!=r.options.value&&(t.value=r.options.value,"function"==typeof t.onchange)&&t.onchange({type:"change",target:t,value:t.value})),c()},c=function(){for(var e=0;e<t.children.length;e++)r.getValue(e)?(t.children[e].classList.add("jtags_label"),"function"==typeof r.options.validation&&r.getValue(e)?r.options.validation(t.children[e],t.children[e].innerText,t.children[e].getAttribute("data-value"))?t.children[e].classList.remove("jtags_error"):t.children[e].classList.add("jtags_error"):t.children[e].classList.remove("jtags_error")):t.children[e].classList.remove("jtags_label");d()},d=function(){t.innerText.trim()?t.classList.remove("jtags-empty"):(t.innerHTML="<div></div>",t.classList.add("jtags-empty"))},p=function(e){var t=[],n="";if(e=e.trim()){for(var r=0;r<e.length;r++)","==e[r]||";"==e[r]||"\n"==e[r]?n&&(t.push(n.trim()),n=""):n+=e[r];n&&t.push(n)}return t},f=0,h=function(e){if(f=window.getSelection().anchorOffset,d(),"Tab"===e.key||";"===e.key||","===e.key){var n=window.getSelection().anchorOffset;1<n&&(a()||r.add("",!0)),e.preventDefault()}else"Enter"==e.key?o&&o.isOpened()||(n=window.getSelection().anchorOffset,1<n&&(a()||r.add("",!0)),e.preventDefault()):"Backspace"==e.key&&1==t.children.length&&1>window.getSelection().anchorOffset&&e.preventDefault();o&&o.keydown(e)},m=function(e){39==e.which?(e=window.getSelection().anchorOffset,1<e&&e==f&&r.add("",!0)):13==e.which||38==e.which||40==e.which?e.preventDefault():o&&o.keyup(e),c()},g=function(e){if(e.clipboardData||e.originalEvent.clipboardData)var t=(e.originalEvent||e).clipboardData.getData("text/plain");else window.clipboardData&&(t=window.clipboardData.getData("Text"));t=p(t),1<t.length&&(r.add(t,!0),e.preventDefault())},v=function(e){if(e.target.parentNode&&e.target.parentNode.classList.contains("jtags")&&(e.target.classList.contains("jtags_label")||e.target.classList.contains("jtags_error"))){var n=e.target.getBoundingClientRect();16>n.width-(e.clientX-n.left)&&r.remove(e.target)}e.target==t&&s(t.lastChild)},w=function(){t.classList.contains("jtags-focus")||(t.children.length&&!r.getValue(t.children.length-1)||a()||l(""),"function"==typeof r.options.onfocus&&r.options.onfocus(t,r,r.getValue()),t.classList.add("jtags-focus"))},y=function(){if(t.classList.contains("jtags-focus")){o&&o.close();for(var e=0;e<t.children.length-1;e++)r.getValue(e)||t.removeChild(t.children[e]);u(),t.classList.remove("jtags-focus"),"function"==typeof r.options.onblur&&r.options.onblur(t,r,r.getValue())}};return function(){!0==="touchend"in document.documentElement?t.addEventListener("touchend",v):t.addEventListener("mouseup",v),t.addEventListener("keydown",h),t.addEventListener("keyup",m),t.addEventListener("paste",g),t.addEventListener("focus",w),t.addEventListener("blur",y),t.setAttribute("contenteditable",!0),t.classList.add("jtags"),r.setOptions(n),"function"==typeof r.options.onload&&r.options.onload(t,r),t.change=r.setValue,t.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},t.tags=r}(),r},e.toolbar=function(t,n){var r,a={options:{}},o={app:null,container:!1,badge:!1,title:!1,responsive:!1,items:[]};for(r in o)n&&n.hasOwnProperty(r)?a.options[r]=n[r]:a.options[r]=o[r];!t&&n.app&&n.app.el&&(t=document.createElement("div"),n.app.el.appendChild(t));var i=document.createElement("div");i.classList.add("jtoolbar-item"),i.classList.add("jtoolbar-arrow");var s=document.createElement("div");s.classList.add("jtoolbar-floating"),i.appendChild(s),a.selectItem=function(e){for(var t=l.children,n=0;n<t.length;n++)e!=t[n]&&t[n].classList.remove("jtoolbar-selected");e.classList.add("jtoolbar-selected")},a.hide=function(){e.animation.slideBottom(t,0,(function(){t.style.display="none"}))},a.show=function(){t.style.display="",e.animation.slideBottom(t,1)},a.get=function(){return t},a.setBadge=function(e,t){l.children[e].children[1].firstChild.innerHTML=t},a.destroy=function(){toolbar.remove(),t.innerHTML=""},a.update=function(e,n){for(var r=0;r<l.children.length;r++){var o=l.children[r];"function"==typeof o.updateState&&o.updateState(t,a,o,e,n)}},a.create=function(n){l.innerHTML="";for(var r=0;r<n.length;r++){var o=document.createElement("div");if(o.classList.add("jtoolbar-item"),n[r].width&&(o.style.width=parseInt(n[r].width)+"px"),n[r].k&&(o.k=n[r].k),n[r].tooltip&&o.setAttribute("title",n[r].tooltip),n[r].id&&o.setAttribute("id",n[r].id),n[r].updateState&&(o.updateState=n[r].updateState),n[r].active&&o.classList.add("jtoolbar-active"),"select"==n[r].type||"dropdown"==n[r].type)e.picker(o,n[r]);else if("divisor"==n[r].type)o.classList.add("jtoolbar-divisor");else if("label"==n[r].type)o.classList.add("jtoolbar-label"),o.innerHTML=n[r].content;else{var i=document.createElement("i");if("undefined"===typeof n[r]["class"])i.classList.add("material-icons");else for(var s=n[r]["class"].split(" "),u=0;u<s.length;u++)i.classList.add(s[u]);i.innerHTML=n[r].content?n[r].content:"",o.appendChild(i),1==a.options.badge&&(i=document.createElement("div"),i.classList.add("jbadge"),s=document.createElement("div"),s.innerHTML=n[r].badge?n[r].badge:"",i.appendChild(s),o.appendChild(i)),n[r].title&&(1==a.options.title?(i=document.createElement("span"),i.innerHTML=n[r].title,o.appendChild(i)):o.setAttribute("title",n[r].title)),a.options.app&&n[r].route&&(o.route=n[r].route,o.onclick=function(){a.options.app.pages(this.route)},a.options.app.pages(n[r].route,{toolbarItem:o,closed:!0}))}n[r].onclick&&(o.onclick=n[r].onclick.bind(n[r],t,a,o)),l.appendChild(o)}a.refresh()},a.open=function(){i.classList.add("jtoolbar-arrow-selected"),s.getBoundingClientRect().bottom>window.innerHeight?s.style.bottom="0":s.style.removeProperty("bottom"),s.style.right="0",i.children[0].focus(),e.tracking(a,!0)},a.close=function(){i.classList.remove("jtoolbar-arrow-selected"),e.tracking(a,!1)},a.refresh=function(){if(1==a.options.responsive){for(i.remove();s.firstChild;)l.appendChild(s.firstChild);var e=t.parentNode.getBoundingClientRect().width;if(e<l.offsetWidth)for(e-=50;l.lastChild&&e<l.offsetWidth;)s.insertBefore(l.lastChild,s.firstChild);0<s.children.length&&l.appendChild(i)}},t.onclick=function(t){var n=e.findElement(t.target,"jtoolbar-item");n&&a.selectItem(n),t.target.classList.contains("jtoolbar-arrow")&&a.open()},window.addEventListener("resize",(function(){a.refresh()})),t.classList.add("jtoolbar"),t.innerHTML="",1==a.options.container&&t.classList.add("jtoolbar-container");var l=document.createElement("div");return t.appendChild(l),a.options.app&&t.classList.add("jtoolbar-mobile"),a.create(a.options.items),t.toolbar=a},e.validations=function(t,n){return"function"===typeof e.validations[n.type]?e.validations[n.type](t,n):null},e.validations.email=function(e){var t=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!(!e||!t.test(e))},e.validations.required=function(e){return!!e.trim()},e.validations.number=function(t){return e.isNumber(t)},e.validations.login=function(e){var t=new RegExp(/^[a-zA-Z0-9_\-\.\s+]+$/);return!(!e||!t.test(e))};var t=function(e,t){return"="===t.constraint?e===t.reference:"<"===t.constraint?e<t.reference:"<="===t.constraint?e<=t.reference:">"===t.constraint?e>t.reference:">="===t.constraint?e>=t.reference:"between"===t.constraint?e>=t.reference[0]&&e<=t.reference[1]:"not between"===t.constraint?e<t.reference[0]||e>t.reference[1]:null};return e.validations.number=function(n,r){return!!e.isNumeric(n)&&(void 0===r||void 0===r.constraint||t(n,r))},e.validations.date=function(e,n){return"Invalid Date"!=new Date(e)&&(void 0===n||void 0===n.constraint||("object"===typeof n?(e=new Date(e).getTime(),Array.isArray(n.reference)?n.reference=n.reference.map((function(e){return new Date(e).getTime()})):n.reference=new Date(n.reference).getTime(),t(e,n)):null))},e.validations.itemList=function(e,t){return t.reference.some((function(t){return t==e}))},e.validations.text=function(t,n){return"string"===typeof t&&(void 0===n||void 0===n.constraint||("="===n.constraint?t===n.reference:"contains"===n.constraint?t.includes(n.reference):"not contain"===n.constraint?!t.includes(n.reference):"email"===n.constraint?e.validations.email(t):"url"===n.constraint?!!new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(t):null))},e.validations.constraints=function(){},e}))},{}],3:[function(T,S,U){if(!r&&"function"===typeof T)var r=T("jsuites");if(!w&&"function"===typeof w)var w=T("@jspreadsheet/formula");(function(e,t){"object"===typeof U&&"undefined"!==typeof S?S.exports=t():e.jspreadsheet=e.jexcel=t()})(this,(function(){var k=function(){var e={title:"Jspreadsheet",version:"4.9.0",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join("\r\n")}};return function(){return e}}(),v=function(e){return e=(""+e)[0],"="==e||"#"==e},d=function(e){if(e.format||e.mask||e.locale){var t={};return e.mask?t.mask=e.mask:e.format?t.mask=e.format:(t.locale=e.locale,t.options=e.options),e.decimal&&(t.options||(t.options={}),t.options={decimal:e.decimal}),t}return null},n=function(q,y){var a={options:{}};if(!(q instanceof Element||q instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if("TABLE"==q.tagName){if(!(y=n.createFromTable(q,y)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var x=document.createElement("div");q.parentNode.insertBefore(x,q),q.remove(),q=x}for(var A in x={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0},x)if(y&&y.hasOwnProperty(A))if("text"===A)for(var H in a.options[A]=x[A],y[A])y[A].hasOwnProperty(H)&&(a.options[A][H]=y[A][H]);else a.options[A]=y[A];else a.options[A]=x[A];a.el=q,a.corner=null,a.contextMenu=null,a.textarea=null,a.ads=null,a.content=null,a.table=null,a.thead=null,a.tbody=null,a.rows=[],a.results=null,a.searchInput=null,a.toolbar=null,a.pagination=null,a.pageNumber=null,a.headerContainer=null,a.colgroupContainer=null,a.headers=[],a.records=[],a.history=[],a.formula=[],a.colgroup=[],a.selection=[],a.highlighted=[],a.selectedCell=null,a.selectedContainer=null,a.style=[],a.data=null,a.filter=null,a.filters=[],a.cursor=null,a.historyIndex=-1,a.ignoreEvents=!1,a.ignoreHistory=!1,a.edition=null,a.hashString=null,a.resizing=null,a.dragging=null,1==a.options.lazyLoading&&0==a.options.tableOverflow&&0==a.options.fullscreen&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),a.options.lazyLoading=!1),a.fullscreen=function(e){null==e&&(e=!a.options.fullscreen),a.options.fullscreen!=e&&(a.options.fullscreen=e,1==e?q.classList.add("fullscreen"):q.classList.remove("fullscreen"))},a.dispatch=function(e){if(!a.ignoreEvents){if("function"==typeof a.options.onevent)var t=a.options.onevent.apply(this,arguments);"function"==typeof a.options[e]&&(t=a.options[e].apply(this,Array.prototype.slice.call(arguments,1)))}if("onafterchanges"==e&&a.options.persistance){var n=1==a.options.persistance?a.options.url:a.options.persistance,r=a.prepareJson(arguments[2]);a.save(n,r)}return t},a.prepareTable=function(){var e=a.options.columns.length;if(a.options.data&&"undefined"!==typeof a.options.data[0]){var t=Object.keys(a.options.data[0]);t.length>e&&(e=t.length)}a.options.minDimensions[0]>e&&(e=a.options.minDimensions[0]);for(var n=[],o=0;o<e;o++)a.options.colHeaders[o]||(a.options.colHeaders[o]=""),a.options.colWidths[o]||(a.options.colWidths[o]=a.options.defaultColWidth),a.options.colAlignments[o]||(a.options.colAlignments[o]=a.options.defaultColAlign),a.options.columns[o]?a.options.columns[o].type||(a.options.columns[o].type="text"):a.options.columns[o]={type:"text"},a.options.columns[o].name||(a.options.columns[o].name=t&&t[o]?t[o]:o),a.options.columns[o].source||(a.options.columns[o].source=[]),a.options.columns[o].options||(a.options.columns[o].options=[]),a.options.columns[o].editor||(a.options.columns[o].editor=null),a.options.columns[o].allowEmpty||(a.options.columns[o].allowEmpty=!1),a.options.columns[o].title||(a.options.columns[o].title=a.options.colHeaders[o]?a.options.colHeaders[o]:""),a.options.columns[o].width||(a.options.columns[o].width=a.options.colWidths[o]?a.options.colWidths[o]:a.options.defaultColWidth),a.options.columns[o].align||(a.options.columns[o].align=a.options.colAlignments[o]?a.options.colAlignments[o]:"center"),"autocomplete"==a.options.columns[o].type||"dropdown"==a.options.columns[o].type?a.options.columns[o].url&&n.push({url:a.options.columns[o].url,index:o,method:"GET",dataType:"json",success:function(e){for(var t=0;t<e.length;t++)a.options.columns[this.index].source.push(e[t])}}):"calendar"!=a.options.columns[o].type||a.options.columns[o].options.format||(a.options.columns[o].options.format="DD/MM/YYYY");n.length?r.ajax(n,(function(){a.createTable()})):a.createTable()},a.createTable=function(){a.table=document.createElement("table"),a.thead=document.createElement("thead"),a.tbody=document.createElement("tbody"),a.headers=[],a.colgroup=[],a.content=document.createElement("div"),a.content.classList.add("jexcel_content"),a.content.onscroll=function(e){a.scrollControls(e)},a.content.onwheel=function(e){a.wheelControls(e)},a.toolbar=document.createElement("div"),a.toolbar.classList.add("jexcel_toolbar");var e=document.createElement("div"),t=document.createTextNode(a.options.text.search+": ");a.searchInput=document.createElement("input"),a.searchInput.classList.add("jexcel_search"),e.appendChild(t),e.appendChild(a.searchInput),a.searchInput.onfocus=function(){a.resetSelection()};var o=document.createElement("div");if(0<a.options.pagination&&a.options.paginationOptions&&0<a.options.paginationOptions.length){a.paginationDropdown=document.createElement("select"),a.paginationDropdown.classList.add("jexcel_pagination_dropdown"),a.paginationDropdown.onchange=function(){a.options.pagination=parseInt(this.value),a.page(0)};for(var i=0;i<a.options.paginationOptions.length;i++)t=document.createElement("option"),t.value=a.options.paginationOptions[i],t.innerHTML=a.options.paginationOptions[i],a.paginationDropdown.appendChild(t);a.paginationDropdown.value=a.options.pagination,o.appendChild(document.createTextNode(a.options.text.show)),o.appendChild(a.paginationDropdown),o.appendChild(document.createTextNode(a.options.text.entries))}if(t=document.createElement("div"),t.classList.add("jexcel_filter"),t.appendChild(o),t.appendChild(e),a.colgroupContainer=document.createElement("colgroup"),i=document.createElement("col"),i.setAttribute("width","50"),a.colgroupContainer.appendChild(i),a.options.nestedHeaders&&0<a.options.nestedHeaders.length)if(a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(i=0;i<a.options.nestedHeaders.length;i++)a.thead.appendChild(a.createNestedHeader(a.options.nestedHeaders[i]));else a.thead.appendChild(a.createNestedHeader(a.options.nestedHeaders));for(a.headerContainer=document.createElement("tr"),i=document.createElement("td"),i.classList.add("jexcel_selectall"),a.headerContainer.appendChild(i),i=0;i<a.options.columns.length;i++)a.createCellHeader(i),a.headerContainer.appendChild(a.headers[i]),a.colgroupContainer.appendChild(a.colgroup[i]);if(a.thead.appendChild(a.headerContainer),1==a.options.filters){for(a.filter=document.createElement("tr"),e=document.createElement("td"),a.filter.appendChild(e),i=0;i<a.options.columns.length;i++)e=document.createElement("td"),e.innerHTML="&nbsp;",e.setAttribute("data-x",i),e.className="jexcel_column_filter","hidden"==a.options.columns[i].type&&(e.style.display="none"),a.filter.appendChild(e);a.thead.appendChild(a.filter)}a.table=document.createElement("table"),a.table.classList.add("jexcel"),a.table.setAttribute("cellpadding","0"),a.table.setAttribute("cellspacing","0"),a.table.setAttribute("unselectable","yes"),a.table.appendChild(a.colgroupContainer),a.table.appendChild(a.thead),a.table.appendChild(a.tbody),a.options.textOverflow||a.table.classList.add("jexcel_overflow"),a.corner=document.createElement("div"),a.corner.className="jexcel_corner",a.corner.setAttribute("unselectable","on"),a.corner.setAttribute("onselectstart","return false"),0==a.options.selectionCopy&&(a.corner.style.display="none"),a.textarea=document.createElement("textarea"),a.textarea.className="jexcel_textarea",a.textarea.id="jexcel_textarea",a.textarea.tabIndex="-1",a.contextMenu=document.createElement("div"),a.contextMenu.className="jexcel_contextmenu",r.contextmenu(a.contextMenu,{onclick:function(){a.contextMenu.contextmenu.close(!1)}}),i=document.createElement("a"),i.setAttribute("href","https://bossanova.uk/jspreadsheet/"),a.ads=document.createElement("div"),a.ads.className="jexcel_about";try{if("undefined"!==typeof sessionStorage&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var s=document.createElement("img");s.src="//bossanova.uk/jspreadsheet/logo.png",i.appendChild(s)}}catch(l){}if(s=document.createElement("span"),s.innerHTML="Jspreadsheet CE",i.appendChild(s),a.ads.appendChild(i),document.createElement("div").classList.add("jexcel_table"),a.pagination=document.createElement("div"),a.pagination.classList.add("jexcel_pagination"),s=document.createElement("div"),i=document.createElement("div"),a.pagination.appendChild(s),a.pagination.appendChild(i),a.options.pagination||(a.pagination.style.display="none"),1==a.options.search&&q.appendChild(t),a.content.appendChild(a.table),a.content.appendChild(a.corner),a.content.appendChild(a.textarea),q.appendChild(a.toolbar),q.appendChild(a.content),q.appendChild(a.pagination),q.appendChild(a.contextMenu),q.appendChild(a.ads),q.classList.add("jexcel_container"),a.options.toolbar&&a.options.toolbar.length&&a.createToolbar(),1==a.options.fullscreen?q.classList.add("fullscreen"):1==a.options.tableOverflow&&(a.options.tableHeight&&(a.content.style["overflow-y"]="auto",a.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",a.content.style.maxHeight=a.options.tableHeight),a.options.tableWidth&&(a.content.style["overflow-x"]="auto",a.content.style.width=a.options.tableWidth)),1!=a.options.tableOverflow&&a.options.toolbar&&q.classList.add("with-toolbar"),1==a.options.columnDrag&&a.thead.classList.add("draggable"),1==a.options.columnResize&&a.thead.classList.add("resizable"),1==a.options.rowDrag&&a.tbody.classList.add("draggable"),1==a.options.rowResize&&a.tbody.classList.add("resizable"),a.setData(),a.options.style&&a.setStyle(a.options.style,null,null,1,1),a.options.classes)for(t=Object.keys(a.options.classes),i=0;i<t.length;i++)s=n.getIdFromColumnName(t[i],!0),a.records[s[1]][s[0]].classList.add(a.options.classes[t[i]])},a.refresh=function(){a.options.url?(1==a.options.loadingSpin&&r.loading.show(),r.ajax({url:a.options.url,method:a.options.method,data:a.options.requestVariables,dataType:"json",success:function(e){a.options.data=e.data?e.data:e,a.setData(),1==a.options.loadingSpin&&r.loading.hide()}})):a.setData()},a.setData=function(e){if(e&&("string"==typeof e&&(e=JSON.parse(e)),a.options.data=e),a.options.data||(a.options.data=[]),a.options.data&&a.options.data[0]&&!Array.isArray(a.options.data[0])){e=[];for(var t=0;t<a.options.data.length;t++){for(var n=[],r=0;r<a.options.columns.length;r++)n[r]=a.options.data[t][a.options.columns[r].name];e.push(n)}a.options.data=e}for(e=a.options.columns.length,t=a.options.data.length,n=a.options.minDimensions[0],r=a.options.minDimensions[1],e=n>e?n:e,n=r>t?r:t,t=0;t<n;t++)for(r=0;r<e;r++)void 0==a.options.data[t]&&(a.options.data[t]=[]),void 0==a.options.data[t][r]&&(a.options.data[t][r]="");for(a.rows=[],a.results=null,a.records=[],a.history=[],a.historyIndex=-1,a.tbody.innerHTML="",1==a.options.lazyLoading?(r=0,e=100>a.options.data.length?a.options.data.length:100,a.options.pagination&&(a.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))):a.options.pagination?(a.pageNumber||(a.pageNumber=0),r=a.options.pagination*a.pageNumber,e=a.options.pagination*a.pageNumber+a.options.pagination,a.options.data.length<e&&(e=a.options.data.length)):(r=0,e=a.options.data.length),t=0;t<a.options.data.length;t++)n=a.createRow(t,a.options.data[t]),t>=r&&t<e&&a.tbody.appendChild(n);if(1!=a.options.lazyLoading&&a.options.pagination&&a.updatePagination(),a.options.mergeCells)for(t=Object.keys(a.options.mergeCells),r=0;r<t.length;r++)e=a.options.mergeCells[t[r]],a.setMerge(t[r],e[0],e[1],1);a.updateTable(),a.dispatch("onload",q,a)},a.getData=function(e,t){for(var n,r=[],o=0,i=1==t||0==a.options.copyCompatibility,s=a.options.columns.length,l=a.options.data.length,u=0;u<l;u++){for(var c=n=0;c<s;c++)e&&!a.records[u][c].classList.contains("highlight")||(r[o]||(r[o]=[]),r[o][n]=i?a.options.data[u][c]:a.records[u][c].innerHTML,n++);0<n&&o++}return r},a.getJsonRow=function(e){e=a.options.data[e];for(var t=a.options.columns.length,n={},r=0;r<t;r++)a.options.columns[r].name||(a.options.columns[r].name=r),n[a.options.columns[r].name]=e[r];return n},a.getJson=function(e){for(var t=[],n=a.options.columns.length,r=a.options.data.length,o=0;o<r;o++){for(var i=null,s=0;s<n;s++)e&&!a.records[o][s].classList.contains("highlight")||(null==i&&(i={}),a.options.columns[s].name||(a.options.columns[s].name=s),i[a.options.columns[s].name]=a.options.data[o][s]);null!=i&&t.push(i)}return t},a.prepareJson=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n].x,o=e[n].y;r=a.options.columns[r].name?a.options.columns[r].name:r,t[o]||(t[o]={row:o,data:{}}),t[o].data[r]=e[n].newValue}return t.filter((function(e){return null!=e}))},a.save=function(e,t){var n=a.dispatch("onbeforesave",q,a,t);if(n)t=n;else if(!1===n)return!1;r.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(t)},success:function(e){a.dispatch("onsave",q,a,t)}})},a.getRowData=function(e){return a.options.data[e]},a.setRowData=function(e,t){for(var r=0;r<a.headers.length;r++){var o=n.getColumnNameFromId([r,e]);null!=t[r]&&a.setValue(o,t[r])}},a.getColumnData=function(e){for(var t=[],n=0;n<a.options.data.length;n++)t.push(a.options.data[n][e]);return t},a.setColumnData=function(e,t){for(var r=0;r<a.rows.length;r++){var o=n.getColumnNameFromId([e,r]);null!=t[r]&&a.setValue(o,t[r])}},a.createRow=function(e,t){a.records[e]||(a.records[e]=[]),t||(t=a.options.data[e]),a.rows[e]=document.createElement("tr"),a.rows[e].setAttribute("data-y",e);var n=null;a.options.defaultRowHeight&&(a.rows[e].style.height=a.options.defaultRowHeight+"px"),a.options.rows[e]&&(a.options.rows[e].height&&(a.rows[e].style.height=a.options.rows[e].height),a.options.rows[e].title&&(n=a.options.rows[e].title)),n||(n=parseInt(e+1));var r=document.createElement("td");for(r.innerHTML=n,r.setAttribute("data-y",e),r.className="jexcel_row",a.rows[e].appendChild(r),n=0;n<a.options.columns.length;n++)a.records[e][n]=a.createCell(n,e,t[n]),a.rows[e].appendChild(a.records[e][n]);return a.rows[e]},a.parseValue=function(e,t,n,o){return"="==(""+n).substr(0,1)&&1==a.options.parseFormulas&&(n=a.executeFormula(n,e,t)),(e=a.options.columns[e])&&!v(n)&&(t=d(e))&&(n&&n==Number(n)&&(n=Number(n)),e=r.mask.render(n,t,!0),o&&t.mask&&(t=t.mask.split(";"),t[1]&&(t[1].match(RegExp("\\[Red\\]","gi"))&&(0>n?o.classList.add("red"):o.classList.remove("red")),t[1].match(RegExp("\\(","gi"))&&0>n&&(e="("+e+")"))),e&&(n=e)),n},a.createCell=function(e,t,n){var o=document.createElement("td");if(o.setAttribute("data-x",e),o.setAttribute("data-y",t),"="==(""+n).substr(0,1)&&1==a.options.secureFormulas){var i=h(n);i!=n&&(n=i)}return a.options.columns[e].editor?(!1===a.options.stripHTML||!1===a.options.columns[e].stripHTML?o.innerHTML=n:o.innerText=n,"function"==typeof a.options.columns[e].editor.createCell&&(o=a.options.columns[e].editor.createCell(o))):"hidden"==a.options.columns[e].type?(o.style.display="none",o.innerText=n):"checkbox"==a.options.columns[e].type||"radio"==a.options.columns[e].type?(i=document.createElement("input"),i.type=a.options.columns[e].type,i.name="c"+e,i.checked=1==n||1==n||"true"==n,i.onclick=function(){a.setValue(o,this.checked)},1!=a.options.columns[e].readOnly&&0!=a.options.editable||i.setAttribute("disabled","disabled"),o.appendChild(i),a.options.data[t][e]=i.checked):"calendar"==a.options.columns[e].type?(i=r.calendar.extractDateFromString(n,a.options.columns[e].options.format),o.innerText=r.calendar.getDateString(i||n,a.options.columns[e].options.format)):"dropdown"==a.options.columns[e].type||"autocomplete"==a.options.columns[e].type?(o.classList.add("jexcel_dropdown"),o.innerText=a.getDropDownValue(e,n)):"color"==a.options.columns[e].type?"square"==a.options.columns[e].render?(i=document.createElement("div"),i.className="color",i.style.backgroundColor=n,o.appendChild(i)):(o.style.color=n,o.innerText=n):"image"==a.options.columns[e].type?n&&"data:image"==n.substr(0,10)&&(i=document.createElement("img"),i.src=n,o.appendChild(i)):"html"==a.options.columns[e].type||!1===a.options.stripHTML||!1===a.options.columns[e].stripHTML?o.innerHTML=B(a.parseValue(e,t,n,o)):o.innerText=a.parseValue(e,t,n,o),1==a.options.columns[e].readOnly&&(o.className="readonly"),o.style.textAlign=a.options.columns[e].align?a.options.columns[e].align:"center",0!=a.options.columns[e].wordWrap&&(1==a.options.wordWrap||1==a.options.columns[e].wordWrap||200<o.innerHTML.length)&&(o.style.whiteSpace="pre-wrap"),0<e&&1==this.options.textOverflow&&(n||o.innerHTML?a.records[t][e-1].style.overflow="hidden":e==a.options.columns.length-1&&(o.style.overflow="hidden")),o},a.createCellHeader=function(e){var t=a.options.columns[e].width?a.options.columns[e].width:a.options.defaultColWidth,r=a.options.columns[e].align?a.options.columns[e].align:a.options.defaultColAlign;a.headers[e]=document.createElement("td"),a.options.stripHTML?a.headers[e].innerText=a.options.columns[e].title?a.options.columns[e].title:n.getColumnName(e):a.headers[e].innerHTML=a.options.columns[e].title?a.options.columns[e].title:n.getColumnName(e),a.headers[e].setAttribute("data-x",e),a.headers[e].style.textAlign=r,a.options.columns[e].title&&a.headers[e].setAttribute("title",a.options.columns[e].title),a.options.columns[e].id&&a.headers[e].setAttribute("id",a.options.columns[e].id),a.colgroup[e]=document.createElement("col"),a.colgroup[e].setAttribute("width",t),"hidden"==a.options.columns[e].type&&(a.headers[e].style.display="none",a.colgroup[e].style.display="none")},a.updateNestedHeader=function(e,t,n){a.options.nestedHeaders[t][e].title&&(a.options.nestedHeaders[t][e].title=n,a.options.nestedHeaders[t].element.children[e+1].innerText=n)},a.createNestedHeader=function(e){var t=document.createElement("tr");t.classList.add("jexcel_nested");var n=document.createElement("td");t.appendChild(n),e.element=t;for(var r=0,o=0;o<e.length;o++){e[o].colspan||(e[o].colspan=1),e[o].align||(e[o].align="center"),e[o].title||(e[o].title=""),n=e[o].colspan;for(var i=[],s=0;s<n;s++)a.options.columns[r]&&"hidden"==a.options.columns[r].type&&n++,i.push(r),r++;n=document.createElement("td"),n.setAttribute("data-column",i.join(",")),n.setAttribute("colspan",e[o].colspan),n.setAttribute("align",e[o].align),n.innerText=e[o].title,t.appendChild(n)}return t},a.createToolbar=function(e){e?a.options.toolbar=e:e=a.options.toolbar;for(var t=0;t<e.length;t++)if("i"==e[t].type){var n=document.createElement("i");n.classList.add("jexcel_toolbar_item"),n.classList.add("material-icons"),n.setAttribute("data-k",e[t].k),n.setAttribute("data-v",e[t].v),n.setAttribute("id",e[t].id),e[t].tooltip&&n.setAttribute("title",e[t].tooltip),n.onclick=e[t].onclick&&(e[t].onclick,1)?function(t){return function(){e[t].onclick(q,a,this)}}(t):function(){var e=this.getAttribute("data-k"),t=this.getAttribute("data-v");a.setStyle(a.highlighted,e,t)},n.innerText=e[t].content,a.toolbar.appendChild(n)}else if("select"==e[t].type){n=document.createElement("select"),n.classList.add("jexcel_toolbar_item"),n.setAttribute("data-k",e[t].k),e[t].tooltip&&n.setAttribute("title",e[t].tooltip),n.onchange=e[t].onchange&&(e[t].onchange,1)?e[t].onchange:function(){var e=this.getAttribute("data-k");a.setStyle(a.highlighted,e,this.value)};for(var o=0;o<e[t].v.length;o++){var i=document.createElement("option");i.value=e[t].v[o],i.innerText=e[t].v[o],n.appendChild(i)}a.toolbar.appendChild(n)}else"color"==e[t].type&&(n=document.createElement("i"),n.classList.add("jexcel_toolbar_item"),n.classList.add("material-icons"),n.setAttribute("data-k",e[t].k),n.setAttribute("data-v",""),e[t].tooltip&&n.setAttribute("title",e[t].tooltip),a.toolbar.appendChild(n),n.innerText=e[t].content,r.color(n,{onchange:function(e,t){var n=e.getAttribute("data-k");a.setStyle(a.highlighted,n,t)}}))},a.setMerge=function(e,t,r,o){var i=!1;if(!e){if(!a.highlighted.length)return alert(a.options.text.noCellsSelected),null;t=parseInt(a.highlighted[0].getAttribute("data-x")),r=parseInt(a.highlighted[0].getAttribute("data-y"));var s=parseInt(a.highlighted[a.highlighted.length-1].getAttribute("data-x")),l=parseInt(a.highlighted[a.highlighted.length-1].getAttribute("data-y"));e=n.getColumnNameFromId([t,r]),t=s-t+1,r=l-r+1}if(l=n.getIdFromColumnName(e,!0),a.options.mergeCells[e])a.records[l[1]][l[0]].getAttribute("data-merged")&&(i=a.options.text.cellAlreadyMerged);else if((!t||2>t)&&(!r||2>r))i=a.options.text.invalidMergeProperties;else for(s=l[1];s<l[1]+r;s++)for(var u=l[0];u<l[0]+t;u++)n.getColumnNameFromId([u,s]),a.records[s][u].getAttribute("data-merged")&&(i=a.options.text.thereIsAConflictWithAnotherMergedCell);if(i)alert(i);else{for(1<t?a.records[l[1]][l[0]].setAttribute("colspan",t):t=1,1<r?a.records[l[1]][l[0]].setAttribute("rowspan",r):r=1,a.options.mergeCells[e]=[t,r,[]],a.records[l[1]][l[0]].setAttribute("data-merged","true"),a.records[l[1]][l[0]].style.overflow="hidden",i=[],s=l[1];s<l[1]+r;s++)for(u=l[0];u<l[0]+t;u++)l[0]==u&&l[1]==s||(i.push(a.options.data[s][u]),a.updateCell(u,s,"",!0),a.options.mergeCells[e][2].push(a.records[s][u]),a.records[s][u].style.display="none",a.records[s][u]=a.records[l[1]][l[0]]);a.updateSelection(a.records[l[1]][l[0]]),o||(a.setHistory({action:"setMerge",column:e,colspan:t,rowspan:r,data:i}),a.dispatch("onmerge",q,e,t,r))}},a.getMerge=function(e){var t={};if(e)t=a.options.mergeCells[e]?[a.options.mergeCells[e][0],a.options.mergeCells[e][1]]:null;else if(a.options.mergeCells){e=Object.keys(a.options.mergeCells);for(var n=0;n<e.length;n++)t[e[n]]=[a.options.mergeCells[e[n]][0],a.options.mergeCells[e[n]][1]]}return t},a.removeMerge=function(e,t,r){if(a.options.mergeCells[e]){var o=n.getIdFromColumnName(e,!0);a.records[o[1]][o[0]].removeAttribute("colspan"),a.records[o[1]][o[0]].removeAttribute("rowspan"),a.records[o[1]][o[0]].removeAttribute("data-merged");for(var i=a.options.mergeCells[e],s=0,l=0;l<i[1];l++)for(var u=0;u<i[0];u++)(0<l||0<u)&&(a.records[o[1]+l][o[0]+u]=i[2][s],a.records[o[1]+l][o[0]+u].style.display="",t&&t[s]&&a.updateCell(o[0]+u,o[1]+l,t[s]),s++);a.updateSelection(a.records[o[1]][o[0]],a.records[o[1]+l-1][o[0]+u-1]),r||delete a.options.mergeCells[e]}},a.destroyMerged=function(e){if(a.options.mergeCells)for(var t=Object.keys(a.options.mergeCells),n=0;n<t.length;n++)a.removeMerge(t[n],null,e)},a.isColMerged=function(e,t){var r=[];if(a.options.mergeCells)for(var o=Object.keys(a.options.mergeCells),i=0;i<o.length;i++){var s=n.getIdFromColumnName(o[i],!0),l=a.options.mergeCells[o[i]][0],u=s[0];s=s[0]+(1<l?l-1:0),null==t?u<=e&&s>=e&&r.push(o[i]):t?u<e&&s>=e&&r.push(o[i]):u<=e&&s>e&&r.push(o[i])}return r},a.isRowMerged=function(e,t){var r=[];if(a.options.mergeCells)for(var o=Object.keys(a.options.mergeCells),i=0;i<o.length;i++){var s=n.getIdFromColumnName(o[i],!0),l=a.options.mergeCells[o[i]][1],u=s[1];s=s[1]+(1<l?l-1:0),null==t?u<=e&&s>=e&&r.push(o[i]):t?u<e&&s>=e&&r.push(o[i]):u<=e&&s>e&&r.push(o[i])}return r},a.openFilter=function(e){if(a.options.filters){e=parseInt(e),a.resetSelection();var t=[];if("checkbox"==a.options.columns[e].type)t.push({id:"true",name:"True"}),t.push({id:"false",name:"False"});else{for(var n=[],o=!1,i=0;i<a.options.data.length;i++){t=a.options.data[i][e];var s=a.records[i][e].innerHTML;t&&s?n[t]=s:o=!0}for(s=Object.keys(n),t=[],i=0;i<s.length;i++)t.push({id:s[i],name:n[s[i]]});o&&t.push({value:"",id:"",name:"(Blanks)"})}n=document.createElement("div"),a.filter.children[e+1].innerHTML="",a.filter.children[e+1].appendChild(n),a.filter.children[e+1].style.paddingLeft="0px",a.filter.children[e+1].style.paddingRight="0px",a.filter.children[e+1].style.overflow="initial",r.dropdown(n,{data:t,multiple:!0,autocomplete:!0,opened:!0,value:void 0!==a.filters[e]?a.filters[e]:null,width:"100%",position:1==a.options.tableOverflow||1==a.options.fullscreen,onclose:function(t){a.resetFilters(),a.filters[e]=t.dropdown.getValue(!0),a.filter.children[e+1].innerHTML=t.dropdown.getText(),a.filter.children[e+1].style.paddingLeft="",a.filter.children[e+1].style.paddingRight="",a.filter.children[e+1].style.overflow="",a.closeFilter(e),a.refreshSelection()}})}else console.log("Jspreadsheet: filters not enabled.")},a.resetFilters=function(){if(a.options.filters)for(var e=0;e<a.filter.children.length;e++)a.filter.children[e].innerHTML="&nbsp;",a.filters[e]=null},a.closeFilter=function(e){if(!e)for(var t=0;t<a.filter.children.length;t++)a.filters[t]&&(e=t);t=a.filters[e],a.results=[];for(var n=0;n<a.options.data.length;n++){e:{for(var r=t,o=e,i=n,s=0;s<r.length;s++)if(""==r[s]&&(!1===a.options.data[i][o]||""==""+a.options.data[i][o])||""!=r[s]&&(0<=(""+a.options.data[i][o]).search(r[s])||0<=(""+a.records[i][o].innerHTML).search(r[s]))){r=!0;break e}r=!1}r&&a.results.push(n)}a.results.length||(a.results=null),a.updateResult()},a.openEditor=function(e,t,n){var o=e.getAttribute("data-y"),i=e.getAttribute("data-x");a.dispatch("oneditionstart",q,e,i,o),0<i&&(a.records[o][i-1].style.overflow="hidden");var s=function(t){var n=e.getBoundingClientRect();return t=document.createElement(t),t.style.width=n.width+"px",t.style.height=n.height-2+"px",t.style.minHeight=n.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(t),a.dispatch("oncreateeditor",q,e,i,o,t),t};if(1!=e.classList.contains("readonly"))if(a.edition=[a.records[o][i],a.records[o][i].innerHTML,i,o],a.options.columns[i].editor)a.options.columns[i].editor.openEditor(e,q,t,n);else if("hidden"!=a.options.columns[i].type)if("checkbox"==a.options.columns[i].type||"radio"==a.options.columns[i].type)t=!e.children[0].checked,a.setValue(e,t),a.edition=null;else if("dropdown"==a.options.columns[i].type||"autocomplete"==a.options.columns[i].type){t=a.options.data[o][i],a.options.columns[i].multiple&&!Array.isArray(t)&&(t=t.split(";"));var l="function"==typeof a.options.columns[i].filter?a.options.columns[i].filter(q,e,i,o,a.options.columns[i].source):a.options.columns[i].source;n=[];for(var u=0;u<l.length;u++)n.push(l[u]);s=s("div"),l={data:n,multiple:!!a.options.columns[i].multiple,autocomplete:!(!a.options.columns[i].autocomplete&&"autocomplete"!=a.options.columns[i].type),opened:!0,value:t,width:"100%",height:s.style.minHeight,position:1==a.options.tableOverflow||1==a.options.fullscreen,onclose:function(){a.closeEditor(e,!0)}},a.options.columns[i].options&&a.options.columns[i].options.type&&(l.type=a.options.columns[i].options.type),r.dropdown(s,l)}else"calendar"==a.options.columns[i].type||"color"==a.options.columns[i].type?(t=a.options.data[o][i],s=s("input"),s.value=t,1!=a.options.tableOverflow&&1!=a.options.fullscreen||(a.options.columns[i].options.position=!0),a.options.columns[i].options.value=a.options.data[o][i],a.options.columns[i].options.opened=!0,a.options.columns[i].options.onclose=function(t,n){a.closeEditor(e,!0)},"color"==a.options.columns[i].type?r.color(s,a.options.columns[i].options):r.calendar(s,a.options.columns[i].options),s.focus()):"html"==a.options.columns[i].type?(t=a.options.data[o][i],s=s("div"),s.style.position="relative",n=document.createElement("div"),n.classList.add("jexcel_richtext"),s.appendChild(n),r.editor(n,{focus:!0,value:t}),t=e.getBoundingClientRect(),s=n.getBoundingClientRect(),n.style.top=window.innerHeight<t.bottom+s.height?t.top-(s.height+2)+"px":t.top+"px"):"image"==a.options.columns[i].type?(t=e.children[0],s=s("div"),s.style.position="relative",n=document.createElement("div"),n.classList.add("jclose"),t&&t.src&&n.appendChild(t),s.appendChild(n),r.image(n,a.options.imageOptions),t=e.getBoundingClientRect(),s=n.getBoundingClientRect(),n.style.top=window.innerHeight<t.bottom+s.height?t.top-(s.height+2)+"px":t.top+"px"):(t=1==t?"":a.options.data[o][i],s=0==a.options.columns[i].wordWrap||1!=a.options.wordWrap&&1!=a.options.columns[i].wordWrap?s("input"):s("textarea"),s.focus(),s.value=t,l=a.options.columns[i],n=null,!v(t)&&(n=d(l))&&(l.disabledMaskOnEdition||(l.mask?(l=l.mask.split(";"),s.setAttribute("data-mask",l[0])):l.locale&&s.setAttribute("data-locale",l.locale)),n.input=s,s.mask=n,r.mask.render(t,n,!1)),s.onblur=function(){a.closeEditor(e,!0)},s.scrollLeft=s.scrollWidth)},a.closeEditor=function(e,t){var n=parseInt(e.getAttribute("data-x")),o=parseInt(e.getAttribute("data-y"));if(1==t){if(a.options.columns[n].editor)var i=a.options.columns[n].editor.closeEditor(e,t);else if("checkbox"!=a.options.columns[n].type&&"radio"!=a.options.columns[n].type&&"hidden"!=a.options.columns[n].type)if("dropdown"==a.options.columns[n].type||"autocomplete"==a.options.columns[n].type)i=e.children[0].dropdown.close(!0);else if("calendar"==a.options.columns[n].type)i=e.children[0].calendar.close(!0);else if("color"==a.options.columns[n].type)i=e.children[0].color.close(!0);else if("html"==a.options.columns[n].type)i=e.children[0].children[0].editor.getData();else if("image"==a.options.columns[n].type)i=(i=e.children[0].children[0].children[0])&&"IMG"==i.tagName?i.src:"";else if("numeric"==a.options.columns[n].type)i=e.children[0].value,"="!=i.substr(0,1)&&""==i&&(i=a.options.columns[n].allowEmpty?"":0),e.children[0].onblur=null;else{var s;i=e.children[0].value,e.children[0].onblur=null,(s=d(a.options.columns[n]))&&""!==i&&!v(i)&&"number"!==typeof i&&(s=r.mask.extract(i,s,!0))&&""!==s.value&&(i=s.value)}a.options.data[o][n]==i?e.innerHTML=a.edition[1]:a.setValue(e,i)}else a.options.columns[n].editor?a.options.columns[n].editor.closeEditor(e,t):"dropdown"==a.options.columns[n].type||"autocomplete"==a.options.columns[n].type?e.children[0].dropdown.close(!0):"calendar"==a.options.columns[n].type?e.children[0].calendar.close(!0):"color"==a.options.columns[n].type?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=a.edition&&a.edition[1]?a.edition[1]:"";a.dispatch("oneditionend",q,e,n,o,i,t),e.classList.remove("editor"),a.edition=null},a.getCell=function(e){return e=n.getIdFromColumnName(e,!0),a.records[e[1]][e[0]]},a.getCellFromCoords=function(e,t){return a.records[t][e]},a.getLabel=function(e){return e=n.getIdFromColumnName(e,!0),a.records[e[1]][e[0]].innerHTML},a.getLabelFromCoords=function(e,t){return a.records[t][e].innerHTML},a.getValue=function(e,t){if("object"==typeof e)var r=e.getAttribute("data-x"),o=e.getAttribute("data-y");else e=n.getIdFromColumnName(e,!0),r=e[0],o=e[1];var i=null;return null!=r&&null!=o&&(a.records[o]&&a.records[o][r]&&(t||1==a.options.copyCompatibility)?i=a.records[o][r].innerHTML:a.options.data[o]&&"undefined"!=a.options.data[o][r]&&(i=a.options.data[o][r])),i},a.getValueFromCoords=function(e,t,n){var r=null;return null!=e&&null!=t&&(a.records[t]&&a.records[t][e]&&n||1==a.options.copyCompatibility?r=a.records[t][e].innerHTML:a.options.data[t]&&"undefined"!=a.options.data[t][e]&&(r=a.options.data[t][e])),r},a.setValue=function(e,t,r){var o=[];if("string"==typeof e){var i=n.getIdFromColumnName(e,!0),s=i[0];i=i[1],o.push(a.updateCell(s,i,t,r)),a.updateFormulaChain(s,i,o)}else if(i=s=null,e&&e.getAttribute&&(s=e.getAttribute("data-x"),i=e.getAttribute("data-y")),null!=s&&null!=i)o.push(a.updateCell(s,i,t,r)),a.updateFormulaChain(s,i,o);else{var l=Object.keys(e);if(0<l.length)for(var u=0;u<l.length;u++)"string"==typeof e[u]?(i=n.getIdFromColumnName(e[u],!0),s=i[0],i=i[1]):null!=e[u].x&&null!=e[u].y?(s=e[u].x,i=e[u].y,null!=e[u].newValue?t=e[u].newValue:null!=e[u].value&&(t=e[u].value)):(s=e[u].getAttribute("data-x"),i=e[u].getAttribute("data-y")),null!=s&&null!=i&&(o.push(a.updateCell(s,i,t,r)),a.updateFormulaChain(s,i,o))}a.setHistory({action:"setValue",records:o,selection:a.selectedCell}),a.updateTable(),a.onafterchanges(q,o)},a.setValueFromCoords=function(e,t,n,r){var o=[];o.push(a.updateCell(e,t,n,r)),a.updateFormulaChain(e,t,o),a.setHistory({action:"setValue",records:o,selection:a.selectedCell}),a.updateTable(),a.onafterchanges(q,o)},a.setCheckRadioValue=function(){for(var e=[],t=Object.keys(a.highlighted),n=0;n<t.length;n++){var r=a.highlighted[n].getAttribute("data-x"),o=a.highlighted[n].getAttribute("data-y");"checkbox"!=a.options.columns[r].type&&"radio"!=a.options.columns[r].type||e.push(a.updateCell(r,o,!a.options.data[o][r]))}e.length&&(a.setHistory({action:"setValue",records:e,selection:a.selectedCell}),a.onafterchanges(q,e))};var B=function(e){var t,n=new Option;for(n.innerHTML=e,e=n.getElementsByTagName("script");t=e[0];)t.parentNode.removeChild(t);return n.innerHTML};a.updateCell=function(e,t,n,o){if(1!=a.records[t][e].classList.contains("readonly")||o){if("="==(""+n).substr(0,1)&&1==a.options.secureFormulas){var i=h(n);i!=n&&(n=i)}if(i=a.dispatch("onbeforechange",q,a.records[t][e],e,t,n),void 0!=i&&(n=i),a.options.columns[e].editor&&"function"==typeof a.options.columns[e].editor.updateCell&&(n=a.options.columns[e].editor.updateCell(a.records[t][e],n,o)),o={x:e,y:t,col:e,row:t,newValue:n,oldValue:a.options.data[t][e]},a.options.columns[e].editor)a.options.data[t][e]=n;else if("checkbox"==a.options.columns[e].type||"radio"==a.options.columns[e].type){if("radio"==a.options.columns[e].type)for(i=0;i<a.options.data.length;i++)a.options.data[i][e]=!1;a.records[t][e].children[0].checked=1==n||1==n||"true"==n||"TRUE"==n,a.options.data[t][e]=a.records[t][e].children[0].checked}else"dropdown"==a.options.columns[e].type||"autocomplete"==a.options.columns[e].type?(a.options.data[t][e]=n,a.records[t][e].innerText=a.getDropDownValue(e,n)):"calendar"==a.options.columns[e].type?(i=r.calendar.extractDateFromString(n,a.options.columns[e].options.format),a.options.data[t][e]=n,a.records[t][e].innerText=r.calendar.getDateString(i||n,a.options.columns[e].options.format)):"color"==a.options.columns[e].type?(a.options.data[t][e]=n,"square"==a.options.columns[e].render?(i=document.createElement("div"),i.className="color",i.style.backgroundColor=n,a.records[t][e].innerText="",a.records[t][e].appendChild(i)):(a.records[t][e].style.color=n,a.records[t][e].innerText=n)):"image"==a.options.columns[e].type?(n=""+n,a.options.data[t][e]=n,a.records[t][e].innerHTML="",n&&"data:image"==n.substr(0,10)&&(i=document.createElement("img"),i.src=n,a.records[t][e].appendChild(i))):(a.options.data[t][e]=n,"html"==a.options.columns[e].type?a.records[t][e].innerHTML=B(a.parseValue(e,t,n)):!1===a.options.stripHTML||!1===a.options.columns[e].stripHTML?a.records[t][e].innerHTML=B(a.parseValue(e,t,n,a.records[t][e])):a.records[t][e].innerText=a.parseValue(e,t,n,a.records[t][e]),a.records[t][e].style.whiteSpace=0!=a.options.columns[e].wordWrap&&(1==a.options.wordWrap||1==a.options.columns[e].wordWrap||200<a.records[t][e].innerHTML.length)?"pre-wrap":"");0<e&&(a.records[t][e-1].style.overflow=n?"hidden":""),a.dispatch("onchange",q,a.records[t]&&a.records[t][e]?a.records[t][e]:null,e,t,n,o.oldValue)}else o={x:e,y:t,col:e,row:t};return o},a.copyData=function(e,t){var r=a.getData(!0,!0),o=a.selectedContainer,i=parseInt(e.getAttribute("data-x")),s=parseInt(e.getAttribute("data-y")),l=parseInt(t.getAttribute("data-x")),u=parseInt(t.getAttribute("data-y")),c=[],d=!1;if(o[0]==i)var p=s<o[1]?s-o[1]:1,f=0;else f=i<o[0]?i-o[0]:1,p=0;for(var h=0,m=s;m<=u;m++)if(!a.rows[m]||"none"!=a.rows[m].style.display){void 0==r[h]&&(h=0),s=0,o[0]!=i&&(f=i<o[0]?i-o[0]:1);for(var g=i;g<=l;g++){if(a.records[m][g]&&!a.records[m][g].classList.contains("readonly")&&"none"!=a.records[m][g].style.display&&0==d){if(!a.selection.length&&""!=a.options.data[m][g]){d=!0;continue}(void 0==r[h]||void 0==r[h][s])&&(s=0);var v=r[h][s];if(v&&!r[1]&&1==a.options.autoIncrement)if("text"==a.options.columns[g].type||"number"==a.options.columns[g].type)if("="==(""+v).substr(0,1)){var w=v.match(/([A-Z]+[0-9]+)/g);if(w){for(var y=[],b=0;b<w.length;b++){var C=n.getIdFromColumnName(w[b],1);C[0]+=f,C[1]+=p,0>C[1]&&(C[1]=0),C=n.getColumnNameFromId([C[0],C[1]]),C!=w[b]&&(y[w[b]]=C)}y&&(v=a.updateFormula(v,y))}}else v==Number(v)&&(v=Number(v)+p);else"calendar"==a.options.columns[g].type&&(v=new Date(v),v.setDate(v.getDate()+p),v=v.getFullYear()+"-"+n.doubleDigitFormat(parseInt(v.getMonth()+1))+"-"+n.doubleDigitFormat(v.getDate())+" 00:00:00");c.push(a.updateCell(g,m,v)),a.updateFormulaChain(g,m,c)}s++,o[0]!=i&&f++}h++,p++}a.setHistory({action:"setValue",records:c,selection:a.selectedCell}),a.updateTable(),a.onafterchanges(q,c)},a.refreshSelection=function(){a.selectedCell&&a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3])},a.conditionalSelectionUpdate=function(e,t,n){1==e?a.selectedCell&&(t>=a.selectedCell[1]&&t<=a.selectedCell[3]||n>=a.selectedCell[1]&&n<=a.selectedCell[3])&&a.resetSelection():a.selectedCell&&(t>=a.selectedCell[0]&&t<=a.selectedCell[2]||n>=a.selectedCell[0]&&n<=a.selectedCell[2])&&a.resetSelection()},a.resetSelection=function(e){if(a.highlighted.length){s=1;for(var t=0;t<a.highlighted.length;t++){a.highlighted[t].classList.remove("highlight"),a.highlighted[t].classList.remove("highlight-left"),a.highlighted[t].classList.remove("highlight-right"),a.highlighted[t].classList.remove("highlight-top"),a.highlighted[t].classList.remove("highlight-bottom"),a.highlighted[t].classList.remove("highlight-selected");var n=parseInt(a.highlighted[t].getAttribute("data-x")),r=parseInt(a.highlighted[t].getAttribute("data-y"));if(a.highlighted[t].getAttribute("data-merged")){var o=parseInt(a.highlighted[t].getAttribute("colspan")),i=parseInt(a.highlighted[t].getAttribute("rowspan"));o=0<o?n+(o-1):n,i=0<i?r+(i-1):r}else o=n,i=r;for(;n<=o;n++)a.headers[n]&&a.headers[n].classList.remove("selected");for(n=r;n<=i;n++)a.rows[n]&&a.rows[n].classList.remove("selected")}}else var s=0;return a.highlighted=[],a.selectedCell=null,a.corner.style.top="-2000px",a.corner.style.left="-2000px",1==e&&1==s&&a.dispatch("onblur",q),s},a.updateSelection=function(e,t,n){var r=e.getAttribute("data-x");if(e=e.getAttribute("data-y"),t){var o=t.getAttribute("data-x");t=t.getAttribute("data-y")}else o=r,t=e;a.updateSelectionFromCoords(r,e,o,t,n)},a.updateSelectionFromCoords=function(e,t,n,r,o){var i=a.resetSelection();if(null==t&&(t=0,r=a.rows.length-1),null==n&&(n=e),null==r&&(r=t),e>=a.headers.length&&(e=a.headers.length-1),t>=a.rows.length&&(t=a.rows.length-1),n>=a.headers.length&&(n=a.headers.length-1),r>=a.rows.length&&(r=a.rows.length-1),a.selectedCell=[e,t,n,r],null!=e){if(a.records[t][e]&&a.records[t][e].classList.add("highlight-selected"),parseInt(e)<parseInt(n)){var s=parseInt(e);e=parseInt(n)}else s=parseInt(n),e=parseInt(e);for(parseInt(t)<parseInt(r)?(n=parseInt(t),t=parseInt(r)):(n=parseInt(r),t=parseInt(t)),r=s;r<=e;r++)for(var l=n;l<=t;l++)if(a.records[l][r]&&a.records[l][r].getAttribute("data-merged")){var u=parseInt(a.records[l][r].getAttribute("data-x")),c=parseInt(a.records[l][r].getAttribute("data-y")),d=parseInt(a.records[l][r].getAttribute("colspan")),p=parseInt(a.records[l][r].getAttribute("rowspan"));1<d&&(u<s&&(s=u),u+d>e&&(e=u+d-1)),p&&(c<n&&(n=c),c+p>t&&(t=c+p-1))}for(p=d=c=u=null,l=n;l<=t;l++)"none"!=a.rows[l].style.display&&(null==d&&(d=l),p=l);for(r=s;r<=e;r++){for(l=n;l<=t;l++)"none"!=a.rows[l].style.display&&"none"!=a.records[l][r].style.display&&(a.records[l][r].classList.add("highlight"),a.highlighted.push(a.records[l][r]));"hidden"!=a.options.columns[r].type&&(null==u&&(u=r),c=r)}for(u||(u=0),c||(c=0),r=u;r<=c;r++)"hidden"!=a.options.columns[r].type&&(a.records[d]&&a.records[d][r]&&a.records[d][r].classList.add("highlight-top"),a.records[p]&&a.records[p][r]&&a.records[p][r].classList.add("highlight-bottom"),a.headers[r].classList.add("selected"));for(l=d;l<=p;l++)a.rows[l]&&"none"!=a.rows[l].style.display&&(a.records[l][u].classList.add("highlight-left"),a.records[l][c].classList.add("highlight-right"),a.rows[l].classList.add("selected"));a.selectedContainer=[u,d,c,p]}0==i&&(a.dispatch("onfocus",q),a.removeCopyingSelection()),a.dispatch("onselection",q,u,d,c,p,o),a.updateCornerPosition()},a.removeCopySelection=function(){for(var e=0;e<a.selection.length;e++)a.selection[e].classList.remove("selection"),a.selection[e].classList.remove("selection-left"),a.selection[e].classList.remove("selection-right"),a.selection[e].classList.remove("selection-top"),a.selection[e].classList.remove("selection-bottom");a.selection=[]},a.updateCopySelection=function(e,t){a.removeCopySelection();var n=a.selectedContainer[0],r=a.selectedContainer[1],o=a.selectedContainer[2],i=a.selectedContainer[3];if(null!=e&&null!=t){if(0<e-o)var s=parseInt(o)+1,l=parseInt(e);else s=parseInt(e),l=parseInt(n)-1;if(0<t-i)var u=parseInt(i)+1,c=parseInt(t);else u=parseInt(t),c=parseInt(r)-1;for(l-s<=c-u?(s=parseInt(n),l=parseInt(o)):(u=parseInt(r),c=parseInt(i)),n=u;n<=c;n++)for(r=s;r<=l;r++)a.records[n][r]&&"none"!=a.rows[n].style.display&&"none"!=a.records[n][r].style.display&&(a.records[n][r].classList.add("selection"),a.records[u][r].classList.add("selection-top"),a.records[c][r].classList.add("selection-bottom"),a.records[n][s].classList.add("selection-left"),a.records[n][l].classList.add("selection-right"),a.selection.push(a.records[n][r]))}},a.updateCornerPosition=function(){if(a.highlighted.length){var e=a.highlighted[a.highlighted.length-1],t=a.content.getBoundingClientRect(),n=t.left;t=t.top;var r=e.getBoundingClientRect();e=r.left;var o=r.width,i=e-n+a.content.scrollLeft+o-4;a.corner.style.top=r.top-t+a.content.scrollTop+r.height-4+"px",a.corner.style.left=i+"px",a.options.freezeColumns?(t=a.getFreezeWidth(),e-n+o<t?a.corner.style.display="none":1==a.options.selectionCopy&&(a.corner.style.display="")):1==a.options.selectionCopy&&(a.corner.style.display="")}else a.corner.style.top="-2000px",a.corner.style.left="-2000px"},a.updateScroll=function(e){var t=a.content.getBoundingClientRect(),n=t.left,r=t.top,o=t.width;t=t.height;var i=a.records[a.selectedCell[3]][a.selectedCell[2]].getBoundingClientRect(),s=i.left,l=i.top,u=i.width;i=i.height,0==e||1==e?(e=s-n+a.content.scrollLeft,r=l-r+a.content.scrollTop-2):(e=s-n+a.content.scrollLeft+u,r=l-r+a.content.scrollTop+i),r>a.content.scrollTop+30&&r<a.content.scrollTop+t||(a.content.scrollTop=r<a.content.scrollTop+30?r-i:r-(t-2)),r=a.getFreezeWidth(),e>a.content.scrollLeft+r&&e<a.content.scrollLeft+o||(e<a.content.scrollLeft+30?(a.content.scrollLeft=e,50>a.content.scrollLeft&&(a.content.scrollLeft=0)):a.content.scrollLeft=e<a.content.scrollLeft+r?e-r-1:e-(o-20))},a.getWidth=function(e){if(e)"object"==typeof e&&(e=$(e).getAttribute("data-x")),e=a.colgroup[e].getAttribute("width");else{e=[];for(var t=0;t<a.headers.length;t++)e.push(a.options.columns[t].width)}return e},a.setWidth=function(e,t,n){if(t){if(Array.isArray(e)){n||(n=[]);for(var r=0;r<e.length;r++){n[r]||(n[r]=a.colgroup[e[r]].getAttribute("width"));var o=Array.isArray(t)&&t[r]?t[r]:t;a.colgroup[e[r]].setAttribute("width",o),a.options.columns[e[r]].width=o}}else n||(n=a.colgroup[e].getAttribute("width")),a.colgroup[e].setAttribute("width",t),a.options.columns[e].width=t;a.setHistory({action:"setWidth",column:e,oldValue:n,newValue:t}),a.dispatch("onresizecolumn",q,e,t,n),a.updateCornerPosition()}},a.setHeight=function(e,t,n){0<t&&("object"==typeof e&&(e=e.getAttribute("data-y")),n||(n=a.rows[e].getAttribute("height"),n||(n=a.rows[e].getBoundingClientRect().height)),t=parseInt(t),a.rows[e].style.height=t+"px",a.options.rows[e]||(a.options.rows[e]={}),a.options.rows[e].height=t,a.setHistory({action:"setHeight",row:e,oldValue:n,newValue:t}),a.dispatch("onresizerow",q,e,t,n),a.updateCornerPosition())},a.getHeight=function(e){if(e)"object"==typeof e&&(e=$(e).getAttribute("data-y")),e=a.rows[e].style.height;else{e=[];for(var t=0;t<a.rows.length;t++){var n=a.rows[t].style.height;n&&(e[t]=n)}}return e},a.setFooter=function(e){if(e&&(a.options.footers=e),a.options.footers)for(a.tfoot||(a.tfoot=document.createElement("tfoot"),a.table.appendChild(a.tfoot)),e=0;e<a.options.footers.length;e++){if(a.tfoot.children[e])var t=a.tfoot.children[e];else{t=document.createElement("tr");var n=document.createElement("td");t.appendChild(n),a.tfoot.appendChild(t)}for(var r=0;r<a.headers.length;r++)a.options.footers[e][r]||(a.options.footers[e][r]=""),a.tfoot.children[e].children[r+1]?n=a.tfoot.children[e].children[r+1]:(n=document.createElement("td"),t.appendChild(n),n.style.textAlign=a.options.columns[r].align?a.options.columns[r].align:"center"),n.innerText=a.parseValue(r,e,a.options.footers[e][r])}},a.getHeader=function(e){return a.headers[e].innerText},a.setHeader=function(e,t){if(a.headers[e]){var n=a.headers[e].innerText;t||(t=prompt(a.options.text.columnName,n)),t&&(a.headers[e].innerText=t,a.headers[e].setAttribute("title",t),a.options.columns[e].title=t),a.setHistory({action:"setHeader",column:e,oldValue:n,newValue:t}),a.dispatch("onchangeheader",q,e,n,t)}},a.getHeaders=function(e){for(var t=[],n=0;n<a.headers.length;n++)t.push(a.getHeader(n));return e?t:t.join(a.options.csvDelimiter)},a.getMeta=function(e,t){return e?t?a.options.meta[e]&&a.options.meta[e][t]?a.options.meta[e][t]:null:a.options.meta[e]?a.options.meta[e]:null:a.options.meta},a.setMeta=function(e,t,n){if(a.options.meta||(a.options.meta={}),t&&n)a.options.meta[e]||(a.options.meta[e]={}),a.options.meta[e][t]=n;else for(var r=Object.keys(e),o=0;o<r.length;o++){a.options.meta[r[o]]||(a.options.meta[r[o]]={});for(var i=Object.keys(e[r[o]]),s=0;s<i.length;s++)a.options.meta[r[o]][i[s]]=e[r[o]][i[s]]}a.dispatch("onchangemeta",q,e,t,n)},a.updateMeta=function(e){if(a.options.meta){for(var t={},n=Object.keys(a.options.meta),r=0;r<n.length;r++)e[n[r]]?t[e[n[r]]]=a.options.meta[n[r]]:t[n[r]]=a.options.meta[n[r]];a.options.meta=t}},a.getStyle=function(e,t){if(e)return e=n.getIdFromColumnName(e,!0),t?a.records[e[1]][e[0]].style[t]:a.records[e[1]][e[0]].getAttribute("style");for(var r={},o=a.options.data[0].length,i=a.options.data.length,s=0;s<i;s++)for(var l=0;l<o;l++){var u=t?a.records[s][l].style[t]:a.records[s][l].getAttribute("style");if(u){var c=n.getColumnNameFromId([l,s]);r[c]=u}}return r},a.resetStyle=function(e,t){for(var r=Object.keys(e),o=0;o<r.length;o++){var i=n.getIdFromColumnName(r[o],!0);a.records[i[1]]&&a.records[i[1]][i[0]]&&a.records[i[1]][i[0]].setAttribute("style","")}a.setStyle(e,null,null,null,t)},a.setStyle=function(e,t,r,o,i){var s={},l={},u=function(e,t,r){var i=n.getIdFromColumnName(e,!0);if(a.records[i[1]]&&a.records[i[1]][i[0]]&&(0==a.records[i[1]][i[0]].classList.contains("readonly")||o)){var u=a.records[i[1]][i[0]].style[t];u!=r||o?a.records[i[1]][i[0]].style[t]=r:(r="",a.records[i[1]][i[0]].style[t]=""),l[e]||(l[e]=[]),s[e]||(s[e]=[]),l[e].push([t+":"+u]),s[e].push([t+":"+r])}};if(t&&r)if("string"==typeof e)u(e,t,r);else for(var c=[],d=0;d<e.length;d++){var p=e[d].getAttribute("data-x"),f=e[d].getAttribute("data-y");p=n.getColumnNameFromId([p,f]),c[p]||(u(p,t,r),c[p]=!0)}else for(c=Object.keys(e),d=0;d<c.length;d++)for(p=e[c[d]],"string"==typeof p&&(p=p.split(";")),f=0;f<p.length;f++)"string"==typeof p[f]&&(p[f]=p[f].split(":")),p[f][0].trim()&&u(c[d],p[f][0].trim(),p[f][1]);for(c=Object.keys(l),d=0;d<c.length;d++)l[c[d]]=l[c[d]].join(";");for(c=Object.keys(s),d=0;d<c.length;d++)s[c[d]]=s[c[d]].join(";");i||a.setHistory({action:"setStyle",oldValue:l,newValue:s}),a.dispatch("onchangestyle",q,e,t,r)},a.getComments=function(e,t){if(e)return"string"==typeof e&&(e=n.getIdFromColumnName(e,!0)),t?[a.records[e[1]][e[0]].getAttribute("title"),a.records[e[1]][e[0]].getAttribute("author")]:a.records[e[1]][e[0]].getAttribute("title")||"";for(var r={},o=0;o<a.options.data.length;o++)for(var i=0;i<a.options.columns.length;i++){var s=a.records[o][i].getAttribute("title");s&&(e=n.getColumnNameFromId([i,o]),r[e]=s)}return r},a.setComments=function(e,t,r){var o="string"==typeof e?n.getIdFromColumnName(e,!0):e,i=a.records[o[1]][o[0]].getAttribute("title");r=a.records[o[1]][o[0]].getAttribute("data-author");var s=[i,r];a.records[o[1]][o[0]].setAttribute("title",t||""),a.records[o[1]][o[0]].setAttribute("data-author",r||""),t?a.records[o[1]][o[0]].classList.add("jexcel_comments"):a.records[o[1]][o[0]].classList.remove("jexcel_comments"),a.setHistory({action:"setComments",column:e,newValue:[t,r],oldValue:s}),a.dispatch("oncomments",q,t,i,o,o[0],o[1])},a.getConfig=function(){var e=a.options;return e.style=a.getStyle(),e.mergeCells=a.getMerge(),e.comments=a.getComments(),e},a.orderBy=function(e,t){if(0<=e){if(0<Object.keys(a.options.mergeCells).length){if(!confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;a.destroyMerged()}t=null==t?a.headers[e].classList.contains("arrow-down")?1:0:t?1:0;var n=[];if("number"==a.options.columns[e].type||"percentage"==a.options.columns[e].type||"autonumber"==a.options.columns[e].type||"color"==a.options.columns[e].type)for(var r=0;r<a.options.data.length;r++)n[r]=[r,Number(a.options.data[r][e])];else if("calendar"==a.options.columns[e].type||"checkbox"==a.options.columns[e].type||"radio"==a.options.columns[e].type)for(r=0;r<a.options.data.length;r++)n[r]=[r,a.options.data[r][e]];else for(r=0;r<a.options.data.length;r++)n[r]=[r,a.records[r][e].innerText.toLowerCase()];"function"!==typeof a.options.sorting&&(a.options.sorting=function(e){return function(t,n){var r=t[1],a=n[1];return e?""===r&&""!==a?1:""!==r&&""===a||r>a?-1:r<a?1:0:""===r&&""!==a?1:""!==r&&""===a?-1:r>a?1:r<a?-1:0}}),n=n.sort(a.options.sorting(t));var o=[];for(r=0;r<n.length;r++)o[r]=n[r][0];return a.setHistory({action:"orderBy",rows:o,column:e,order:t}),a.updateOrderArrow(e,t),a.updateOrder(o),a.dispatch("onsort",q,e,t),!0}},a.updateOrderArrow=function(e,t){for(var n=0;n<a.headers.length;n++)a.headers[n].classList.remove("arrow-up"),a.headers[n].classList.remove("arrow-down");t?a.headers[e].classList.add("arrow-up"):a.headers[e].classList.add("arrow-down")},a.updateOrder=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=a.options.data[e[n]];for(a.options.data=t,t=[],n=0;n<e.length;n++)t[n]=a.records[e[n]];for(a.records=t,t=[],n=0;n<e.length;n++)t[n]=a.rows[e[n]];if(a.rows=t,a.updateTableReferences(),a.results&&a.results.length)a.searchInput.value?a.search(a.searchInput.value):a.closeFilter();else if(a.results=null,a.pageNumber=0,0<a.options.pagination)a.page(0);else if(1==a.options.lazyLoading)a.loadPage(0);else for(n=0;n<a.rows.length;n++)a.tbody.appendChild(a.rows[n])},a.moveRow=function(e,t,n){if(0<Object.keys(a.options.mergeCells).length){var r=e>t?1:0;if(a.isRowMerged(e).length||a.isRowMerged(t,r).length){if(!confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;a.destroyMerged()}}if(1==a.options.search){if(a.results&&a.results.length!=a.rows.length){if(!confirm(a.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;a.resetSearch()}a.results=null}n||(0<=Array.prototype.indexOf.call(a.tbody.children,a.rows[t])?e>t?a.tbody.insertBefore(a.rows[e],a.rows[t]):a.tbody.insertBefore(a.rows[e],a.rows[t].nextSibling):a.tbody.removeChild(a.rows[e])),a.rows.splice(t,0,a.rows.splice(e,1)[0]),a.records.splice(t,0,a.records.splice(e,1)[0]),a.options.data.splice(t,0,a.options.data.splice(e,1)[0]),0<a.options.pagination&&a.tbody.children.length!=a.options.pagination&&a.page(a.pageNumber),a.setHistory({action:"moveRow",oldValue:e,newValue:t}),a.updateTableReferences(),a.dispatch("onmoverow",q,e,t)},a.insertRow=function(e,t,n){if(1==a.options.allowInsertRow){var r=[];if(0<e)var o=e;else o=1,e&&(r=e);if(n=!!n,e=a.options.data.length-1,(void 0==t||t>=parseInt(e)||0>t)&&(t=e),!1===a.dispatch("onbeforeinsertrow",q,t,o,n))return!1;if(0<Object.keys(a.options.mergeCells).length&&a.isRowMerged(t,n).length){if(!confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;a.destroyMerged()}if(1==a.options.search){if(a.results&&a.results.length!=a.rows.length){if(!confirm(a.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;a.resetSearch()}a.results=null}e=n?t:t+1;for(var i=a.records.splice(e),s=a.options.data.splice(e),l=a.rows.splice(e),u=[],c=[],d=[],p=e;p<o+e;p++){a.options.data[p]=[];for(var f=0;f<a.options.columns.length;f++)a.options.data[p][f]=r[f]?r[f]:"";f=a.createRow(p,a.options.data[p]),l[0]?0<=Array.prototype.indexOf.call(a.tbody.children,l[0])&&a.tbody.insertBefore(f,l[0]):0<=Array.prototype.indexOf.call(a.tbody.children,a.rows[t])&&a.tbody.appendChild(f),u.push(a.records[p]),c.push(a.options.data[p]),d.push(f)}Array.prototype.push.apply(a.records,i),Array.prototype.push.apply(a.options.data,s),Array.prototype.push.apply(a.rows,l),0<a.options.pagination&&a.page(a.pageNumber),a.setHistory({action:"insertRow",rowNumber:t,numOfRows:o,insertBefore:n,rowRecords:u,rowData:c,rowNode:d}),a.updateTableReferences(),a.dispatch("oninsertrow",q,t,o,u,n)}},a.deleteRow=function(e,t){if(1==a.options.allowDeleteRow)if(1==a.options.allowDeletingAllRows||1<a.options.data.length){if(void 0==e){var n=a.getSelectedRows();n[0]?(e=parseInt(n[0].getAttribute("data-y")),t=n.length):(e=a.options.data.length-1,t=1)}if(n=a.options.data.length-1,(void 0==e||e>n||0>e)&&(e=n),t||(t=1),e+t>=a.options.data.length&&(t=a.options.data.length-e),!1===a.dispatch("onbeforedeleterow",q,e,t))return!1;if(-1<parseInt(e)){var r=!1;if(0<Object.keys(a.options.mergeCells).length)for(var o=e;o<e+t;o++)a.isRowMerged(o,!1).length&&(r=!0);if(r){if(!confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;a.destroyMerged()}if(1==a.options.search){if(a.results&&a.results.length!=a.rows.length){if(!confirm(a.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;a.resetSearch()}a.results=null}for(0==a.options.allowDeletingAllRows&&n+1===t&&(t--,console.error("Jspreadsheet: It is not possible to delete the last row")),o=e;o<e+t;o++)0<=Array.prototype.indexOf.call(a.tbody.children,a.rows[o])&&(a.rows[o].className="",a.rows[o].parentNode.removeChild(a.rows[o]));n=a.records.splice(e,t),r=a.options.data.splice(e,t),o=a.rows.splice(e,t),0<a.options.pagination&&a.tbody.children.length!=a.options.pagination&&a.page(a.pageNumber),a.conditionalSelectionUpdate(1,e,e+t-1),a.setHistory({action:"deleteRow",rowNumber:e,numOfRows:t,insertBefore:1,rowRecords:n,rowData:r,rowNode:o}),a.updateTableReferences(),a.dispatch("ondeleterow",q,e,t,n)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},a.moveColumn=function(e,t){if(0<Object.keys(a.options.mergeCells).length){var n=e>t?1:0;if(a.isColMerged(e).length||a.isColMerged(t,n).length){if(!confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;a.destroyMerged()}}if(e=parseInt(e),t=parseInt(t),e>t)for(a.headerContainer.insertBefore(a.headers[e],a.headers[t]),a.colgroupContainer.insertBefore(a.colgroup[e],a.colgroup[t]),n=0;n<a.rows.length;n++)a.rows[n].insertBefore(a.records[n][e],a.records[n][t]);else for(a.headerContainer.insertBefore(a.headers[e],a.headers[t].nextSibling),a.colgroupContainer.insertBefore(a.colgroup[e],a.colgroup[t].nextSibling),n=0;n<a.rows.length;n++)a.rows[n].insertBefore(a.records[n][e],a.records[n][t].nextSibling);for(a.options.columns.splice(t,0,a.options.columns.splice(e,1)[0]),a.headers.splice(t,0,a.headers.splice(e,1)[0]),a.colgroup.splice(t,0,a.colgroup.splice(e,1)[0]),n=0;n<a.rows.length;n++)a.options.data[n].splice(t,0,a.options.data[n].splice(e,1)[0]),a.records[n].splice(t,0,a.records[n].splice(e,1)[0]);if(a.options.footers)for(n=0;n<a.options.footers.length;n++)a.options.footers[n].splice(t,0,a.options.footers[n].splice(e,1)[0]);a.setHistory({action:"moveColumn",oldValue:e,newValue:t}),a.updateTableReferences(),a.dispatch("onmovecolumn",q,e,t)},a.insertColumn=function(e,t,r,o){if(1==a.options.allowInsertColumn){var i=[];if(0<e)var s=e;else s=1,e&&(i=e);if(r=!!r,e=a.options.columns.length-1,(void 0==t||t>=parseInt(e)||0>t)&&(t=e),!1===a.dispatch("onbeforeinsertcolumn",q,t,s,r))return!1;if(0<Object.keys(a.options.mergeCells).length&&a.isColMerged(t,r).length){if(!confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;a.destroyMerged()}o||(o=[]);for(var l=0;l<s;l++)o[l]||(o[l]={type:"text",source:[],options:[],width:a.options.defaultColWidth,align:a.options.defaultColAlign});e=r?t:t+1,a.options.columns=n.injectArray(a.options.columns,e,o);var u=a.headers.splice(e),c=a.colgroup.splice(e),d=[],p=[],f=[],h=[],m=[];for(l=e;l<s+e;l++)a.createCellHeader(l),a.headerContainer.insertBefore(a.headers[l],a.headerContainer.children[l+1]),a.colgroupContainer.insertBefore(a.colgroup[l],a.colgroupContainer.children[l+1]),d.push(a.headers[l]),p.push(a.colgroup[l]);if(a.options.footers)for(var g=0;g<a.options.footers.length;g++){for(m[g]=[],l=0;l<s;l++)m[g].push("");a.options.footers[g].splice(e,0,m[g])}for(g=0;g<a.options.data.length;g++){var v=a.options.data[g].splice(e),w=a.records[g].splice(e);for(h[g]=[],f[g]=[],l=e;l<s+e;l++){var y=i[g]?i[g]:"";a.options.data[g][l]=y;var b=a.createCell(l,g,a.options.data[g][l]);a.records[g][l]=b,a.rows[g]&&a.rows[g].insertBefore(b,a.rows[g].children[l+1]),h[g].push(y),f[g].push(b)}Array.prototype.push.apply(a.options.data[g],v),Array.prototype.push.apply(a.records[g],w)}if(Array.prototype.push.apply(a.headers,u),Array.prototype.push.apply(a.colgroup,c),a.options.nestedHeaders&&0<a.options.nestedHeaders.length)if(a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(g=0;g<a.options.nestedHeaders.length;g++){for(i=parseInt(a.options.nestedHeaders[g][a.options.nestedHeaders[g].length-1].colspan)+s,a.options.nestedHeaders[g][a.options.nestedHeaders[g].length-1].colspan=i,a.thead.children[g].children[a.thead.children[g].children.length-1].setAttribute("colspan",i),i=a.thead.children[g].children[a.thead.children[g].children.length-1].getAttribute("data-column"),i=i.split(","),l=e;l<s+e;l++)i.push(l);a.thead.children[g].children[a.thead.children[g].children.length-1].setAttribute("data-column",i)}else i=parseInt(a.options.nestedHeaders[0].colspan)+s,a.options.nestedHeaders[0].colspan=i,a.thead.children[0].children[a.thead.children[0].children.length-1].setAttribute("colspan",i);a.setHistory({action:"insertColumn",columnNumber:t,numOfColumns:s,insertBefore:r,columns:o,headers:d,colgroup:p,records:f,footers:m,data:h}),a.updateTableReferences(),a.dispatch("oninsertcolumn",q,t,s,f,r)}},a.deleteColumn=function(e,t){if(1==a.options.allowDeleteColumn)if(1<a.headers.length){if(void 0==e){var n=a.getSelectedColumns(!0);n.length?(e=parseInt(n[0]),t=parseInt(n.length)):(e=a.headers.length-1,t=1)}if(n=a.options.data[0].length-1,(void 0==e||e>n||0>e)&&(e=n),t||(t=1),t>a.options.data[0].length-e&&(t=a.options.data[0].length-e),!1===a.dispatch("onbeforedeletecolumn",q,e,t))return!1;if(-1<parseInt(e)){if(n=!1,0<Object.keys(a.options.mergeCells).length)for(var r=e;r<e+t;r++)a.isColMerged(r,!1).length&&(n=!0);if(n){if(!confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;a.destroyMerged()}for(n=a.options.columns.splice(e,t),r=e;r<e+t;r++)a.colgroup[r].className="",a.headers[r].className="",a.colgroup[r].parentNode.removeChild(a.colgroup[r]),a.headers[r].parentNode.removeChild(a.headers[r]);for(var o=a.headers.splice(e,t),i=a.colgroup.splice(e,t),s=[],l=[],u=[],c=0;c<a.options.data.length;c++)for(r=e;r<e+t;r++)a.records[c][r].className="",a.records[c][r].parentNode.removeChild(a.records[c][r]);for(c=0;c<a.options.data.length;c++)l[c]=a.options.data[c].splice(e,t),s[c]=a.records[c].splice(e,t);if(a.options.footers)for(c=0;c<a.options.footers.length;c++)u[c]=a.options.footers[c].splice(e,t);if(a.conditionalSelectionUpdate(0,e,e+t-1),a.options.nestedHeaders&&0<a.options.nestedHeaders.length)if(a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(r=0;r<a.options.nestedHeaders.length;r++)c=parseInt(a.options.nestedHeaders[r][a.options.nestedHeaders[r].length-1].colspan)-t,a.options.nestedHeaders[r][a.options.nestedHeaders[r].length-1].colspan=c,a.thead.children[r].children[a.thead.children[r].children.length-1].setAttribute("colspan",c);else c=parseInt(a.options.nestedHeaders[0].colspan)-t,a.options.nestedHeaders[0].colspan=c,a.thead.children[0].children[a.thead.children[0].children.length-1].setAttribute("colspan",c);a.setHistory({action:"deleteColumn",columnNumber:e,numOfColumns:t,insertBefore:1,columns:n,headers:o,colgroup:i,records:s,footers:u,data:l}),a.updateTableReferences(),a.dispatch("ondeletecolumn",q,e,t,s)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},a.getSelectedRows=function(e){for(var t=[],n=0;n<a.rows.length;n++)a.rows[n].classList.contains("selected")&&(e?t.push(n):t.push(a.rows[n]));return t},a.getSelectedColumns=function(){for(var e=[],t=0;t<a.headers.length;t++)a.headers[t].classList.contains("selected")&&e.push(t);return e},a.getHighlighted=function(){return a.highlighted},a.updateTableReferences=function(){for(var e=0;e<a.headers.length;e++){var t=a.headers[e].getAttribute("data-x");t!=e&&(a.headers[e].setAttribute("data-x",e),a.headers[e].getAttribute("title")||(a.headers[e].innerHTML=n.getColumnName(e)))}for(var r=0;r<a.rows.length;r++)if(a.rows[r]){var o=a.rows[r].getAttribute("data-y");o!=r&&(a.rows[r].setAttribute("data-y",r),a.rows[r].children[0].setAttribute("data-y",r),a.rows[r].children[0].innerHTML=r+1)}var i=[],s=[],l=function(e,t,r,o){e!=r&&a.records[o][r].setAttribute("data-x",r),t!=o&&a.records[o][r].setAttribute("data-y",o),e==r&&t==o||(e=n.getColumnNameFromId([e,t]),r=n.getColumnNameFromId([r,o]),i[e]=r)};for(r=0;r<a.records.length;r++)for(e=0;e<a.records[0].length;e++)if(a.records[r][e])if(t=a.records[r][e].getAttribute("data-x"),o=a.records[r][e].getAttribute("data-y"),a.records[r][e].getAttribute("data-merged")){var u=n.getColumnNameFromId([t,o]),c=n.getColumnNameFromId([e,r]);null==s[u]&&(u==c?s[u]=!1:(t=parseInt(e-t),o=parseInt(r-o),s[u]=[c,t,o]))}else l(t,o,e,r);var d=Object.keys(s);if(d.length)for(e=0;e<d.length;e++)if(s[d[e]]){for(r=n.getIdFromColumnName(d[e],!0),t=r[0],o=r[1],l(t,o,t+s[d[e]][1],o+s[d[e]][2]),u=d[e],c=s[d[e]][0],r=0;r<a.options.mergeCells[u][2].length;r++)t=parseInt(a.options.mergeCells[u][2][r].getAttribute("data-x")),o=parseInt(a.options.mergeCells[u][2][r].getAttribute("data-y")),a.options.mergeCells[u][2][r].setAttribute("data-x",t+s[d[e]][1]),a.options.mergeCells[u][2][r].setAttribute("data-y",o+s[d[e]][2]);a.options.mergeCells[c]=a.options.mergeCells[u],delete a.options.mergeCells[u]}a.updateFormulas(i),a.updateMeta(i),a.refreshSelection(),a.updateTable()},a.updateTable=function(){if(0<a.options.minSpareRows){for(var e=0,t=a.rows.length-1;0<=t;t--){for(var r=!1,o=0;o<a.headers.length;o++)a.options.data[t][o]&&(r=!0);if(r)break;e++}0<a.options.minSpareRows-e&&a.insertRow(a.options.minSpareRows-e)}if(0<a.options.minSpareCols){for(e=0,o=a.headers.length-1;0<=o;o--){for(r=!1,t=0;t<a.rows.length;t++)a.options.data[t][o]&&(r=!0);if(r)break;e++}0<a.options.minSpareCols-e&&a.insertColumn(a.options.minSpareCols-e)}if("function"==typeof a.options.updateTable){for(a.options.detachForUpdates&&q.removeChild(a.content),t=0;t<a.rows.length;t++)for(o=0;o<a.headers.length;o++)a.options.updateTable(q,a.records[t][o],o,t,a.options.data[t][o],a.records[t][o].innerText,n.getColumnNameFromId([o,t]));a.options.detachForUpdates&&q.insertBefore(a.content,a.pagination)}a.options.footers&&a.setFooter(),setTimeout((function(){a.updateCornerPosition()}),0)},a.isReadOnly=function(e){if(e=a.getCell(e))return!!e.classList.contains("readonly")},a.setReadOnly=function(e,t){(e=a.getCell(e))&&(t?e.classList.add("readonly"):e.classList.remove("readonly"))},a.showRow=function(e){a.rows[e].style.display=""},a.hideRow=function(e){a.rows[e].style.display="none"},a.showColumn=function(e){a.headers[e].style.display="",a.colgroup[e].style.display="";for(var t=0;t<a.options.data.length;t++)a.records[t][e].style.display=""},a.hideColumn=function(e){a.headers[e].style.display="none",a.colgroup[e].style.display="none";for(var t=0;t<a.options.data.length;t++)a.records[t][e].style.display="none"},a.showIndex=function(){a.table.classList.remove("jexcel_hidden_index")},a.hideIndex=function(){a.table.classList.add("jexcel_hidden_index")};var t=[];a.updateFormulaChain=function(e,r,o){var i=n.getColumnNameFromId([e,r]);if(a.formula[i]&&0<a.formula[i].length)if(t[i])a.records[r][e].innerHTML="#ERROR",a.formula[i]="";else for(t[i]=!0,e=0;e<a.formula[i].length;e++){r=n.getIdFromColumnName(a.formula[i][e],!0);var s=""+a.options.data[r[1]][r[0]];"="==s.substr(0,1)?o.push(a.updateCell(r[0],r[1],s,!0)):Object.keys(a.formula)[e]=null,a.updateFormulaChain(r[0],r[1],o)}t=[]},a.updateFormulas=function(e){for(var t=0;t<a.options.data.length;t++)for(var n=0;n<a.options.data[0].length;n++){var r=""+a.options.data[t][n];if("="==r.substr(0,1)){var o=a.updateFormula(r,e);o!=r&&(a.options.data[t][n]=o)}}o=[];var i=Object.keys(a.formula);for(t=0;t<i.length;t++){var s=i[t];for(r=a.formula[s],e[s]&&(s=e[s]),o[s]=[],n=0;n<r.length;n++){var l=r[n];e[l]&&(l=e[l]),o[s].push(l)}}a.formula=o},a.updateFormula=function(e,t){for(var n=/[A-Z]/,r=/[0-9]/,a="",o=null,i=null,s="",l=0;l<e.length;l++)n.exec(e[l])?(o=1,i=0,s+=e[l]):r.exec(e[l])?(i=o?1:0,s+=e[l]):(o&&i&&(s=t[s]?t[s]:s),a+=s,a+=e[l],i=o=0,s="");return s&&(o&&i&&(s=t[s]?t[s]:s),a+=s),a};var h=function(e){for(var t="",n=0,r=0;r<e.length;r++)'"'==e[r]&&(n=0==n?1:0),t=1==n?t+e[r]:t+e[r].toUpperCase();return t};a.executeFormula=function(b,c,e){var g=[],l=[],p=function(u,m,z){var D=n.getColumnNameFromId([m,z]);if(l[D])return console.error("Reference loop detected"),"#ERROR";l[D]=!0;var E=function(e){for(var t=0;t<e.length;t++){var r=[],a=e[t].split(":"),o=n.getIdFromColumnName(a[0],!0),i=n.getIdFromColumnName(a[1],!0);if(o[0]<=i[0]){a=o[0];var s=i[0]}else a=i[0],s=o[0];if(o[1]<=i[1]){var l=o[1];o=i[1]}else l=i[1],o=o[1];for(;l<=o;l++)for(i=a;i<=s;i++)r.push(n.getColumnNameFromId([i,l]));u=u.replace(e[t],r.join(","))}};u=u.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var C=u.match(/([A-Z]+[0-9]+):([A-Z]+[0-9]+)/g);if(C&&C.length&&E(C),(C=u.match(/([A-Z]+[0-9]+)/g))&&-1<C.indexOf(D))return console.error("Self Reference detected"),"#ERROR";if(E={},C)for(var F=0;F<C.length;F++)if(a.formula[C[F]]||(a.formula[C[F]]=[]),0>a.formula[C[F]].indexOf(D)&&a.formula[C[F]].push(D),eval("typeof("+C[F]+') == "undefined"')){var I=n.getIdFromColumnName(C[F],1),J="undefined"!=typeof a.options.data[I[1]]&&"undefined"!=typeof a.options.data[I[1]][I[0]]?a.options.data[I[1]][I[0]]:"";"="==(""+J).substr(0,1)&&(g[C[F]]?J=g[C[F]]:(J=p(J,I[0],I[1]),g[C[F]]=J)),""==(""+J).trim()?E[C[F]]=null:J==Number(J)&&1==a.options.autoCasting?E[C[F]]=Number(J):(I=a.parseNumber(J,I[0]),E[C[F]]=1==a.options.autoCasting&&I?I:'"'+J+'"')}try{var M=n.formula(u.substr(1),E,m,z,a)}catch(P){M="#ERROR",console.log(P)}return M};return p(b,c,e)},a.parseNumber=function(e,t){var n=(""+e).split(t&&a.options.columns[t].decimal?a.options.columns[t].decimal:".");return n[0]=n[0].match(/[+-]?[0-9]/g),n[0]&&(n[0]=n[0].join("")),n[1]&&(n[1]=n[1].match(/[0-9]*/g).join("")),n[0]&&0<=Number(n[0])?n[1]?Number(n[0]+"."+n[1]):Number(n[0]+".00"):null},a.row=function(e){},a.col=function(e){},a.up=function(e,t){if(e?0<a.selectedCell[3]&&a.up.visible(1,t?0:1):(0<a.selectedCell[1]&&a.up.visible(0,t?0:1),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]),1==a.options.lazyLoading)if(0==a.selectedCell[1]||0==a.selectedCell[3])a.loadPage(0),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]);else if(a.loadValidation())a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]);else{var n=parseInt(a.tbody.firstChild.getAttribute("data-y"));30>a.selectedCell[1]-n&&(a.loadUp(),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]))}else 0<a.options.pagination&&(n=a.whichPage(a.selectedCell[3]),n!=a.pageNumber&&a.page(n));a.updateScroll(1)},a.up.visible=function(e,t){if(0==e)var n=parseInt(a.selectedCell[0]),r=parseInt(a.selectedCell[1]);else n=parseInt(a.selectedCell[2]),r=parseInt(a.selectedCell[3]);if(0==t){for(var o=0;o<r;o++)if("none"!=a.records[o][n].style.display&&"none"!=a.rows[o].style.display){r=o;break}}else r=a.up.get(n,r);0==e?(a.selectedCell[0]=n,a.selectedCell[1]=r):(a.selectedCell[2]=n,a.selectedCell[3]=r)},a.up.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var n=t-1;0<=n;n--)if("none"!=a.records[n][e].style.display&&"none"!=a.rows[n].style.display&&(!a.records[n][e].getAttribute("data-merged")||a.records[n][e]!=a.records[t][e])){t=n;break}return t},a.down=function(e,t){if(e?a.selectedCell[3]<a.records.length-1&&a.down.visible(1,t?0:1):(a.selectedCell[1]<a.records.length-1&&a.down.visible(0,t?0:1),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]),1==a.options.lazyLoading)a.selectedCell[1]==a.records.length-1||a.selectedCell[3]==a.records.length-1?(a.loadPage(-1),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3])):a.loadValidation()?a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]):30>parseInt(a.tbody.lastChild.getAttribute("data-y"))-a.selectedCell[3]&&(a.loadDown(),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]));else if(0<a.options.pagination){var n=a.whichPage(a.selectedCell[3]);n!=a.pageNumber&&a.page(n)}a.updateScroll(3)},a.down.visible=function(e,t){if(0==e)var n=parseInt(a.selectedCell[0]),r=parseInt(a.selectedCell[1]);else n=parseInt(a.selectedCell[2]),r=parseInt(a.selectedCell[3]);if(0==t){for(var o=a.rows.length-1;o>r;o--)if("none"!=a.records[o][n].style.display&&"none"!=a.rows[o].style.display){r=o;break}}else r=a.down.get(n,r);0==e?(a.selectedCell[0]=n,a.selectedCell[1]=r):(a.selectedCell[2]=n,a.selectedCell[3]=r)},a.down.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var n=t+1;n<a.rows.length;n++)if("none"!=a.records[n][e].style.display&&"none"!=a.rows[n].style.display&&(!a.records[n][e].getAttribute("data-merged")||a.records[n][e]!=a.records[t][e])){t=n;break}return t},a.right=function(e,t){e?a.selectedCell[2]<a.headers.length-1&&a.right.visible(1,t?0:1):(a.selectedCell[0]<a.headers.length-1&&a.right.visible(0,t?0:1),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]),a.updateScroll(2)},a.right.visible=function(e,t){if(0==e)var n=parseInt(a.selectedCell[0]),r=parseInt(a.selectedCell[1]);else n=parseInt(a.selectedCell[2]),r=parseInt(a.selectedCell[3]);if(0==t){for(var o=a.headers.length-1;o>n;o--)if("none"!=a.records[r][o].style.display){n=o;break}}else n=a.right.get(n,r);0==e?(a.selectedCell[0]=n,a.selectedCell[1]=r):(a.selectedCell[2]=n,a.selectedCell[3]=r)},a.right.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var n=e+1;n<a.headers.length;n++)if("none"!=a.records[t][n].style.display&&(!a.records[t][n].getAttribute("data-merged")||a.records[t][n]!=a.records[t][e])){e=n;break}return e},a.left=function(e,t){e?0<a.selectedCell[2]&&a.left.visible(1,t?0:1):(0<a.selectedCell[0]&&a.left.visible(0,t?0:1),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]),a.updateScroll(0)},a.left.visible=function(e,t){if(0==e)var n=parseInt(a.selectedCell[0]),r=parseInt(a.selectedCell[1]);else n=parseInt(a.selectedCell[2]),r=parseInt(a.selectedCell[3]);if(0==t){for(var o=0;o<n;o++)if("none"!=a.records[r][o].style.display){n=o;break}}else n=a.left.get(n,r);0==e?(a.selectedCell[0]=n,a.selectedCell[1]=r):(a.selectedCell[2]=n,a.selectedCell[3]=r)},a.left.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var n=e-1;0<=n;n--)if("none"!=a.records[t][n].style.display&&(!a.records[t][n].getAttribute("data-merged")||a.records[t][n]!=a.records[t][e])){e=n;break}return e},a.first=function(e,t){if(e?t?a.selectedCell[3]=0:a.left.visible(1,0):(t?a.selectedCell[1]=0:a.left.visible(0,0),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]),1!=a.options.lazyLoading||0!=a.selectedCell[1]&&0!=a.selectedCell[3]){if(0<a.options.pagination){var n=a.whichPage(a.selectedCell[3]);n!=a.pageNumber&&a.page(n)}}else a.loadPage(0);a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]),a.updateScroll(1)},a.last=function(e,t){if(e?t?a.selectedCell[3]=a.records.length-1:a.right.visible(1,0):(t?a.selectedCell[1]=a.records.length-1:a.right.visible(0,0),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]),1!=a.options.lazyLoading||a.selectedCell[1]!=a.records.length-1&&a.selectedCell[3]!=a.records.length-1){if(0<a.options.pagination){var n=a.whichPage(a.selectedCell[3]);n!=a.pageNumber&&a.page(n)}}else a.loadPage(-1);a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]),a.updateScroll(3)},a.selectAll=function(){a.selectedCell||(a.selectedCell=[]),a.selectedCell[0]=0,a.selectedCell[1]=0,a.selectedCell[2]=a.headers.length-1,a.selectedCell[3]=a.records.length-1,a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3])},a.loadPage=function(e){var t=1==a.options.search&&a.results?a.results:a.rows;null!=e&&-1!=e||(e=Math.ceil(t.length/100)-1),e=100*e+100,e>t.length&&(e=t.length);var n=e-100;for(0>n&&(n=0);n<e;n++)1==a.options.search&&a.results?a.tbody.appendChild(a.rows[t[n]]):a.tbody.appendChild(a.rows[n]),100<a.tbody.children.length&&a.tbody.removeChild(a.tbody.firstChild)},a.loadUp=function(){var e=1==a.options.search&&a.results?a.results:a.rows,t=0;if(100<e.length){var n=parseInt(a.tbody.firstChild.getAttribute("data-y"));if(1==a.options.search&&a.results&&(n=e.indexOf(n)),0<n)for(var r=0;30>r;r++)--n,-1<n&&(1==a.options.search&&a.results?a.tbody.insertBefore(a.rows[e[n]],a.tbody.firstChild):a.tbody.insertBefore(a.rows[n],a.tbody.firstChild),100<a.tbody.children.length&&(a.tbody.removeChild(a.tbody.lastChild),t=1))}return t},a.loadDown=function(){var e=1==a.options.search&&a.results?a.results:a.rows,t=0;if(100<e.length){var n=parseInt(a.tbody.lastChild.getAttribute("data-y"));if(1==a.options.search&&a.results&&(n=e.indexOf(n)),n<a.rows.length-1)for(var r=0;30>=r;r++)n<e.length&&(1==a.options.search&&a.results?a.tbody.appendChild(a.rows[e[n]]):a.tbody.appendChild(a.rows[n]),100<a.tbody.children.length&&(a.tbody.removeChild(a.tbody.firstChild),t=1)),n+=1}return t},a.loadValidation=function(){if(a.selectedCell){var e=parseInt(a.tbody.firstChild.getAttribute("data-y"))/100,t=parseInt(a.selectedCell[3]/100),n=parseInt(a.rows.length/100);if(e!=t&&t<=n&&!Array.prototype.indexOf.call(a.tbody.children,a.rows[a.selectedCell[3]]))return a.loadPage(t),!0}return!1},a.resetSearch=function(){a.searchInput.value="",a.search(""),a.results=null},a.search=function(e){if(e&&(e=e.toLowerCase()),a.options.filters&&a.resetFilters(),a.resetSelection(),a.pageNumber=0,a.results=[],e){var t=function(e){-1==a.results.indexOf(e)&&a.results.push(e)};a.options.data.filter((function(r,o){e:{for(var i=e,s=0;s<r.length;s++)if(0<=(""+r[s]).toLowerCase().search(i)||0<=(""+a.records[o][s].innerHTML).toLowerCase().search(i)){i=!0;break e}i=!1}if(i){if(i=a.isRowMerged(o),i.length)for(s=0;s<i.length;s++)for(var l=n.getIdFromColumnName(i[s],!0),u=0;u<a.options.mergeCells[i[s]][1];u++)t(l[1]+u);else t(o);return!0}return!1}))}else a.results=null;return a.updateResult()},a.updateResult=function(){var e,t=0;for(e=1==a.options.lazyLoading?100:0<a.options.pagination?a.options.pagination:a.results?a.results.length:a.rows.length;a.tbody.firstChild;)a.tbody.removeChild(a.tbody.firstChild);for(var n=0;n<a.rows.length;n++)!a.results||-1<a.results.indexOf(n)?(t<e&&(a.tbody.appendChild(a.rows[n]),t++),a.rows[n].style.display=""):a.rows[n].style.display="none";return 0<a.options.pagination&&a.updatePagination(),a.updateCornerPosition(),e},a.whichPage=function(e){return 1==a.options.search&&a.results&&(e=a.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(a.options.pagination))-1},a.page=function(e){var t=a.pageNumber,n=1==a.options.search&&a.results?a.results:a.rows,r=parseInt(a.options.pagination);null!=e&&-1!=e||(e=Math.ceil(n.length/r)-1),a.pageNumber=e;var o=e*r;for(r=e*r+r,r>n.length&&(r=n.length),0>o&&(o=0);a.tbody.firstChild;)a.tbody.removeChild(a.tbody.firstChild);for(;o<r;o++)1==a.options.search&&a.results?a.tbody.appendChild(a.rows[n[o]]):a.tbody.appendChild(a.rows[o]);0<a.options.pagination&&a.updatePagination(),a.updateCornerPosition(),a.dispatch("onchangepage",q,e,t)},a.updatePagination=function(){if(a.pagination.children[0].innerHTML="",a.pagination.children[1].innerHTML="",a.options.pagination){var e=1==a.options.search&&a.results?a.results.length:a.rows.length;if(e){if(e=Math.ceil(e/a.options.pagination),6>a.pageNumber)var t=1,n=10>e?e:10;else 5>e-a.pageNumber?(t=e-9,n=e,1>t&&(t=1)):(t=a.pageNumber-4,n=a.pageNumber+5);if(1<t){var r=document.createElement("div");r.className="jexcel_page",r.innerHTML="<",r.title=1,a.pagination.children[1].appendChild(r)}for(;t<=n;t++)r=document.createElement("div"),r.className="jexcel_page",r.innerHTML=t,a.pagination.children[1].appendChild(r),a.pageNumber==t-1&&r.classList.add("jexcel_page_selected");n<e&&(r=document.createElement("div"),r.className="jexcel_page",r.innerHTML=">",r.title=e,a.pagination.children[1].appendChild(r)),a.pagination.children[0].innerHTML=function(e){var t=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,(function(e,n){return"undefined"!=typeof t[n]?t[n]:e}))}(a.options.text.showingPage,a.pageNumber+1,e)}else a.pagination.children[0].innerHTML=a.options.text.noRecordsFound}},a.download=function(e){if(0==a.options.allowExport)console.error("Export not allowed");else{e=""+a.copy(!1,a.options.csvDelimiter,!0,e,!0);var t=new Blob(["\ufeff"+e],{type:"text/csv;charset=utf-8;"});window.navigator&&window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(t,a.options.csvFileName+".csv"):(e=document.createElement("a"),t=URL.createObjectURL(t),e.href=t,e.setAttribute("download",a.options.csvFileName+".csv"),document.body.appendChild(e),e.click(),e.parentNode.removeChild(e))}},a.setHistory=function(e){if(1!=a.ignoreHistory){var t=++a.historyIndex;a.history=a.history.slice(0,t+1),a.history[t]=e}},a.copy=function(e,t,n,r,o){t||(t="\t");var i,s=new RegExp(t,"ig"),l=[],u=[],c=[],d=a.options.data[0].length,p=a.options.data.length,f=!1,h="",m="",g=0,v=0;if(o&&1==a.options.includeHeadersOnDownload||!o&&1==a.options.includeHeadersOnCopy||r){if(a.options.nestedHeaders&&0<a.options.nestedHeaders.length){var w=a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0]?a.options.nestedHeaders:[a.options.nestedHeaders];for(r=0;r<w.length;r++){for(f=[],o=0;o<w[r].length;o++){var y=parseInt(w[r][o].colspan);for(f.push(w[r][o].title),i=0;i<y-1;i++)f.push("")}m+=f.join(t)+"\r\n"}}f=!0}for(a.style=[],r=0;r<p;r++){for(y=[],i=[],o=0;o<d;o++)e&&!a.records[r][o].classList.contains("highlight")||(1==f&&l.push(a.headers[o].innerText),w=a.options.data[r][o],w.match&&(w.match(s)||w.match(/,/g)||w.match(/\n/)||w.match(/"/))&&(w=w.replace(RegExp('"',"g"),'""'),w='"'+w+'"'),y.push(w),"checkbox"!=a.options.columns[o].type&&"radio"!=a.options.columns[o].type&&(w=1==a.options.stripHTMLOnCopy?a.records[r][o].innerText:a.records[r][o].innerHTML,w.match&&(w.match(s)||w.match(/,/g)||w.match(/\n/)||w.match(/"/))&&(w=w.replace(RegExp('"',"g"),'""'),w='"'+w+'"')),i.push(w),w=a.records[r][o].getAttribute("style"),w=w.replace("display: none;",""),a.style.push(w||""));y.length&&(f&&(g=y.length,u.push(l.join(t))),u.push(y.join(t))),i.length&&(v++,f&&(c.push(l.join(t)),f=!1),c.push(i.join(t)))}if(d==g&&p==v&&(h=m),e=h+u.join("\r\n"),h+=c.join("\r\n"),n||(a.textarea.value=1==a.options.copyCompatibility?h:e,a.textarea.select(),document.execCommand("copy")),a.data=1==a.options.copyCompatibility?h:e,a.hashString=a.hash(a.data),!n){if(a.removeCopyingSelection(),a.highlighted)for(o=0;o<a.highlighted.length;o++)a.highlighted[o].classList.add("copying"),a.highlighted[o].classList.contains("highlight-left")&&a.highlighted[o].classList.add("copying-left"),a.highlighted[o].classList.contains("highlight-right")&&a.highlighted[o].classList.add("copying-right"),a.highlighted[o].classList.contains("highlight-top")&&a.highlighted[o].classList.add("copying-top"),a.highlighted[o].classList.contains("highlight-bottom")&&a.highlighted[o].classList.add("copying-bottom");a.dispatch("oncopy",q,1==a.options.copyCompatibility?c:u,a.hashString)}return a.data},a.paste=function(e,t,r){var o=a.dispatch("onbeforepaste",q,r,e,t);if(!1===o)return!1;o&&(r=o);var i=a.hash(r);if(o=i==a.hashString?a.style:null,1==a.options.copyCompatibility&&i==a.hashString&&(r=a.data),r=a.parseCSV(r,"\t"),null!=e&&null!=t&&r){for(var s,l=0,u=[],c={},d={},p=0,f=parseInt(e),h=parseInt(t);s=r[l];){for(i=0,f=parseInt(e);null!=s[i];){var m=a.updateCell(f,h,s[i]);if(u.push(m),a.updateFormulaChain(f,h,u),o&&o[p]&&(m=n.getColumnNameFromId([f,h]),c[m]=o[p],d[m]=a.getStyle(m),a.records[h][f].setAttribute("style",o[p]),p++),i++,null!=s[i]){if(f>=a.headers.length-1){if(1!=a.options.allowInsertColumn)break;a.insertColumn()}f=a.right.get(f,h)}}if(l++,r[l]){if(h>=a.rows.length-1){if(1!=a.options.allowInsertRow)break;a.insertRow()}h=a.down.get(e,h)}}a.updateSelectionFromCoords(e,t,f,h),a.setHistory({action:"setValue",records:u,selection:a.selectedCell,newStyle:c,oldStyle:d}),a.updateTable(),a.dispatch("onpaste",q,r),a.onafterchanges(q,u)}a.removeCopyingSelection()},a.removeCopyingSelection=function(){for(var e=document.querySelectorAll(".jexcel .copying"),t=0;t<e.length;t++)e[t].classList.remove("copying"),e[t].classList.remove("copying-left"),e[t].classList.remove("copying-right"),e[t].classList.remove("copying-top"),e[t].classList.remove("copying-bottom")},a.historyProcessRow=function(e,t){var r=t.insertBefore?+t.rowNumber:t.rowNumber+1;if(1==a.options.search&&a.results&&a.results.length!=a.rows.length&&a.resetSearch(),1==e){for(var o=t.numOfRows,i=r;i<o+r;i++)a.rows[i].parentNode.removeChild(a.rows[i]);a.records.splice(r,o),a.options.data.splice(r,o),a.rows.splice(r,o),a.conditionalSelectionUpdate(1,r,o+r-1)}else for(a.records=n.injectArray(a.records,r,t.rowRecords),a.options.data=n.injectArray(a.options.data,r,t.rowData),a.rows=n.injectArray(a.rows,r,t.rowNode),o=0,i=r;i<t.numOfRows+r;i++)a.tbody.insertBefore(t.rowNode[o],a.tbody.children[i]),o++;0<a.options.pagination&&a.page(a.pageNumber),a.updateTableReferences()},a.historyProcessColumn=function(e,t){var r=t.insertBefore?t.columnNumber:t.columnNumber+1;if(1==e){var o=t.numOfColumns;a.options.columns.splice(r,o);for(var i=r;i<o+r;i++)a.headers[i].parentNode.removeChild(a.headers[i]),a.colgroup[i].parentNode.removeChild(a.colgroup[i]);a.headers.splice(r,o),a.colgroup.splice(r,o);for(var s=0;s<t.data.length;s++){for(i=r;i<o+r;i++)a.records[s][i].parentNode.removeChild(a.records[s][i]);a.records[s].splice(r,o),a.options.data[s].splice(r,o)}if(a.options.footers)for(s=0;s<a.options.footers.length;s++)a.options.footers[s].splice(r,o)}else{for(a.options.columns=n.injectArray(a.options.columns,r,t.columns),a.headers=n.injectArray(a.headers,r,t.headers),a.colgroup=n.injectArray(a.colgroup,r,t.colgroup),o=0,i=r;i<t.numOfColumns+r;i++)a.headerContainer.insertBefore(t.headers[o],a.headerContainer.children[i+1]),a.colgroupContainer.insertBefore(t.colgroup[o],a.colgroupContainer.children[i+1]),o++;for(s=0;s<t.data.length;s++)for(a.options.data[s]=n.injectArray(a.options.data[s],r,t.data[s]),a.records[s]=n.injectArray(a.records[s],r,t.records[s]),o=0,i=r;i<t.numOfColumns+r;i++)a.rows[s].insertBefore(t.records[s][o],a.rows[s].children[i+1]),o++;if(a.options.footers)for(s=0;s<a.options.footers.length;s++)a.options.footers[s]=n.injectArray(a.options.footers[s],r,t.footers[s])}if(a.options.nestedHeaders&&0<a.options.nestedHeaders.length)if(a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(s=0;s<a.options.nestedHeaders.length;s++)r=1==e?parseInt(a.options.nestedHeaders[s][a.options.nestedHeaders[s].length-1].colspan)-t.numOfColumns:parseInt(a.options.nestedHeaders[s][a.options.nestedHeaders[s].length-1].colspan)+t.numOfColumns,a.options.nestedHeaders[s][a.options.nestedHeaders[s].length-1].colspan=r,a.thead.children[s].children[a.thead.children[s].children.length-1].setAttribute("colspan",r);else r=1==e?parseInt(a.options.nestedHeaders[0].colspan)-t.numOfColumns:parseInt(a.options.nestedHeaders[0].colspan)+t.numOfColumns,a.options.nestedHeaders[0].colspan=r,a.thead.children[0].children[a.thead.children[0].children.length-1].setAttribute("colspan",r);a.updateTableReferences()},a.undo=function(){var e=!!a.ignoreEvents,t=!!a.ignoreHistory;a.ignoreEvents=!0,a.ignoreHistory=!0;var n=[];if(0<=a.historyIndex){var r=a.history[a.historyIndex--];if("insertRow"==r.action)a.historyProcessRow(1,r);else if("deleteRow"==r.action)a.historyProcessRow(0,r);else if("insertColumn"==r.action)a.historyProcessColumn(1,r);else if("deleteColumn"==r.action)a.historyProcessColumn(0,r);else if("moveRow"==r.action)a.moveRow(r.newValue,r.oldValue);else if("moveColumn"==r.action)a.moveColumn(r.newValue,r.oldValue);else if("setMerge"==r.action)a.removeMerge(r.column,r.data);else if("setStyle"==r.action)a.setStyle(r.oldValue,null,null,1);else if("setWidth"==r.action)a.setWidth(r.column,r.oldValue);else if("setHeight"==r.action)a.setHeight(r.row,r.oldValue);else if("setHeader"==r.action)a.setHeader(r.column,r.oldValue);else if("setComments"==r.action)a.setComments(r.column,r.oldValue[0],r.oldValue[1]);else if("orderBy"==r.action){n=[];for(var o=0;o<r.rows.length;o++)n[r.rows[o]]=o;a.updateOrderArrow(r.column,r.order?0:1),a.updateOrder(n)}else if("setValue"==r.action){for(o=0;o<r.records.length;o++)n.push({x:r.records[o].x,y:r.records[o].y,newValue:r.records[o].oldValue}),r.oldStyle&&a.resetStyle(r.oldStyle);a.setValue(n),r.selection&&a.updateSelectionFromCoords(r.selection[0],r.selection[1],r.selection[2],r.selection[3])}}a.ignoreEvents=e,a.ignoreHistory=t,a.dispatch("onundo",q,r)},a.redo=function(){var e=!!a.ignoreEvents,t=!!a.ignoreHistory;if(a.ignoreEvents=!0,a.ignoreHistory=!0,a.historyIndex<a.history.length-1){var n=a.history[++a.historyIndex];if("insertRow"==n.action)a.historyProcessRow(0,n);else if("deleteRow"==n.action)a.historyProcessRow(1,n);else if("insertColumn"==n.action)a.historyProcessColumn(0,n);else if("deleteColumn"==n.action)a.historyProcessColumn(1,n);else if("moveRow"==n.action)a.moveRow(n.oldValue,n.newValue);else if("moveColumn"==n.action)a.moveColumn(n.oldValue,n.newValue);else if("setMerge"==n.action)a.setMerge(n.column,n.colspan,n.rowspan,1);else if("setStyle"==n.action)a.setStyle(n.newValue,null,null,1);else if("setWidth"==n.action)a.setWidth(n.column,n.newValue);else if("setHeight"==n.action)a.setHeight(n.row,n.newValue);else if("setHeader"==n.action)a.setHeader(n.column,n.newValue);else if("setComments"==n.action)a.setComments(n.column,n.newValue[0],n.newValue[1]);else if("orderBy"==n.action)a.updateOrderArrow(n.column,n.order),a.updateOrder(n.rows);else if("setValue"==n.action){a.setValue(n.records);for(var r=0;r<n.records.length;r++)n.oldStyle&&a.resetStyle(n.newStyle);n.selection&&a.updateSelectionFromCoords(n.selection[0],n.selection[1],n.selection[2],n.selection[3])}}a.ignoreEvents=e,a.ignoreHistory=t,a.dispatch("onredo",q,n)},a.getDropDownValue=function(e,t){var n=[];if(a.options.columns[e]&&a.options.columns[e].source){for(var r=[],o=a.options.columns[e].source,i=0;i<o.length;i++)"object"==typeof o[i]?r[o[i].id]=o[i].name:r[o[i]]=o[i];for(o=Array.isArray(t)?t:(""+t).split(";"),i=0;i<o.length;i++)"object"===typeof o[i]?n.push(r[o[i].id]):r[o[i]]&&n.push(r[o[i]])}else console.error("Invalid column");return 0<n.length?n.join("; "):""},a.parseCSV=function(e,t){e=e.replace(/\r?\n$|\r$|\n$/g,""),9==e.charCodeAt(e.length-1)&&(e+="\0"),t=t||",";for(var n=[],r=!1,a=0,o=0,i=0;i<e.length;i++){var s=e[i],l=e[i+1];n[a]=n[a]||[],n[a][o]=n[a][o]||"",'"'==s&&r&&'"'==l?(n[a][o]+=s,++i):'"'==s?r=!r:s!=t||r?"\r"!=s||"\n"!=l||r?("\n"!=s||r)&&("\r"!=s||r)?n[a][o]+=s:(++a,o=0):(++a,o=0,++i):++o}return n},a.hash=function(e){var t,n=0;if(0!==e.length)for(t=0;t<e.length;t++){var r=e.charCodeAt(t);n=(n<<5)-n+r,n|=0}return n},a.onafterchanges=function(e,t){a.dispatch("onafterchanges",e,t)},a.destroy=function(){n.destroy(q)},a.init=function(){n.current=a,"function"==typeof n.build&&(a.options.root?n.build(a.options.root):(n.build(document),n.build=null)),q.setAttribute("tabindex",1),q.addEventListener("focus",(function(e){n.current&&!a.selectedCell&&(a.updateSelectionFromCoords(0,0,0,0),a.left())})),a.options.csv?(1==a.options.loadingSpin&&r.loading.show(),r.ajax({url:a.options.csv,method:a.options.method,data:a.options.requestVariables,dataType:"text",success:function(e){if(e=a.parseCSV(e,a.options.csvDelimiter),1==a.options.csvHeaders&&0<e.length)for(var t=e.shift(),n=0;n<t.length;n++)a.options.columns[n]||(a.options.columns[n]={type:"text",align:a.options.defaultColAlign,width:a.options.defaultColWidth}),"undefined"===typeof a.options.columns[n].title&&(a.options.columns[n].title=t[n]);a.options.data=e,a.prepareTable(),1==a.options.loadingSpin&&r.loading.hide()}})):a.options.url?(1==a.options.loadingSpin&&r.loading.show(),r.ajax({url:a.options.url,method:a.options.method,data:a.options.requestVariables,dataType:"json",success:function(e){a.options.data=e.data?e.data:e,a.prepareTable(),1==a.options.loadingSpin&&r.loading.hide()}})):a.prepareTable()},a.options.contextMenu=y&&null!=y.contextMenu?y.contextMenu:function(e,t,r,o){if(e=[],null==r)1==a.options.allowInsertColumn&&e.push({title:a.options.text.insertANewColumnBefore,onclick:function(){a.insertColumn(1,parseInt(t),1)}}),1==a.options.allowInsertColumn&&e.push({title:a.options.text.insertANewColumnAfter,onclick:function(){a.insertColumn(1,parseInt(t),0)}}),1==a.options.allowDeleteColumn&&e.push({title:a.options.text.deleteSelectedColumns,onclick:function(){a.deleteColumn(a.getSelectedColumns().length?void 0:parseInt(t))}}),1==a.options.allowRenameColumn&&e.push({title:a.options.text.renameThisColumn,onclick:function(){a.setHeader(t)}}),1==a.options.columnSorting&&(e.push({type:"line"}),e.push({title:a.options.text.orderAscending,onclick:function(){a.orderBy(t,0)}}),e.push({title:a.options.text.orderDescending,onclick:function(){a.orderBy(t,1)}}));else if(1==a.options.allowInsertRow&&(e.push({title:a.options.text.insertANewRowBefore,onclick:function(){a.insertRow(1,parseInt(r),1)}}),e.push({title:a.options.text.insertANewRowAfter,onclick:function(){a.insertRow(1,parseInt(r))}})),1==a.options.allowDeleteRow&&e.push({title:a.options.text.deleteSelectedRows,onclick:function(){a.deleteRow(a.getSelectedRows().length?void 0:parseInt(r))}}),t&&1==a.options.allowComments){e.push({type:"line"});var i=a.records[r][t].getAttribute("title")||"";e.push({title:i?a.options.text.editComments:a.options.text.addComments,onclick:function(){var e=prompt(a.options.text.comments,i);e&&a.setComments([t,r],e)}}),i&&e.push({title:a.options.text.clearComments,onclick:function(){a.setComments([t,r],"")}})}return e.push({type:"line"}),e.push({title:a.options.text.copy,shortcut:"Ctrl + C",onclick:function(){a.copy(!0)}}),navigator&&navigator.clipboard&&e.push({title:a.options.text.paste,shortcut:"Ctrl + V",onclick:function(){a.selectedCell&&navigator.clipboard.readText().then((function(e){e&&n.current.paste(a.selectedCell[0],a.selectedCell[1],e)}))}}),a.options.allowExport&&e.push({title:a.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){a.download()}}),a.options.about&&e.push({title:a.options.text.about,onclick:function(){!0===a.options.about?alert(k().print()):alert(a.options.about)}}),e},a.scrollControls=function(e){a.wheelControls(),0<a.options.freezeColumns&&a.content.scrollLeft!=f&&a.updateFreezePosition(),(1==a.options.lazyLoading||1==a.options.tableOverflow)&&a.edition&&"jdropdown"!=e.target.className.substr(0,9)&&a.closeEditor(a.edition[0],!0)},a.wheelControls=function(e){1==a.options.lazyLoading&&null==n.timeControlLoading&&(n.timeControlLoading=setTimeout((function(){a.content.scrollTop+a.content.clientHeight>=a.content.scrollHeight-10?a.loadDown()&&(a.content.scrollTop+a.content.clientHeight>a.content.scrollHeight-10&&(a.content.scrollTop-=a.content.clientHeight),a.updateCornerPosition()):a.content.scrollTop<=a.content.clientHeight&&a.loadUp()&&(10>a.content.scrollTop&&(a.content.scrollTop+=a.content.clientHeight),a.updateCornerPosition()),n.timeControlLoading=null}),100))},a.getFreezeWidth=function(){var e=0;if(0<a.options.freezeColumns)for(var t=0;t<a.options.freezeColumns;t++)e+=parseInt(a.options.columns[t].width);return e};var f=0;return a.updateFreezePosition=function(){f=a.content.scrollLeft;var e=0;if(50<f)for(var t=0;t<a.options.freezeColumns;t++){0<t&&(e+=parseInt(a.options.columns[t-1].width)),a.headers[t].classList.add("jexcel_freezed"),a.headers[t].style.left=e+"px";for(var n=0;n<a.rows.length;n++)if(a.rows[n]&&a.records[n][t]){var r=f+(0<t?a.records[n][t-1].style.width:0)-51+"px";a.records[n][t].classList.add("jexcel_freezed"),a.records[n][t].style.left=r}}else for(t=0;t<a.options.freezeColumns;t++)for(a.headers[t].classList.remove("jexcel_freezed"),a.headers[t].style.left="",n=0;n<a.rows.length;n++)a.records[n][t]&&(a.records[n][t].classList.remove("jexcel_freezed"),a.records[n][t].style.left="");a.updateCornerPosition()},q.addEventListener("DOMMouseScroll",a.wheelControls),q.addEventListener("mousewheel",a.wheelControls),q.jexcel=a,q.jspreadsheet=a,a.init(),a};return n.setDictionary=function(e){r.setDictionary(e)},n.setExtensions=function(e){for(var t=Object.keys(e),r=0;r<t.length;r++)"function"===typeof e[t[r]]&&(n[t[r]]=e[t[r]],n.license&&"function"==typeof e[t[r]].license&&e[t[r]].license(n.license))},n.formula=w,n.version=k,n.current=null,n.timeControl=null,n.timeControlLoading=null,n.destroy=function(e,t){if(e.jexcel){var r=e.jexcel.options.root?e.jexcel.options.root:document;e.removeEventListener("DOMMouseScroll",e.jexcel.scrollControls),e.removeEventListener("mousewheel",e.jexcel.scrollControls),e.jexcel=null,e.innerHTML="",t&&(r.removeEventListener("mouseup",n.mouseUpControls),r.removeEventListener("mousedown",n.mouseDownControls),r.removeEventListener("mousemove",n.mouseMoveControls),r.removeEventListener("mouseover",n.mouseOverControls),r.removeEventListener("dblclick",n.doubleClickControls),r.removeEventListener("paste",n.pasteControls),r.removeEventListener("contextmenu",n.contextMenuControls),r.removeEventListener("touchstart",n.touchStartControls),r.removeEventListener("touchend",n.touchEndControls),r.removeEventListener("touchcancel",n.touchEndControls),document.removeEventListener("keydown",n.keyDownControls),n=null)}},n.build=function(e){e.addEventListener("mouseup",n.mouseUpControls),e.addEventListener("mousedown",n.mouseDownControls),e.addEventListener("mousemove",n.mouseMoveControls),e.addEventListener("mouseover",n.mouseOverControls),e.addEventListener("dblclick",n.doubleClickControls),e.addEventListener("paste",n.pasteControls),e.addEventListener("contextmenu",n.contextMenuControls),e.addEventListener("touchstart",n.touchStartControls),e.addEventListener("touchend",n.touchEndControls),e.addEventListener("touchcancel",n.touchEndControls),e.addEventListener("touchmove",n.touchEndControls),document.addEventListener("keydown",n.keyDownControls)},n.keyDownControls=function(e){if(n.current){if(n.current.edition)if(27==e.which)n.current.edition&&n.current.closeEditor(n.current.edition[0],!1),e.preventDefault();else if(13==e.which){if("calendar"==n.current.options.columns[n.current.edition[2]].type)n.current.closeEditor(n.current.edition[0],!0);else if("dropdown"!=n.current.options.columns[n.current.edition[2]].type&&"autocomplete"!=n.current.options.columns[n.current.edition[2]].type)if((1==n.current.options.wordWrap||1==n.current.options.columns[n.current.edition[2]].wordWrap||200<n.current.options.data[n.current.edition[3]][n.current.edition[2]].length)&&e.altKey){var t=n.current.edition[0].children[0],r=n.current.edition[0].children[0].value,a=t.selectionStart;r=r.slice(0,a)+"\n"+r.slice(a),t.value=r,t.focus(),t.selectionStart=a+1,t.selectionEnd=a+1}else n.current.edition[0].children[0].blur()}else 9==e.which&&("calendar"==n.current.options.columns[n.current.edition[2]].type?n.current.closeEditor(n.current.edition[0],!0):n.current.edition[0].children[0].blur());!n.current.edition&&n.current.selectedCell?37==e.which?(n.current.left(e.shiftKey,e.ctrlKey),e.preventDefault()):39==e.which?(n.current.right(e.shiftKey,e.ctrlKey),e.preventDefault()):38==e.which?(n.current.up(e.shiftKey,e.ctrlKey),e.preventDefault()):40==e.which?(n.current.down(e.shiftKey,e.ctrlKey),e.preventDefault()):36==e.which?(n.current.first(e.shiftKey,e.ctrlKey),e.preventDefault()):35==e.which?(n.current.last(e.shiftKey,e.ctrlKey),e.preventDefault()):32==e.which?(1==n.current.options.editable&&n.current.setCheckRadioValue(),e.preventDefault()):46==e.which?1==n.current.options.editable&&(n.current.selectedRow?1==n.current.options.allowDeleteRow&&confirm(n.current.options.text.areYouSureToDeleteTheSelectedRows)&&n.current.deleteRow():n.current.selectedHeader?1==n.current.options.allowDeleteColumn&&confirm(n.current.options.text.areYouSureToDeleteTheSelectedColumns)&&n.current.deleteColumn():n.current.setValue(n.current.highlighted,"")):13==e.which?(e.shiftKey?n.current.up():(1==n.current.options.allowInsertRow&&1==n.current.options.allowManualInsertRow&&n.current.selectedCell[1]==n.current.options.data.length-1&&n.current.insertRow(),n.current.down()),e.preventDefault()):9==e.which?(e.shiftKey?n.current.left():(1==n.current.options.allowInsertColumn&&1==n.current.options.allowManualInsertColumn&&n.current.selectedCell[0]==n.current.options.data[0].length-1&&n.current.insertColumn(),n.current.right()),e.preventDefault()):!e.ctrlKey&&!e.metaKey||e.shiftKey?n.current.selectedCell&&1==n.current.options.editable&&(t=n.current.selectedCell[1],r=n.current.selectedCell[0],"readonly"!=n.current.options.columns[r].type)&&(32==e.keyCode?"checkbox"==n.current.options.columns[r].type||"radio"==n.current.options.columns[r].type?e.preventDefault():n.current.openEditor(n.current.records[t][r],!0):113==e.keyCode?n.current.openEditor(n.current.records[t][r],!1):(8==e.keyCode||48<=e.keyCode&&57>=e.keyCode||96<=e.keyCode&&111>=e.keyCode||187<=e.keyCode&&190>=e.keyCode||(String.fromCharCode(e.keyCode)==e.key||String.fromCharCode(e.keyCode).toLowerCase()==e.key.toLowerCase())&&n.validLetter(String.fromCharCode(e.keyCode)))&&(n.current.openEditor(n.current.records[t][r],!0),"calendar"==n.current.options.columns[r].type&&e.preventDefault())):65==e.which?(n.current.selectAll(),e.preventDefault()):83==e.which?(n.current.download(),e.preventDefault()):89==e.which?(n.current.redo(),e.preventDefault()):90==e.which?(n.current.undo(),e.preventDefault()):67==e.which?(n.current.copy(!0),e.preventDefault()):88==e.which?(1==n.current.options.editable?n.cutControls():n.copyControls(),e.preventDefault()):86==e.which&&n.pasteControls():e.target.classList.contains("jexcel_search")&&(n.timeControl&&clearTimeout(n.timeControl),n.timeControl=setTimeout((function(){n.current.search(e.target.value)}),200))}},n.isMouseAction=!1,n.mouseDownControls=function(e){e=e||window.event;var t=e.buttons?e.buttons:e.button?e.button:e.which,r=n.getElement(e.target);if(r[0]?n.current!=r[0].jexcel&&(n.current&&(n.current.edition&&n.current.closeEditor(n.current.edition[0],!0),n.current.resetSelection()),n.current=r[0].jexcel):n.current&&(n.current.edition&&n.current.closeEditor(n.current.edition[0],!0),n.current.resetSelection(!0),n.current=null),n.current&&1==t){if(e.target.classList.contains("jexcel_selectall"))n.current&&n.current.selectAll();else if(e.target.classList.contains("jexcel_corner"))1==n.current.options.editable&&(n.current.selectedCorner=!0);else{if(1==r[1]){var a=e.target.getAttribute("data-x");if(a)if(t=e.target.getBoundingClientRect(),1==n.current.options.columnResize&&6>t.width-e.offsetX)for(n.current.resizing={mousePosition:e.pageX,column:a,width:t.width},n.current.headers[a].classList.add("resizing"),t=0;t<n.current.records.length;t++)n.current.records[t][a]&&n.current.records[t][a].classList.add("resizing");else if(1==n.current.options.columnDrag&&6>t.height-e.offsetY)if(n.current.isColMerged(a).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(n.current.resetSelection(),n.current.dragging={element:e.target,column:a,destination:a},n.current.headers[a].classList.add("dragging"),t=0;t<n.current.records.length;t++)n.current.records[t][a]&&n.current.records[t][a].classList.add("dragging");else{if(n.current.selectedHeader&&(e.shiftKey||e.ctrlKey)){t=n.current.selectedHeader;var o=a}else n.current.selectedHeader==a&&1==n.current.options.allowRenameColumn&&(n.timeControl=setTimeout((function(){n.current.setHeader(a)}),800)),o=t=n.current.selectedHeader=a;n.current.updateSelectionFromCoords(t,0,o,n.current.options.data.length-1)}else e.target.parentNode.classList.contains("jexcel_nested")&&(e.target.getAttribute("data-column")?(o=e.target.getAttribute("data-column").split(","),t=parseInt(o[0]),o=parseInt(o[o.length-1])):(t=0,o=n.current.options.columns.length-1),n.current.updateSelectionFromCoords(t,0,o,n.current.options.data.length-1))}else n.current.selectedHeader=!1;if(2==r[1])if(r=e.target.getAttribute("data-y"),e.target.classList.contains("jexcel_row"))t=e.target.getBoundingClientRect(),1==n.current.options.rowResize&&6>t.height-e.offsetY?(n.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:r,height:t.height},e.target.parentNode.classList.add("resizing")):1==n.current.options.rowDrag&&6>t.width-e.offsetX?n.current.isRowMerged(r).length?console.error("Jspreadsheet: This row is part of a merged cell"):1==n.current.options.search&&n.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(n.current.resetSelection(),n.current.dragging={element:e.target.parentNode,row:r,destination:r},e.target.parentNode.classList.add("dragging")):(t=n.current.selectedRow&&(e.shiftKey||e.ctrlKey)?n.current.selectedRow:n.current.selectedRow=r,n.current.updateSelectionFromCoords(0,t,n.current.options.data[0].length-1,r));else if(e.target.classList.contains("jclose")&&50>e.target.clientWidth-e.offsetX&&50>e.offsetY)n.current.closeEditor(n.current.edition[0],!0);else{var i=function(e){var t=e.getAttribute("data-x"),n=e.getAttribute("data-y");return t&&n?[t,n]:e.parentNode?i(e.parentNode):void 0};(r=i(e.target))&&(a=r[0],r=r[1],n.current.edition&&(n.current.edition[2]!=a||n.current.edition[3]!=r)&&n.current.closeEditor(n.current.edition[0],!0),n.current.edition||(e.shiftKey?n.current.updateSelectionFromCoords(n.current.selectedCell[0],n.current.selectedCell[1],a,r):n.current.updateSelectionFromCoords(a,r)),n.current.selectedHeader=null,n.current.selectedRow=null)}else n.current.selectedRow=!1;e.target.classList.contains("jexcel_page")&&("<"==e.target.innerText?n.current.page(0):">"==e.target.innerText?n.current.page(e.target.getAttribute("title")-1):n.current.page(e.target.innerText-1))}n.isMouseAction=!n.current.edition}else n.isMouseAction=!1},n.mouseUpControls=function(e){if(n.current)if(n.current.resizing){if(n.current.resizing.column){e=n.current.colgroup[n.current.resizing.column].getAttribute("width");var t=n.current.getSelectedColumns();if(1<t.length){for(var r=[],a=0;a<t.length;a++)r.push(parseInt(n.current.colgroup[t[a]].getAttribute("width")));a=t.indexOf(parseInt(n.current.resizing.column)),r[a]=n.current.resizing.width,n.current.setWidth(t,e,r)}else n.current.setWidth(n.current.resizing.column,e,n.current.resizing.width);for(n.current.headers[n.current.resizing.column].classList.remove("resizing"),t=0;t<n.current.records.length;t++)n.current.records[t][n.current.resizing.column]&&n.current.records[t][n.current.resizing.column].classList.remove("resizing")}else n.current.rows[n.current.resizing.row].children[0].classList.remove("resizing"),e=n.current.rows[n.current.resizing.row].getAttribute("height"),n.current.setHeight(n.current.resizing.row,e,n.current.resizing.height),n.current.resizing.element.classList.remove("resizing");n.current.resizing=null}else if(n.current.dragging){if(n.current.dragging){if(n.current.dragging.column){for(e=e.target.getAttribute("data-x"),n.current.headers[n.current.dragging.column].classList.remove("dragging"),t=0;t<n.current.rows.length;t++)n.current.records[t][n.current.dragging.column]&&n.current.records[t][n.current.dragging.column].classList.remove("dragging");for(a=0;a<n.current.headers.length;a++)n.current.headers[a].classList.remove("dragging-left"),n.current.headers[a].classList.remove("dragging-right");e&&n.current.dragging.column!=n.current.dragging.destination&&n.current.moveColumn(n.current.dragging.column,n.current.dragging.destination)}else n.current.dragging.element.nextSibling?(e=parseInt(n.current.dragging.element.nextSibling.getAttribute("data-y")),n.current.dragging.row<e&&--e):e=parseInt(n.current.dragging.element.previousSibling.getAttribute("data-y")),n.current.dragging.row!=n.current.dragging.destination&&n.current.moveRow(n.current.dragging.row,e,!0),n.current.dragging.element.classList.remove("dragging");n.current.dragging=null}}else n.current.selectedCorner&&(n.current.selectedCorner=!1,0<n.current.selection.length&&(n.current.copyData(n.current.selection[0],n.current.selection[n.current.selection.length-1]),n.current.removeCopySelection()));n.timeControl&&(clearTimeout(n.timeControl),n.timeControl=null),n.isMouseAction=!1},n.mouseMoveControls=function(e){if(e=e||window.event,e.buttons||e.button||e.which||(n.isMouseAction=!1),n.current)if(1==n.isMouseAction)n.current.resizing&&(n.current.resizing.column?(e=e.pageX-n.current.resizing.mousePosition,0<n.current.resizing.width+e&&(n.current.colgroup[n.current.resizing.column].setAttribute("width",n.current.resizing.width+e),n.current.updateCornerPosition())):(e=e.pageY-n.current.resizing.mousePosition,0<n.current.resizing.height+e&&(n.current.rows[n.current.resizing.row].setAttribute("height",n.current.resizing.height+e),n.current.updateCornerPosition())));else{var t=e.target.getAttribute("data-x"),r=e.target.getAttribute("data-y"),a=e.target.getBoundingClientRect();n.current.cursor&&(n.current.cursor.style.cursor="",n.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&t&&!r&&6>a.width-(e.clientX-a.left)?(n.current.cursor=e.target,n.current.cursor.style.cursor="col-resize"):e.target&&!t&&r&&6>a.height-(e.clientY-a.top)&&(n.current.cursor=e.target,n.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable")&&(e.target&&!t&&r&&6>a.width-(e.clientX-a.left)||e.target&&t&&!r&&6>a.height-(e.clientY-a.top))&&(n.current.cursor=e.target,n.current.cursor.style.cursor="move"))}},n.mouseOverControls=function(e){if(e=e||window.event,e.buttons||e.button||e.which||(n.isMouseAction=!1),n.current&&1==n.isMouseAction){var t=n.getElement(e.target);if(t[0]){if(n.current!=t[0].jexcel&&n.current)return!1;var r=e.target.getAttribute("data-x"),a=e.target.getAttribute("data-y");if(n.current.dragging)if(n.current.dragging.column){if(r)if(n.current.isColMerged(r).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(t=0;t<n.current.headers.length;t++)n.current.headers[t].classList.remove("dragging-left"),n.current.headers[t].classList.remove("dragging-right");n.current.dragging.column==r?n.current.dragging.destination=parseInt(r):e.target.clientWidth/2>e.offsetX?(n.current.dragging.destination=n.current.dragging.column<r?parseInt(r)-1:parseInt(r),n.current.headers[r].classList.add("dragging-left")):(n.current.dragging.destination=n.current.dragging.column<r?parseInt(r):parseInt(r)+1,n.current.headers[r].classList.add("dragging-right"))}}else a&&(n.current.isRowMerged(a).length?console.error("Jspreadsheet: This row is part of a merged cell."):(r=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode,n.current.dragging.element!=r&&(e.target.parentNode.parentNode.insertBefore(n.current.dragging.element,r),n.current.dragging.destination=Array.prototype.indexOf.call(n.current.dragging.element.parentNode.children,n.current.dragging.element))));else if(!n.current.resizing){if(1==t[1]&&n.current.selectedHeader){r=e.target.getAttribute("data-x");var o=n.current.selectedHeader;n.current.updateSelectionFromCoords(o,0,r,n.current.options.data.length-1)}2==t[1]&&(e.target.classList.contains("jexcel_row")?n.current.selectedRow&&(o=n.current.selectedRow,n.current.updateSelectionFromCoords(0,o,n.current.options.data[0].length-1,a)):n.current.edition||r&&a&&(n.current.selectedCorner?n.current.updateCopySelection(r,a):n.current.selectedCell&&n.current.updateSelectionFromCoords(n.current.selectedCell[0],n.current.selectedCell[1],r,a)))}}}n.timeControl&&(clearTimeout(n.timeControl),n.timeControl=null)},n.doubleClickControls=function(e){if(n.current)if(e.target.classList.contains("jexcel_corner")){if(0<n.current.highlighted.length){e=n.current.highlighted[0].getAttribute("data-x");var t=parseInt(n.current.highlighted[n.current.highlighted.length-1].getAttribute("data-y"))+1,r=n.current.highlighted[n.current.highlighted.length-1].getAttribute("data-x");n.current.copyData(n.current.records[t][e],n.current.records[n.current.records.length-1][r])}}else if(e.target.classList.contains("jexcel_column_filter"))t=e.target.getAttribute("data-x"),n.current.openFilter(t);else if(r=n.getElement(e.target),1==r[1]&&1==n.current.options.columnSorting&&(t=e.target.getAttribute("data-x"))&&n.current.orderBy(t),2==r[1]&&1==n.current.options.editable&&!n.current.edition){var a=function(e){if(e.parentNode){var t=e.getAttribute("data-x"),n=e.getAttribute("data-y");return t&&n?e:a(e.parentNode)}};(e=a(e.target))&&e.classList.contains("highlight")&&n.current.openEditor(e)}},n.copyControls=function(e){n.current&&n.copyControls.enabled&&(n.current.edition||n.current.copy(!0))},n.cutControls=function(e){n.current&&!n.current.edition&&(n.current.copy(!0),1==n.current.options.editable&&n.current.setValue(n.current.highlighted,""))},n.pasteControls=function(e){n.current&&n.current.selectedCell&&!n.current.edition&&1==n.current.options.editable&&(e&&e.clipboardData?(n.current.paste(n.current.selectedCell[0],n.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&n.current.paste(n.current.selectedCell[0],n.current.selectedCell[1],window.clipboardData.getData("text")))},n.contextMenuControls=function(e){if(e=e||window.event,n.current)if(n.current.edition)e.preventDefault();else if(n.current.options.contextMenu&&(n.current.contextMenu.contextmenu.close(),n.current)){var t=e.target.getAttribute("data-x"),r=e.target.getAttribute("data-y");(t||r)&&((t<parseInt(n.current.selectedCell[0])||t>parseInt(n.current.selectedCell[2])||r<parseInt(n.current.selectedCell[1])||r>parseInt(n.current.selectedCell[3]))&&n.current.updateSelectionFromCoords(t,r,t,r),t=n.current.options.contextMenu(n.current,t,r,e),n.current.contextMenu.contextmenu.open(e,t),e.preventDefault())}},n.touchStartControls=function(e){var t=n.getElement(e.target);if(t[0]?n.current!=t[0].jexcel&&(n.current&&n.current.resetSelection(),n.current=t[0].jexcel):n.current&&(n.current.resetSelection(),n.current=null),n.current&&!n.current.edition){var r=e.target.getAttribute("data-x");t=e.target.getAttribute("data-y"),r&&t&&(n.current.updateSelectionFromCoords(r,t),n.timeControl=setTimeout((function(){n.tmpElement="color"==n.current.options.columns[r].type?null:e.target,n.current.openEditor(e.target,!1,e)}),500))}},n.touchEndControls=function(e){n.timeControl&&(clearTimeout(n.timeControl),n.timeControl=null,n.tmpElement&&"INPUT"==n.tmpElement.children[0].tagName&&n.tmpElement.children[0].focus(),n.tmpElement=null)},n.tabs=function(e,t){var r=[];if(e.classList.contains("jexcel_tabs"))o=e.children[0],i=e.children[1];else{e.innerHTML="",e.classList.add("jexcel_tabs"),e.jexcel=[];var a=document.createElement("div"),o=e.appendChild(a);a=document.createElement("div");var i=e.appendChild(a)}a=[];for(var s=[],l=0;l<t.length;l++){a[l]=document.createElement("div"),a[l].classList.add("jexcel_tab");var u=n(a[l],t[l]);i.appendChild(a[l]),r[l]=e.jexcel.push(u),s[l]=document.createElement("div"),s[l].classList.add("jexcel_tab_link"),s[l].setAttribute("data-spreadsheet",e.jexcel.length-1),s[l].innerHTML=t[l].sheetName,s[l].onclick=function(){for(var e=0;e<o.children.length;e++)o.children[e].classList.remove("selected"),i.children[e].style.display="none";e=this.getAttribute("data-spreadsheet"),i.children[e].style.display="block",o.children[e].classList.add("selected")},o.appendChild(s[l])}for(a=0;a<o.children.length;a++)o.children[a].classList.remove("selected"),i.children[a].style.display="none";return o.children[o.children.length-1].classList.add("selected"),i.children[o.children.length-1].style.display="block",r},n.createTabs=n.tabs,n.fromSpreadsheet=function(e,t){var r=function(e){var t=[];return e.SheetNames.forEach((function(r){var a={rows:[],columns:[],data:[],style:{}};a.sheetName=r;var o=e.Sheets[r]["!cols"];if(o&&o.length)for(var i=0;i<o.length;i++)a.columns[i]={},o[i]&&o[i].wpx&&(a.columns[i].width=o[i].wpx+"px");if((o=e.Sheets[r]["!rows"])&&o.length)for(i=0;i<o.length;i++)o[i]&&o[i].hpx&&(a.rows[i]={},a.rows[i].height=o[i].hpx+"px");if((o=e.Sheets[r]["!merges"])&&0<o.length)for(a.mergeCells=[],i=0;i<o.length;i++){var s=o[i].s.c,l=o[i].s.r,u=o[i].e.c,c=o[i].e.r,d=n.getColumnNameFromId([s,l]);a.mergeCells[d]=[u-s+1,c-l+1]}for(l=s=0,o=Object.keys(e.Sheets[r]),i=0;i<o.length;i++)"!"!=o[i].substr(0,1)&&(u=e.Sheets[r][o[i]],c=n.getIdFromColumnName(o[i],!0),a.data[c[1]]||(a.data[c[1]]=[]),a.data[c[1]][c[0]]=u.f?"="+u.f:u.w,s<c[0]&&(s=c[0]),l<c[1]&&(l=c[1]),u.style&&0<Object.keys(u.style).length&&(a.style[o[i]]=u.style),u.s&&u.s.fgColor&&(a.style[o[i]]&&(a.style[o[i]]+=";"),a.style[o[i]]+="background-color:#"+u.s.fgColor.rgb));for(r=a.columns,o=0;o<=l;o++)for(i=0;i<=s;i++)a.data[o]||(a.data[o]=[]),a.data[o][i]||r<i&&(a.data[o][i]="");t.push(a)})),t},a=new XMLHttpRequest;a.open("GET",e,!0),"undefined"!==typeof Uint8Array?(a.responseType="arraybuffer",a.onload=function(e){e=new Uint8Array(a.response),e=XLSX.read(e,{type:"array",cellFormula:!0,cellStyles:!0}),t(r(e))}):(a.setRequestHeader("Accept-Charset","x-user-defined"),a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var e=convertResponseBodyToText(a.responseBody);e=XLSX.read(e,{type:"binary",cellFormula:!0,cellStyles:!0}),t(r(e))}}),a.send()},n.validLetter=function(e){return e.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},n.injectArray=function(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))},n.getColumnName=function(e){var t="";return 701<e?(t+=String.fromCharCode(64+parseInt(e/676)),t+=String.fromCharCode(64+parseInt(e%676/26))):25<e&&(t+=String.fromCharCode(64+parseInt(e/26))),t+String.fromCharCode(65+e%26)},n.getIdFromColumnName=function(e,t){var n=/^[a-zA-Z]+/.exec(e);if(n){for(var r=0,a=0;a<n[0].length;a++)r+=parseInt(n[0].charCodeAt(a)-64)*Math.pow(26,n[0].length-1-a);r--,0>r&&(r=0),n=parseInt(/[0-9]+$/.exec(e)),0<n&&n--,e=1==t?[r,n]:r+"-"+n}return e},n.getColumnNameFromId=function(e){return Array.isArray(e)||(e=e.split("-")),n.getColumnName(parseInt(e[0]))+(parseInt(e[1])+1)},n.getElement=function(e){function t(e){e.className&&e.classList.contains("jexcel_container")&&(r=e),"THEAD"==e.tagName?n=1:"TBODY"==e.tagName&&(n=2),e.parentNode&&(r||t(e.parentNode))}var n=0,r=0;return t(e),[r,n]},n.doubleDigitFormat=function(e){return e=""+e,1==e.length&&(e="0"+e),e},n.createFromTable=function(e,t){if("TABLE"==e.tagName){t||(t={}),t.columns=[],t.data=[];var r=e.querySelectorAll("colgroup > col");if(r.length)for(var a=0;a<r.length;a++){var o=r[a].style.width;o||(o=r[a].getAttribute("width")),o&&(t.columns[a]||(t.columns[a]={}),t.columns[a].width=o)}o=function(e){var n=e.getBoundingClientRect();n=50<n.width?n.width:50,t.columns[a]||(t.columns[a]={}),e.getAttribute("data-celltype")?t.columns[a].type=e.getAttribute("data-celltype"):t.columns[a].type="text",t.columns[a].width=n+"px",t.columns[a].title=e.innerHTML,t.columns[a].align=e.style.textAlign||"center",(n=e.getAttribute("name"))&&(t.columns[a].name=n),(n=e.getAttribute("id"))&&(t.columns[a].id=n)};var i=[],s=e.querySelectorAll(":scope > thead > tr");if(s.length){for(r=0;r<s.length-1;r++){var l=[];for(a=0;a<s[r].children.length;a++){var u={title:s[r].children[a].innerText,colspan:s[r].children[a].getAttribute("colspan")||1};l.push(u)}i.push(l)}for(s=s[s.length-1].children,a=0;a<s.length;a++)o(s[a])}u=0;var c={},d={},p={},f={};for(l=e.querySelectorAll(":scope > tr, :scope > tbody > tr"),r=0;r<l.length;r++)if(t.data[u]=[],1!=t.parseTableFirstRowAsHeader||s.length||0!=r){for(a=0;a<l[r].children.length;a++){var h=l[r].children[a].getAttribute("data-formula");h?"="!=h.substr(0,1)&&(h="="+h):h=l[r].children[a].innerHTML,t.data[u].push(h),h=n.getColumnNameFromId([a,r]);var m=l[r].children[a].getAttribute("class");m&&(f[h]=m),m=parseInt(l[r].children[a].getAttribute("colspan"))||0;var g=parseInt(l[r].children[a].getAttribute("rowspan"))||0;(m||g)&&(c[h]=[m||1,g||1]),(m=l[r].children[a].style&&"none"==l[r].children[a].style.display)&&(l[r].children[a].style.display=""),(m=l[r].children[a].getAttribute("style"))&&(p[h]=m),l[r].children[a].classList.contains("styleBold")&&(p[h]=p[h]?p[h]+"; font-weight:bold;":"font-weight:bold;")}l[r].style&&l[r].style.height&&(d[r]={height:l[r].style.height}),u++}else for(a=0;a<l[r].children.length;a++)o(l[r].children[a]);if(0<Object.keys(i).length&&(t.nestedHeaders=i),0<Object.keys(p).length&&(t.style=p),0<Object.keys(c).length&&(t.mergeCells=c),0<Object.keys(d).length&&(t.rows=d),0<Object.keys(f).length&&(t.classes=f),l=e.querySelectorAll("tfoot tr"),l.length){for(o=[],r=0;r<l.length;r++){for(i=[],a=0;a<l[r].children.length;a++)i.push(l[r].children[a].innerText);o.push(i)}0<Object.keys(o).length&&(t.footers=o)}if(1==t.parseTableAutoCellType)for(o=[],a=0;a<t.columns.length;a++){for(s=i=!0,o[a]=[],r=0;r<t.data.length;r++)h=t.data[r][a],o[a][h]||(o[a][h]=0),o[a][h]++,25<h.length&&(i=!1),10==h.length&&"-"==h.substr(4,1)&&"-"==h.substr(7,1)||(s=!1);r=Object.keys(o[a]).length,s?t.columns[a].type="calendar":1==i&&1<r&&r<=parseInt(.1*t.data.length)&&(t.columns[a].type="dropdown",t.columns[a].source=Object.keys(o[a]))}return t}console.log("Element is not a table")},"undefined"!=typeof jQuery&&function(e){e.fn.jspreadsheet=e.fn.jexcel=function(t){var r=e(this).get(0);return r.jexcel?Array.isArray(r.jexcel)?r.jexcel[t][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):r.jexcel[t].apply(this,Array.prototype.slice.call(arguments,1)):n(e(this).get(0),arguments[0])}}(jQuery),n}))},{"@jspreadsheet/formula":1,jsuites:2}]},{},[3])(3)}))},"4fad":function(e,t,n){var r=n("23e7"),a=n("6f53").entries;r({target:"Object",stat:!0},{entries:function(e){return a(e)}})},5221:function(e,t,n){},db4a:function(e,t,n){"use strict";n.r(t);n("ac1f"),n("5319"),n("4fad");var r,a,o=n("35ea"),i=n.n(o),s=(n("5221"),n("fece"),{props:{value:Array},data:function(){return{instance:null}},render:function(e){for(var t=this,n=function(e){return e.toLowerCase().replace(/([-_][a-z])/g,(function(e){return e.toUpperCase().replace("-","")}))},r={},a=0,o=Object.entries(this.$attrs);a<o.length;a++){var s=o[a];r[n(s[0])]=s[1]}var l=e("div");return this.$nextTick((function(){t.instance?t.instance.setData(r.data):(t.instance=i()(l.elm,r),Object.assign(t,t.instance))})),e("el-scrollbar",{},[l])}}),l=s,u=n("2877"),c=Object(u["a"])(l,r,a,!1,null,null,null);t["default"]=c.exports},fece:function(e,t,n){}}]);
//# sourceMappingURL=chunk-4370a6d1.4eee29d5.js.map