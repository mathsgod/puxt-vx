import{_ as C,r as s,o as c,d as V,w as o,a as n,b as e,c as u,t as W,j as U,k as m,e as a}from"./index.3443763f.js";const S={data(){return{whitelist:[],has_two_step:!1,qr_code:null,code:null,secret:null,on_off:!1,ip_address:""}},async created(){let{data:t}=await this.$vx.get("setting-2step");this.has_two_step=t.has_two_step,this.on_off=t.has_two_step,this.whitelist=t.whitelist,this.ip_address=t.ip_address},computed:{show_setting(){return!!(this.on_off&&!this.has_two_step)}},watch:{async on_off(){if(this.on_off){let t=(await this.$vx.get("User/setting-2step?_entry=qrcode")).data;this.qr_code=t.image,this.secret=t.secret}else{if(this.has_two_step)try{await this.$confirm("Remove 2 step verification? You need to do setup process if you enable at next time."),this.$vx.post("User/setting-2step?_entry=remove"),this.has_two_step=!1}catch{this.on_off=!0}return}}},methods:{async removeWhitelist(t){await this.$vx.post("User/setting-2step?_entry=removeWhitelist",{ip:t}),await this.loadWhitelist()},async addToWhitelist(){await this.$vx.post("User/setting-2step?_entry=addWhitelist"),await this.loadWhitelist()},async loadWhitelist(){let{data:t}=await this.$vx.get("User/setting-2step");this.whitelist=t.whitelist},async onSubmit(){let t=(await this.$vx.post("User/setting-2step",{code:this.code,secret:this.secret})).data;if(t.error){this.$message.error(t.error.message);return}this.$message.success("2 Step verification updated"),this.has_two_step=!0,this.code=null}}},q={class:"mb-1"},N={key:0},A=a("Your IP address : "),B=["textContent"],I=a("Add IP to white list"),P=["onClick"],T={key:1},z=n("p",null," Now download the app and scan the qrcode. Input the code to the following input and submit ",-1),F=a(" For Android user, install "),Y=a("Authenticator"),$=a(" For iOS user, install "),j=a("Authenticator"),D=a("Submit");function E(t,_,M,O,i,l){const f=s("el-switch"),d=s("el-button"),w=s("vx-icon"),h=s("el-table-column"),g=s("el-table"),p=s("el-link"),v=s("el-image"),y=s("el-input"),x=s("el-form-item"),b=s("el-form"),k=s("el-card");return c(),V(k,null,{default:o(()=>[n("div",q,[e(f,{modelValue:i.on_off,"onUpdate:modelValue":_[0]||(_[0]=r=>i.on_off=r),"active-text":"2 step verification"},null,8,["modelValue"])]),i.on_off&&!l.show_setting?(c(),u("div",N,[n("p",null,[A,n("span",{textContent:W(i.ip_address)},null,8,B)]),e(d,{onClick:l.addToWhitelist,type:"primary"},{default:o(()=>[I]),_:1},8,["onClick"]),e(g,{size:"small",data:i.whitelist},{default:o(()=>[e(h,{width:"50"},{default:o(r=>[n("a",{onClick:U(R=>l.removeWhitelist(r.row.value),["prevent"])},[e(w,{name:"trash",width:"14"})],8,P)]),_:1}),e(h,{label:"IP address",prop:"value"})]),_:1},8,["data"])])):m("",!0),l.show_setting?(c(),u("div",T,[z,n("p",null,[F,e(p,{type:"primary",target:"_blank",href:"https://play.google.com/store/apps/details?id=com.azure.authenticator"},{default:o(()=>[Y]),_:1})]),n("p",null,[$,e(p,{type:"primary",target:"_blank",href:"https://apps.apple.com/us/app/microsoft-authenticator/id983156458"},{default:o(()=>[j]),_:1})]),e(v,{src:i.qr_code},null,8,["src"]),e(b,null,{default:o(()=>[e(x,{label:"Code"},{default:o(()=>[e(y,{modelValue:i.code,"onUpdate:modelValue":_[1]||(_[1]=r=>i.code=r),placeholder:"6 digits code",minlength:"6",maxlength:"6"},null,8,["modelValue"])]),_:1}),e(d,{type:"primary",onClick:l.onSubmit},{default:o(()=>[D]),_:1},8,["onClick"])]),_:1})])):m("",!0)]),_:1})}var H=C(S,[["render",E]]);export{H as default};
